黄琦雲的博客 https://knightyun.github.io 基于 jekyll 的 Github Pages 个人博客网站，技术的学习、总结、分享与提升 Tue, 15 Oct 2019 11:39:16 +0000 JavaScript类型转换的有趣应用 https://knightyun.github.io/2019/10/07/js-magic-expression <h1 id="背景">背景</h1> <blockquote> <p>可以访问这个网站提前预览：<a href="https://knightyun.github.io/magic-expression/">https://knightyun.github.io/magic-expression/</a></p> </blockquote> <p>先来看一串代码：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="o">~+</span><span class="p">[])</span><span class="o">+</span><span class="p">{})[</span><span class="o">--</span><span class="p">[</span><span class="o">~+</span><span class="dl">''</span><span class="p">][</span><span class="o">+</span><span class="p">[]]</span><span class="o">*</span><span class="p">[</span><span class="o">~+</span><span class="p">[]]</span><span class="o">+~~!+</span><span class="p">[]]</span><span class="o">+</span><span class="p">({}</span><span class="o">+</span><span class="p">[])[[</span><span class="o">~!+</span><span class="p">[]]</span><span class="o">*~+</span><span class="p">[]]</span> </code></pre></div></div> <p>也许你在其他地方看见过这种黑科技操作，那么不妨猜一下上面的代码的值等于多少，实在猜不到可以复制它粘贴到浏览器 console 中回车看看；</p> <p>这里剧透一下，会得到下面的结果（手动解释，仅供娱乐并无其他意思）：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">"</span><span class="s2">sb</span><span class="dl">"</span> </code></pre></div></div> <p>当然，你可能还见过这种形式的 <code class="highlighter-rouge">"hello world!"</code> 版本的，即最后输出的字符串是 <code class="highlighter-rouge">"hello world!"</code>，这里由于它的代码过长就不粘贴出来了，原理和上面类似，我们暂且称它为<strong>魔法表达式</strong>，下面就以上面的例子还分析一下这窜代码的“魔法”；</p> <h1 id="类型转换">类型转换</h1> <p>分析之前先来了解一些基础，在 js 的世界中，存在一种<strong>类型转换</strong>的机制，大致就是字面意思，下面分别举例说明；</p> <h2 id="number--string">Number / String</h2> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// 2</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "11"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "11"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// "11"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span> <span class="o">-</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span> <span class="o">-</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// NaN</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span> <span class="o">-</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// NaN</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// NaN</span> <span class="c1">// *，/，% 等运算符与 - 运算类似</span> </code></pre></div></div> <p>可以看到，上面的行为可能有点怪异，因为在其他语言中可能会报错，但是在 js 中确实是这样执行的，即静默地尽可能地把运算符两边的类型转换一致再运算；</p> <h2 id="number--boolean">Number / Boolean</h2> <p>当然这种转换不限于字符串和数字类型之间，也包括其他类型，比如很经典的一中转换：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="kc">true</span><span class="p">);</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">===</span> <span class="kc">true</span><span class="p">);</span> <span class="c1">// false</span> </code></pre></div></div> <p>上面就是把数字类型和 Boolean 类型的值进行比较，第一行的输出结果是因为使用 <code class="highlighter-rouge">==</code> 操作符时会自行把 <code class="highlighter-rouge">1</code> 转换为 <code class="highlighter-rouge">true</code>，所以两边相等（可以理解为执行 <code class="highlighter-rouge">Boolean(0)</code> 操作）；而 <code class="highlighter-rouge">===</code> 操作符除了比较两边的值，还会比较两边类型，二者都相同才判断相等，即没有进行类型转换；</p> <h2 id="其他类型">其他类型</h2> <p>其他类型的转换情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">([]));</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="dl">''</span><span class="p">));</span> <span class="c1">// false</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="dl">''</span><span class="p">)));</span> <span class="c1">// false</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="dl">''</span><span class="p">)));</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">));</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">({}));</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="c1">// false</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="nb">Number</span><span class="p">(</span><span class="mi">0</span><span class="p">)));</span> <span class="c1">// false</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="k">new</span> <span class="nb">Number</span><span class="p">(</span><span class="mi">0</span><span class="p">)));</span> <span class="c1">// true</span> </code></pre></div></div> <h2 id="应用">应用</h2> <p>下面是该机制的一些实际应用：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span> <span class="k">typeof</span> <span class="o">+</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 1 "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="dl">''</span><span class="p">,</span> <span class="k">typeof</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="dl">''</span><span class="p">));</span> <span class="c1">// 1 "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="k">typeof</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span> <span class="c1">// 1 "string"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="p">[],</span> <span class="k">typeof</span> <span class="o">+</span><span class="p">[]);</span> <span class="c1">// 0 "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">-</span><span class="p">[],</span> <span class="k">typeof</span> <span class="o">-</span><span class="p">[]);</span> <span class="c1">// -0 "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="k">typeof</span> <span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="c1">// 1 "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="k">typeof</span> <span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="c1">// NaN "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">[],</span> <span class="k">typeof</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">[]),</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">[]).</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// '' "string" 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span> <span class="o">+</span> <span class="dl">''</span><span class="p">,</span> <span class="k">typeof</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">[]),</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">[]).</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// '' "string" 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="p">{},</span> <span class="k">typeof</span> <span class="o">+</span><span class="p">{});</span> <span class="c1">// NaN "number"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({}</span> <span class="o">+</span> <span class="dl">''</span><span class="p">,</span> <span class="k">typeof</span> <span class="p">({}</span> <span class="o">+</span> <span class="dl">''</span><span class="p">));</span> <span class="c1">// [object Object] "string"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">{},</span> <span class="k">typeof</span> <span class="p">(</span><span class="dl">''</span> <span class="o">+</span> <span class="p">{}));</span> <span class="c1">// [object Object] "string"</span> </code></pre></div></div> <p>另外，<strong>”!”</strong> 与 <strong>”~”</strong> 运算符也算是 js 中较为常见的，其中 <strong>!</strong> 是逻辑运算符，代表<strong>非</strong>，而 <strong>~</strong> 是位运算符，代表<strong>按位取反</strong>，它们有以下关系：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// false</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!</span><span class="kc">false</span><span class="p">);</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// true</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">~</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// -1</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">~</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// -4</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">~~</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// 3</span> </code></pre></div></div> <h1 id="分析">分析</h1> <p>现在开始分析最早提到的那串代码，它的神奇之处就在于整个代码在不包括任何一个字母的情况下输出了字母，代码中都是一些运算符和操作符，代码串挨在一起不利于观察，我们先稍微格式化一下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="o">~+</span><span class="p">[])</span> <span class="o">+</span> <span class="p">{}</span> <span class="p">)</span> <span class="p">[</span> <span class="o">--</span><span class="p">[</span><span class="o">~+</span><span class="dl">''</span><span class="p">][</span><span class="o">+</span><span class="p">[]]</span> <span class="o">*</span> <span class="p">[</span><span class="o">~+</span><span class="p">[]]</span> <span class="o">+</span> <span class="o">~~!+</span><span class="p">[]</span> <span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="p">{}</span> <span class="o">+</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">[</span> <span class="p">[</span><span class="o">~!+</span><span class="p">[]]</span> <span class="o">*</span> <span class="o">~+</span><span class="p">[]</span> <span class="p">];</span> </code></pre></div></div> <p>这里只是拆分美化了一下格式，输出结果不变，然后一行一行进行分析，根据拆分结果，其实整个代码就是两大部分相加；</p> <h2 id="第一部分">第一部分</h2> <p>第一部分中，第一行是 <code class="highlighter-rouge">(!(~+[]) + {})</code>，也是两部分加和，根据前面的基础，可以得到如下分析结果：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> (!(~+[]) + {}) ↓ (!(~0) + "[object Object]") ↓ (!-1 + "[object Object]") ↓ (false + "[object Object]") ↓ (false + "[object Object]") ↓ ("false[object Object]") </code></pre></div></div> <p>第一大部分剩下的内容：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span> <span class="o">--</span><span class="p">[</span><span class="o">~+</span><span class="dl">''</span><span class="p">]</span> <span class="p">[</span><span class="o">+</span><span class="p">[]]</span> <span class="o">*</span> <span class="p">[</span><span class="o">~+</span><span class="p">[]]</span> <span class="o">+</span> <span class="o">~~!+</span><span class="p">[]</span> <span class="p">]</span> </code></pre></div></div> <p>分析结果如下：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--[~+''][+[]] * [~+[]] + ~~!+[] ↓ ↓ ↓ --[~0][0] * [~0] + ~~!0 ↓ ↓ ↓ --[-1][0] * [-1] + ~~true ↓ ↓ --(-1) ~~1 ↓ ↓ -2 1 =&gt; -2 * [-1] + 1 = -2 * -1 + 1 = 3 </code></pre></div></div> <p>所以第一大部分的结果是：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="dl">"</span><span class="s2">false[object Object]</span><span class="dl">"</span><span class="p">)[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// "s"</span> </code></pre></div></div> <h2 id="第二部分">第二部分</h2> <p>第二大部分也执行类似的分解，第一行内容是 <code class="highlighter-rouge">({} + [])</code>，其实也是在拼接字符串，分析如下：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ({} + []) ↓ ("[object Object]" + "") ↓ ("[object Object]") </code></pre></div></div> <p>余下内容是：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span> <span class="p">[</span><span class="o">~!+</span><span class="p">[]]</span> <span class="o">*</span> <span class="o">~+</span><span class="p">[]</span> <span class="p">];</span> </code></pre></div></div> <p>分析如下：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [~!+[]] * ~+[] ↓ ↓ [~!0] * ~0 ↓ ↓ [~true] * -1 ↓ ↓ [~1] * -1 ↓ ↓ [-2] * -1 ↓ -2 * -1 ↓ 2 </code></pre></div></div> <p>所以第二大部分结果就是：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="dl">"</span><span class="s2">[object Object]</span><span class="dl">"</span><span class="p">)[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// "b"</span> </code></pre></div></div> <h2 id="汇总">汇总</h2> <p>最后两个大部分内容字符串拼接就是最终结果，这里汇总一下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="o">~+</span><span class="p">[])</span> <span class="o">+</span> <span class="p">{}</span> <span class="p">)</span> <span class="c1">// "false[object Object]"</span> <span class="p">[</span> <span class="o">--</span><span class="p">[</span><span class="o">~+</span><span class="dl">''</span><span class="p">]</span> <span class="p">[</span><span class="o">+</span><span class="p">[]]</span> <span class="o">*</span> <span class="c1">// -2</span> <span class="p">[</span><span class="o">~+</span><span class="p">[]]</span> <span class="o">+</span> <span class="c1">// -1</span> <span class="o">~~!+</span><span class="p">[]</span> <span class="c1">// 1</span> <span class="p">]</span> <span class="c1">// =&gt; ("false[object Object]")[3] =&gt; "s"</span> <span class="o">+</span> <span class="p">({}</span> <span class="o">+</span> <span class="p">[])</span> <span class="c1">// [object Object]</span> <span class="p">[</span> <span class="p">[</span><span class="o">~!+</span><span class="p">[]]</span> <span class="o">*</span> <span class="c1">// -2</span> <span class="o">~+</span><span class="p">[]</span> <span class="c1">// -1</span> <span class="p">];</span> <span class="c1">// =&gt; ("[object Object]")[2] =&gt; "b"</span> <span class="c1">// =&gt; "s" + "b" = "sb"</span> </code></pre></div></div> <p>费了这么大功夫就得出两个字母，想必这个过程对于理解 js 中的类型转换机制是很有帮助的；</p> <h2 id="魔力所在">魔力所在</h2> <p>然后就是回顾之前那个问题，为什么整个代码没有出现字母却在结果中出现了，根据上面的分析可以看出，字符串是通过类似以下方式得到的：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span> <span class="o">+</span> <span class="p">{});</span> <span class="c1">// "[object Object]"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span> <span class="o">+</span> <span class="kc">true</span><span class="p">);</span> <span class="c1">// "true"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span> <span class="o">+</span> <span class="kc">false</span><span class="p">);</span> <span class="c1">// "false"</span> </code></pre></div></div> <p>然后在 js 中字符串也可以通过类似数组的方式获取某个字符：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="dl">"</span><span class="s2">[object Objact]</span><span class="dl">"</span><span class="p">)[</span><span class="mi">2</span><span class="p">]);</span> <span class="c1">// "b"</span> <span class="c1">// "b" 在字符串中的索引为 2</span> </code></pre></div></div> <p>那么前面提到的输出 <code class="highlighter-rouge">hello world!</code> 的代码，其实也是通过类似的方式获取字符然后拼接而成，只是需要思考从哪些格式化输出中获取想要的那个字符而已；</p> <h1 id="拓展">拓展</h1> <p>顺着上面的思路，如果我们想要输出任意指定字符，该如何实现呢？即字符中可能包含 <code class="highlighter-rouge">a-z, A-Z, 0-9</code> 中的任何一个字符，甚至是特殊字符；</p> <h2 id="可能的输出">可能的输出</h2> <p>前面提到输出的关键是存在这个一个标准格式化输出（如 true, false），然后就能从里面扣取字符了，作者目前能想到的标准输出的字符串有如下（可能疏漏）：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+</span><span class="p">[]);</span> <span class="c1">// ""</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "true"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+!</span><span class="p">[]);</span> <span class="c1">// "false"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+</span><span class="p">{});</span> <span class="c1">// "[object Object]"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">-</span><span class="p">[]);</span> <span class="c1">// "NaN"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]]);</span> <span class="c1">// "undefined"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([]</span><span class="o">+~~!!</span><span class="p">[]</span><span class="o">/+</span><span class="p">[])</span> <span class="c1">// "Infinity"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(([]</span><span class="o">+~</span><span class="p">[])[</span><span class="o">~~</span><span class="p">[]]);</span> <span class="c1">// "-"</span> </code></pre></div></div> <p>即使这样，汇总下来的字母也只有：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefiIjlnNoOrstuy- </code></pre></div></div> <p>离目标似乎有点远~~，数字就比较好弄了：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="p">[]);</span> <span class="c1">// 0</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 1</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 2（后续的数字可以这样叠加）</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">-~+!!</span><span class="p">[]);</span> <span class="c1">// 2（也可以换个简短的方法）</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 3</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 4</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 5</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 6</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 7</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 8</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// 9</span> </code></pre></div></div> <p>更大的数字就可以通过字符拼接或者四则运算获得；</p> <h2 id="扩大输出范围">扩大输出范围</h2> <p>目前还是没有获得大部分大写字母和特殊字符 <code class="highlighter-rouge">~!@#$%^&amp;*()_+-=\|[]{};':",./&lt;&gt;?</code>，甚至是汉字或者是其他国字符，等等，说到这里是不是想起了什么？没错就是<strong>Unicode</strong>（号称万国符来着），首先 js 中使用 Unicode 的形式是 <code class="highlighter-rouge">"\uXXXX"</code>，后面的 <code class="highlighter-rouge">XXXX</code> 是四个十六进制字符，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="se">\</span><span class="s1">u0061</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "a"</span> <span class="c1">// 获取 a 的字符编码</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">());</span> <span class="c1">// 97</span> <span class="c1">// 转换为 16 进制</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span> <span class="c1">// "61"</span> <span class="c1">// 0061 = 61</span> <span class="c1">// 汉字</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">黄</span><span class="dl">'</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span> <span class="c1">// "9ec4"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="se">\</span><span class="s1">u9ec4</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "黄"</span> </code></pre></div></div> <p>所以只要能够表示 <code class="highlighter-rouge">\, u, a-f, 0-9</code> 这几个字符，就能表示所有 Unicode 字符了！根据前面的总结，其实我们已经能够表示这几个字符了！不过呢，直接拼接 Unicode 的话会出现下面的问题：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="se">\</span><span class="s1">u0061</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "a"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="se">\</span><span class="s1">u</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">0061</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// SyntaxError: Invalid Unicode escape sequence</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="se">\\</span><span class="s1">u</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">0061</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "\u0061"</span> </code></pre></div></div> <h2 id="魔力召唤">魔力召唤</h2> <h3 id="eval">eval</h3> <p>所以我们不能通过直接拼接 Unicode 字符串来获得能被解析的 Unicode 符的，因此不得不换个思路；既然不能拼接直接 Unicode，那么有么有间接的方法或者 API 呢？ 可能会想到使用 <code class="highlighter-rouge">eval()</code>：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="se">\\</span><span class="s1">u</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">0061</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span> <span class="c1">// "a"</span> </code></pre></div></div> <p>虽然成功了，但是目前我们似乎还无法获得 <code class="highlighter-rouge">eval</code> 中的字母 <code class="highlighter-rouge">v</code>，所以要继续换个方法；</p> <h3 id="function">Function</h3> <p>其实还有一个函数可以实现类似的功能，它就是 <code class="highlighter-rouge">Function()</code>，即<em>构造函数的函数</em>，也是声明函数的另一种方法，举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">return a + b</span><span class="dl">'</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">fn2</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">return 4</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// 3</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fn2</span><span class="p">());</span> <span class="c1">// 4</span> </code></pre></div></div> <p>然后我们就可以像这样拼接 Unicode 了：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">return </span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"</span><span class="se">\\</span><span class="s1">u</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">0061</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">)());</span> <span class="c1">// "a"</span> </code></pre></div></div> <p>另外我们需要知道的是：<code class="highlighter-rouge">[]['constructor']['constructor'] === Function</code>，所以最后只要构造出这样的字符串就行了：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[][</span><span class="dl">'</span><span class="s1">constructor</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">constructor</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">return </span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="se">\\</span><span class="s1">u0061</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">)();</span> </code></pre></div></div> <h3 id="魔力聚集">魔力聚集</h3> <p>根据前面的基础，我们已经能够获取 <code class="highlighter-rouge">constructor, return</code> 里面的所有字母了，这里再把需要用到的字符全部汇总一下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// " ""</span> <span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "\"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[]);</span> <span class="c1">// "0"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "1"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "2"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "3"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "4"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "5"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "6"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "7"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "8"</span> <span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]);</span> <span class="c1">// "9"</span> <span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "a"</span> <span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "b"</span> <span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "c"</span> <span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "d"</span> <span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "e"</span> <span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]];</span> <span class="c1">// "f"</span> <span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "n"</span> <span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "o"</span> <span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "r"</span> <span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]];</span> <span class="c1">// "s"</span> <span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]];</span> <span class="c1">// "t"</span> <span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[];</span> <span class="c1">// "u"</span> </code></pre></div></div> <h3 id="魔力释放">魔力释放</h3> <p>最后剩下的就是把想要的输出，转换为 Unicode，再拆分为单个字符对应上面的表达式进行拼接就行了，我们来试一下效果（拿走不谢 :)）：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">s1</span> <span class="o">=</span> <span class="p">[][([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]][([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]](([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">)();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s1</span><span class="p">);</span> <span class="c1">// "I love you!"</span> <span class="kd">var</span> <span class="nx">s2</span> <span class="o">=</span> <span class="p">[][([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]][([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]](([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">[][</span><span class="o">+</span><span class="p">[]])[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="p">{})[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+</span><span class="sr">/</span><span class="se">\\</span><span class="sr">/</span><span class="p">)[</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">([]</span><span class="o">+!!</span><span class="p">[])[</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">([]</span><span class="o">+!</span><span class="p">[])[</span><span class="o">+</span><span class="p">[]]</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[]</span><span class="o">+!!</span><span class="p">[])</span><span class="o">+</span><span class="p">[]</span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="p">[])</span><span class="o">+</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">)();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s2</span><span class="p">);</span> <span class="c1">// "我爱你"</span> </code></pre></div></div> <h3 id="在线转换">在线转换</h3> <p>这里放一个在线转换的网站： <a href="https://knightyun.github.io/magic-expression/"><em>点我在线转换</em></a></p> Mon, 07 Oct 2019 00:00:00 +0000 https://knightyun.github.io/2019/10/07/js-magic-expression JavaScript求最小公倍数 https://knightyun.github.io/2019/09/03/js-lcm <h1 id="最小公倍数least-common-multiple">最小公倍数(Least Common Multiple)</h1> <p><strong>最小公倍数</strong>是中学数学知识中的一个概念，具体定义可以 自行了解，这里只大致解释一下，通常几个正整数会存在许多个倍数，每个倍数除以这几个正整数后都没有余数，而这些倍数之中最小的一个则称为最小公倍数；</p> <p>一般直接计算最小公倍数较为困难，因此需要用到一个计算公式，即两个数的乘积等于这两个数的最大公约数与最小公倍数的乘积，所以知道两个数的最大公约数或者求最小公倍数，就可以求得另外一个，接下来先来实现<strong>最大公约数</strong>的求法；</p> <h1 id="最大公约数greatest-common-divisor">最大公约数(Greatest Common Divisor)</h1> <p>这也是与最小公倍数相似的另一个概念，几个正整数之间一般存在多个约数，即这几个正整数除以这个约数后都没有余数，这些约数中最大的一个称为<strong>最大公约数</strong>；下面来实现求最大公约数的函数；</p> <h2 id="最大质因数法">最大质因数法</h2> <p>思路很简单，即将两个数分别递减，获取能同时被二者除尽的最大的一个数，即最大公约数：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getGcd</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">%</span> <span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">b</span> <span class="o">%</span> <span class="nx">j</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">j</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <h2 id="辗转相除法">辗转相除法</h2> <p>思路是用两个数中的最大项除以最小项，如果能除尽，那么最小项便是这两个数的最大公约数；不能除尽则用最大项除以最小项所得余数，与最小项再进行同样的递归操作，最后得到最大的约数，也就是所谓的<strong>辗转相除</strong>；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getGcd</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">min</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nx">max</span> <span class="o">%</span> <span class="nx">min</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">min</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">getGcd</span><span class="p">(</span><span class="nx">max</span> <span class="o">%</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">min</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <h1 id="求最小公倍数">求最小公倍数</h1> <p>有了求最大公约数的函数后，再来求最小公倍数就简单了：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getLcm</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span> <span class="o">/</span> <span class="nx">getGcd</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> Tue, 03 Sep 2019 00:00:00 +0000 https://knightyun.github.io/2019/09/03/js-lcm JavaScript中try, catch, throw的用法 https://knightyun.github.io/2019/09/02/js-try <p>程序在运行中难免遇到 bug，所以就需要好的调试手段找出问题所在，<code class="highlighter-rouge">try, catch, throw</code> 便是 JavaScript 中用来调试并对错误执行相关操作的工具，下面具体介绍其用法；</p> <h1 id="try-catch">try, catch</h1> <p>基本语法结构：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span> <span class="c1">// ...</span> <span class="c1">// 这里写需要调试的代码段</span> <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// ...</span> <span class="c1">// 这里写要对获取的错误信息执行的操作</span> <span class="p">}</span> </code></pre></div></div> <p>举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span> <span class="c1">// 这里故意写错函数名，为了抛出错误</span> <span class="nx">console</span><span class="p">.</span><span class="nx">logg</span><span class="p">(</span><span class="dl">'</span><span class="s1">This is an error and will not display</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> <span class="c1">// TypeError: console.logg is not a function</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// console.logg is not a function</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// TypeError</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span> <span class="c1">// TypeError: console.logg is not a function</span> <span class="p">}</span> </code></pre></div></div> <p>上面的错误代码如果直接在正常环境中执行，便会直接在后台输出错误：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TypeError: console.loggg is not a function </code></pre></div></div> <p>但是使用 <code class="highlighter-rouge">try, catch</code> 结构的话，就可以获取一个包含错误信息的对象，其包含各个部分的错误信息，便于进行一些自定义操作；</p> <h1 id="throw">throw</h1> <p><code class="highlighter-rouge">throw</code> 是在上述结构中使用的一个函数，接受一个参数作为输出信息，throw 的作用是中断后面<strong>所有</strong>语句的执行，包括错误源，但是它前面的语句都会正常执行，它可以用于判断错误的具体位置，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This will display.</span><span class="dl">'</span><span class="p">);</span> <span class="k">throw</span><span class="p">(</span><span class="dl">'</span><span class="s1">My error position.</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// throw 将会中断语句的执行</span> <span class="c1">// 同样故意制造错误</span> <span class="nx">console</span><span class="p">.</span><span class="nx">logg</span><span class="p">(</span><span class="dl">'</span><span class="s1">This is an error and will not display.</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 后面是正常语句</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This will not display, either.</span><span class="dl">'</span><span class="p">)</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// This will display.</span> <span class="c1">// My error position.</span> </code></pre></div></div> <p>如果错误发生在 <code class="highlighter-rouge">throw</code> 语句之前的话，错误便会被正常抛出，而 <code class="highlighter-rouge">throw</code> 传递的信息不会被输出，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">logg</span><span class="p">(</span><span class="dl">'</span><span class="s1">This is an error and wil not display.</span><span class="dl">'</span><span class="p">);</span> <span class="k">throw</span><span class="p">(</span><span class="dl">'</span><span class="s1">My error position.</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 后面的执行同样会被中断</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This will not display, either.</span><span class="dl">'</span><span class="p">)</span> <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// TypeError: console.logg is not a function.</span> </code></pre></div></div> <p>因此，在调试过程中可以结合上面两种情况，一步步找出错误的具体位置；</p> Mon, 02 Sep 2019 00:00:00 +0000 https://knightyun.github.io/2019/09/02/js-try JavaScript变异与非变异数组方法 https://knightyun.github.io/2019/09/02/js-mutation-array <p>在 JavaScript 中，存在大量对数组进行操作的方法，它们都有一个特点，就是关于此操作是否会修改原数组，并以此将数组方法分为<strong>变异数组方法</strong>与<strong>非变异数组方法</strong>，例如 <code class="highlighter-rouge">.pop()</code> 方法便是删除数组的最后一个元素，而 <code class="highlighter-rouge">.slice()</code> 方法则是返回一个指定特征的新数组，并不会对原数组进行修改；能有效的区分这两类方法，有助于开发过程中方法选用，避免出现不必要的错误；</p> <p>下面对一些常见的数组方法进行了整理分类：</p> <table> <thead> <tr> <th>非变异数组方法</th> <th>变异数组方法</th> </tr> </thead> <tbody> <tr> <td>.join()</td> <td>.push()</td> </tr> <tr> <td>.concat()</td> <td>.pop()</td> </tr> <tr> <td>.slice()</td> <td>.shift()</td> </tr> <tr> <td>.from()</td> <td>.reverse()</td> </tr> <tr> <td>.map()</td> <td>.sort()</td> </tr> <tr> <td>.filter()</td> <td>.splice()</td> </tr> <tr> <td>.every()</td> <td>.fill()</td> </tr> <tr> <td>.find()</td> <td> </td> </tr> <tr> <td>.findIndex()</td> <td> </td> </tr> <tr> <td>.flat()</td> <td> </td> </tr> <tr> <td>.flatMap()</td> <td> </td> </tr> <tr> <td>.forEach()</td> <td> </td> </tr> <tr> <td>.includes()</td> <td> </td> </tr> <tr> <td>.indexOf()</td> <td> </td> </tr> <tr> <td>.lastIndexOf()</td> <td> </td> </tr> <tr> <td>.reduce()</td> <td> </td> </tr> <tr> <td>.reduceRight()</td> <td> </td> </tr> <tr> <td>.some()</td> <td> </td> </tr> <tr> <td>.toString()</td> <td> </td> </tr> <tr> <td>.toLocalString()</td> <td> </td> </tr> </tbody> </table> <p>可以看出改变原数组的变异数组方法只有少数几个，非变异的过多可能记不住，因此可以选择记少不记多的原则，记住那几个特殊的变异方法的，其余的便可归类于非变异的了；</p> Mon, 02 Sep 2019 00:00:00 +0000 https://knightyun.github.io/2019/09/02/js-mutation-array JavaScript变量提升（Hoisting）详解 https://knightyun.github.io/2019/09/02/js-hoisting <h1 id="概念">概念</h1> <p><strong>变量提升</strong>是 JavaScript 的一种执行机制，大致就是字面意思，将声明的变量提前，但并不是指在编译时改变语句的顺序，而是将变量<strong>提前</strong>放入内存中，供后续操作，下面通过实例进行分析；</p> <h1 id="函数申明">函数申明</h1> <p>在 JavaScript 中，声明一个函数并执行的话，通常会是以下形式：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">run</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// run</span> </code></pre></div></div> <p>上面是正常的思维顺序，但是包括其他一些编程语言在内，通常会使用如下形式：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fn</span><span class="p">();</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">run</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// run</span> </code></pre></div></div> <p>这样做在执行上是没用问题的，同时可以在包含大量语句和函数申明的情况下，也可以使用这种特性将普通语句和函数申明分开，提高可读性；</p> <p>以上情况便是一种常见的<strong>提升(Hoisting)</strong>，即编译时提前将当前执行上下文包含的申明的函数，提前放入内存中，供全文语句执行时调用，为了方便理解而抽象成一种提升行为；</p> <p>但是如果使用下面的方式申明函数并执行：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fn</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">run</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// TypeError: fn is not a function</span> </code></pre></div></div> <p>这里就没有像上面一样的结果了，这属于下面将介绍的变量提升行为；</p> <h1 id="变量申明">变量申明</h1> <p>当然函数只是一种类型的变量，还存在其他的变量类型，例如考虑以下语句：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1</span> </code></pre></div></div> <p>逻辑和执行都是正常的，输出结果也是预期的，但是如果变一下顺序：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> </code></pre></div></div> <p>这种情况，通常可能会认为第一行调用了一个未定义的变量，然后输出 <code class="highlighter-rouge">Uncaught ReferenceError: a is not defined</code> 这样的错误，但是呢，并非如此，输出信息如下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kc">undefined</span> </code></pre></div></div> <p>没错，就只有一个单独的 <code class="highlighter-rouge">undefined</code>，这种输出情况就类似于以下代码的执行：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span><span class="p">;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>从这里便可以大致分析出，前面的顺序怪异的代码，相当于在编译时<strong>提前</strong>将后面出现的变量申明提前，然后执行就输出了一个已申明但未 <strong>初始化（赋值）</strong> 的值，这便是其他类型的变量的<strong>提升</strong>行为，即在当前执行上下文中，将后面申明的变量提前放入内存，供前面的语句调用；</p> <p><strong>注意</strong>，前面的代码最后一行的语句是 <code class="highlighter-rouge">var a = 1</code>，即对变量进行了申明并赋值，但是最后输出仍然是 <code class="highlighter-rouge">undefined</code> 而不是 <code class="highlighter-rouge">1</code>，证明变量提升行为只会对变量进行申明操作，并不会对其初始化赋值，不管原语句是否有赋值操作；</p> <p>然后便能解释之前的代码：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fn</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">run</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// TypeError: fn is not a function</span> </code></pre></div></div> <p>这种情况便是将变量 <code class="highlighter-rouge">fn</code> 提升，值为 <code class="highlighter-rouge">undefined</code>，所以执行 <code class="highlighter-rouge">fn()</code> 语句会提示 <code class="highlighter-rouge">fn is not a function</code> 而不是 <code class="highlighter-rouge">fn is not defined</code>，与使用关键字 <code class="highlighter-rouge">function</code> 申明函数情况不一样；</p> <h1 id="拓展">拓展</h1> <h2 id="return-的限制">return 的限制</h2> <p>另外值得一提的是，我们都知道 <code class="highlighter-rouge">return</code> 是函数内代码执行结束的标志，其后代码不会执行，但是提升行为却不受此限制，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="nx">fnn</span><span class="p">();</span> <span class="k">return</span> <span class="p">;</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fnn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">exist.</span><span class="dl">'</span><span class="p">)</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// undefined</span> <span class="c1">// exist.</span> </code></pre></div></div> <h2 id="提升优先级">提升优先级</h2> <p>上面提到两种提升行为，那么它们的优先级顺序是如何的呢？还是通过代码说明：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">a</span><span class="p">(){};</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">function</span> <span class="nx">a</span><span class="p">(){};</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="nx">fn1</span><span class="p">();</span> <span class="c1">// f a() {}</span> <span class="nx">fn2</span><span class="p">();</span> <span class="c1">// f a() {}</span> </code></pre></div></div> <p>结果证明函数的提升优先级始终高于普通变量的提升；</p> <h2 id="提升的执行">提升的执行</h2> <p>再来看一种情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">fnn</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fnn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>这里按照正常的逻辑，申明函数 <code class="highlighter-rouge">fnn()</code> 之前就已经申明了变量 <code class="highlighter-rouge">a</code>，所以会感觉函数 fnn 应该可以访问变量 a，但是最后输出的并不是 <code class="highlighter-rouge">1</code>，输出 <code class="highlighter-rouge">undefined</code> 说明函数 fnn 并没有访问到赋值后的 a，并且所访问的 a 也触发了提升机制，因为输出的不是 <code class="highlighter-rouge">RefferenceError</code>，那么就能大致梳理出提升真 正的执行顺序了：</p> <ol> <li>执行 fn();</li> <li>执行 fnn(); <ol> <li>发现前面没有关于函数 fnn() 的申明，于是向后寻找，最后找到了；</li> <li>执行 console.log(a);</li> <li>发现 fnn 内部没有 a 的定义，向外一层寻找；</li> </ol> </li> <li>a 申明在 fnn() 执行语句以后，所以 a 触发提升，供之前的 console.log 使用；</li> </ol> <p>因此上面的代码相当于是以下面的顺序执行的：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> </code></pre></div></div> <h1 id="var-let-const的区别">var, let, const的区别</h1> <p>JavaScript 中申明变量的方式以及对应效果如下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 全局变量</span> <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 局部作用域变量（当前上下文）</span> <span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// 块级作用域变量（当前块级上下文）</span> <span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="c1">// 常量</span> </code></pre></div></div> <h2 id="作用域">作用域</h2> <p>这里解释一下，变量 a 申明时没有带任何关键字，默认其为全局变量；变量 b 申明带有关键字 <code class="highlighter-rouge">var</code>，为当前上下文的局部作用域，如果用在全局则为全局变量；变量 c 使用关键字关键字 <code class="highlighter-rouge">let</code>，d 使用关键字 <code class="highlighter-rouge">const</code>，二者都是<strong>ES6</strong>中新增的<strong>块级</strong>作用域申明，只不过 <code class="highlighter-rouge">const</code> 申明的是常量，值不可更改；</p> <p>通过例子看一下它们的区别；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">全局</span><span class="dl">'</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">aa</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">局部</span><span class="dl">'</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aa</span><span class="p">);</span> <span class="p">}</span> <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">全局</span><span class="dl">'</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">bb</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">块级</span><span class="dl">'</span><span class="p">;</span> <span class="kd">const</span> <span class="nx">bbb</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">块级</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">全局</span><span class="dl">'</span> <span class="kd">let</span> <span class="nx">cc</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">块级</span><span class="dl">'</span><span class="p">;</span> <span class="kd">const</span> <span class="nx">ccc</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">块级</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// “全局”</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// “局部”</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aa</span><span class="p">);</span> <span class="c1">// aa is not defined</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span> <span class="c1">// “全局” “全局”</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bb</span><span class="p">,</span> <span class="nx">cc</span><span class="p">);</span> <span class="c1">// bb is not defined cc is not defined</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bbb</span><span class="p">,</span> <span class="nx">ccc</span><span class="p">);</span> <span class="c1">// bbb is not defined ccc is not defined</span> </code></pre></div></div> <p>可以看出，var 的<strong>局部</strong>限于全局或者函数内部上下文，而 let 和 const 的<strong>块级</strong>的意思则是被 <strong>块(block)</strong> 所包含的上下文，也就是包含在花括号 <code class="highlighter-rouge">{}</code> 内部的作用域中，所以也包括函数在内，加上 if, for, while, switch 等情况，且不能被外部作用域访问；</p> <h2 id="全局变量提升">全局变量提升</h2> <p>首先看申明全局变量时的提升行为：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// ReferenceError: a is not defined</span> </code></pre></div></div> <p>证明不带关键字的申明全局变量，似乎并没有执行变量的提升行为，与以下代码的执行无异：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// a 前面未申明</span> <span class="c1">// ReferenceError: a is not defined</span> </code></pre></div></div> <h2 id="局部变量提升">局部变量提升</h2> <p>使用关键字 <code class="highlighter-rouge">var</code> 申明的情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aa</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">aa</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// undefined</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>前面已解释，不再赘述，只是需要注意下面这种情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>正常思维可能会理解 if 条件判断为假所以不会执行内部语句，最后会输出 <code class="highlighter-rouge">a is not defined</code>，然而并非如此，仍然将申明的变量执行了提升机制；这里可以简单理解为<strong>存在即提升</strong>，也就是为了避免以上问题的影响，所以出现了块级变量申明 <code class="highlighter-rouge">let</code> 与 <code class="highlighter-rouge">const</code>；</p> <h2 id="块级变量提升">块级变量提升</h2> <p>使用 <code class="highlighter-rouge">let</code> 与 <code class="highlighter-rouge">const</code> 的情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aa</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// ReferenceError: Cannot access 'a' before initialization</span> <span class="c1">// ReferenceError: aa is not defined</span> <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bb</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// ReferenceError: Cannot access 'b' before initialization</span> <span class="c1">// ReferenceError: bb is not defined</span> </code></pre></div></div> <p>可以看出，块级变量申明似乎也执行了类似提升的机制，但是处理却与 <code class="highlighter-rouge">var</code> 有区别，这里是直接以错误的形式处理输出，提示该变量未进行初始化，而没有变量的申明语句的情况，则是提示未定义的错误，且 <code class="highlighter-rouge">let</code> 与 <code class="highlighter-rouge">const</code> 的处理情况一致；</p> Mon, 02 Sep 2019 00:00:00 +0000 https://knightyun.github.io/2019/09/02/js-hoisting JavaScript实现斐波那契数列（Febonacci Array） https://knightyun.github.io/2019/09/02/js-febonacci <p>斐波那契（Febonacci）数列是一个神奇的数列，在很多地方都有应用，可以自行搜索相关图片体会其魅力，这里不赘述，直接来分析一下如何通过 JavaScript 来实现；</p> <h1 id="概念">概念</h1> <p>斐波那契数列形式如下：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 1 2 3 5 8 13 21 34... </code></pre></div></div> <p>规律应该很容易看出来，即从第三项开始，每一项的值等于前两项之和，以此类推下去，至于第一项和第二项的值嘛，不要纠结，就是这样规定的…</p> <h1 id="斐波那契数">斐波那契数</h1> <p>首先来实现一下获取指定项的斐波那契数，即获取该数组中第 n 项的值；</p> <p>方法一：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getFebNum</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">getFebNum</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">getFebNum</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>方法一使用递归的思路，便于理解代码量也少，但是其算法复杂度较大，当 n 相当大的时候，程序运行也无比复杂；</p> <p>方法二：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">_getFebNum</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">one</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 初始为第 -2 项</span> <span class="nx">two</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// 初始为第 -1 项</span> <span class="nx">three</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 初始为第 1 项</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">three</span> <span class="o">=</span> <span class="nx">one</span> <span class="o">+</span> <span class="nx">two</span><span class="p">;</span> <span class="nx">one</span> <span class="o">=</span> <span class="nx">two</span><span class="p">;</span> <span class="nx">two</span> <span class="o">=</span> <span class="nx">three</span><span class="p">;</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">three</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>这种方法算法复杂度就比较小了，只是换了个获取思路，代码量增加也不太容易理解，其中为了缩减代码量，便于递推的进行，把斐波那契数列向后模拟扩展了两项:</p> <table> <thead> <tr> <th>项</th> <th>-2</th> <th>-1</th> <th>1</th> <th>2</th> <th>3</th> <th>4</th> <th>5</th> <th>…</th> </tr> </thead> <tbody> <tr> <td>值</td> <td>1</td> <td>0</td> <td>1</td> <td>1</td> <td>2</td> <td>3</td> <td>5</td> <td>…</td> </tr> </tbody> </table> <h1 id="斐波那契数列">斐波那契数列</h1> <p>接下来通过代码实现获取指定长度的斐波那契数列：</p> <p>方法一：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getFebArr</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">getFebNum</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>这个方法通过挨个获取斐波那契数，最后组成一个斐波那契数列，需要用到前面的 <code class="highlighter-rouge">getFebNum</code> 函数；</p> <p>方法二：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">_getFebArr</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">one</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">two</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">three</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">three</span> <span class="o">=</span> <span class="nx">one</span> <span class="o">+</span> <span class="nx">two</span><span class="p">;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">three</span><span class="p">);</span> <span class="nx">one</span> <span class="o">=</span> <span class="nx">two</span><span class="p">;</span> <span class="nx">two</span> <span class="o">=</span> <span class="nx">three</span><span class="p">;</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>方法二利用之前 <code class="highlighter-rouge">_getFebNum</code> 方法的思路，递推地填充斐波那契数列，降低了算法复杂度；</p> Mon, 02 Sep 2019 00:00:00 +0000 https://knightyun.github.io/2019/09/02/js-febonacci JavaScript稀疏数组 https://knightyun.github.io/2019/08/02/js-sparse-array <h1 id="稀疏数组">稀疏数组</h1> <h2 id="概念">概念</h2> <p>在一些后端语言中，如 C，数组内的值通常被分配在一系列连续的内存地址上，但是在 js 中，某些数组内存则不是连续的，所谓<strong>稀疏</strong>，顾名思义，不连续，存在一些空隙；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">// (3) [empty × 3]</span> </code></pre></div></div> <p>通过以上方法创建数组，其中 <code class="highlighter-rouge">Array(3)</code> 中的参数 3 表示数组的长度，这个数组就是稀疏的，控制台输出一般带有 <code class="highlighter-rouge">empty</code> 字样，或者像下面这样创建数组：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,,</span><span class="mi">2</span><span class="p">];</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">// (3) [1, empty, 2]</span> </code></pre></div></div> <p>因为定义语句中两个逗号之间无字符，没有定义值，同样带有 <code class="highlighter-rouge">empty</code> 字样，代表稀疏数组，这里可以把 <code class="highlighter-rouge">empty</code> 理解为上面讲到的 <strong>空隙</strong>；</p> <h2 id="特点">特点</h2> <p>接下来看一下稀疏数组特殊在什么地方，举个例子说明：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="c1">// 正常数组</span> <span class="kd">var</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// 稀疏数组</span> <span class="kd">var</span> <span class="nx">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="c1">// 稀疏数组</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">arr2</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">arr3</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 3 3 3</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">arr3</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="c1">// undefined undefined</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">arr2</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">arr3</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="c1">// 1 undefined 1</span> <span class="c1">// 2 undefined undefined</span> <span class="c1">// 3 undefined 3</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// 1</span> <span class="c1">// 2</span> <span class="c1">// 3</span> <span class="nx">arr2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// （无输出）</span> <span class="nx">arr3</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// 1</span> <span class="c1">// 3</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">0</span> <span class="k">in</span> <span class="nx">arr3</span><span class="p">,</span> <span class="mi">1</span> <span class="k">in</span> <span class="nx">arr3</span><span class="p">);</span> <span class="c1">// true false</span> </code></pre></div></div> <p>总结一下，创建的稀疏数组，其长度（length）与定义长度值一致；<strong>空隙</strong> 值可以被单独访问到，并且不是之前出现的 <code class="highlighter-rouge">empty</code> 字样，而是 <code class="highlighter-rouge">undefined</code>，比如例子中出现 <code class="highlighter-rouge">undefined</code> 时都是使用 <code class="highlighter-rouge">arr[i]</code> 这样的索引直接访问方式；使用某些数组方法如 <code class="highlighter-rouge">forEach()</code> 时，会忽略掉空隙值，只处理正常值，所以也会使得 <code class="highlighter-rouge">1 in arr3</code> 值为 <code class="highlighter-rouge">false</code>，即数组中不存在该索引；</p> <p>细想一下，js 这样处理的原因多半是去除不必要的性能开销，当数组相当大时，可以避免处理一些未初始化的值，但这样也同时使得开发中会出现一些问题，所以应尽量避免；</p> <p>举个例子来查看一下性能如何：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">'</span><span class="s1">one</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 密集数组</span> <span class="nb">Array</span><span class="p">(...</span><span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="nx">e5</span><span class="p">)).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="p">;</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">'</span><span class="s1">one</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">'</span><span class="s1">two</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 稀疏数组</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="nx">e5</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="p">;</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">'</span><span class="s1">two</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// one: 26.3759765625ms</span> <span class="c1">// two: 5.701171875ms</span> </code></pre></div></div> <p>可以看出在处理较大数组时，稀疏数组确实能降低不少性能开销；</p> <h1 id="密集数组">密集数组</h1> <h2 id="概念-1">概念</h2> <p>与稀疏相对应，则存在密集，定义也就是元素中不存在 <strong>空隙</strong> 值，其实密集数组基本就是平时常见的正常数组；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="kd">var</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="nx">arr2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// 1</span> <span class="c1">// 2</span> <span class="c1">// 3</span> </code></pre></div></div> <p>以上都是一些定义密集数组的方法，并且数组中的值都能被正常访问或遍历处理；</p> <h2 id="区别">区别</h2> <p>运用时需要注意以下情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="kc">undefined</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">];</span> <span class="kd">var</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// undefined undefined</span> <span class="nx">arr1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">})</span> <span class="c1">// undefined</span> <span class="c1">// undefined</span> <span class="c1">// undefined</span> <span class="nx">arr2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">})</span> <span class="c1">// （无输出）</span> </code></pre></div></div> <p>即显式的声明值为 <code class="highlighter-rouge">undefined</code> 并不代表这个值就是之前提到的<strong>空隙</strong>值，虽然二者通过索引访问时的值都返回 <code class="highlighter-rouge">undefined</code>，但是其根本还是有区别的，显式声明过的是可以被遍历等操作访问的，不会被当成空隙值被忽略；</p> <h2 id="拓展">拓展</h2> <p>通常在很多情况下，我们想要直接声明一个数组并赋予其一些特定的初始值，并且为了避免问题，通常是希望申明为密集数组的，下面就介绍一些常用的方法或技巧：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr1</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr1</span><span class="p">);</span> <span class="c1">// [1, 1, 1]</span> <span class="kd">var</span> <span class="nx">arr2</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">fill</span><span class="p">().</span><span class="nx">map</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">i</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr2</span><span class="p">);</span> <span class="c1">// [0, 1, 2]</span> <span class="kd">var</span> <span class="nx">arr3</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr3</span><span class="p">);</span> <span class="c1">// [undefined, undefined, undefined]</span> <span class="c1">// 这样声明的是密集数组，不是稀疏的</span> <span class="kd">var</span> <span class="nx">arr4</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr4</span><span class="p">);</span> <span class="c1">// ['a', 'a', 'a']</span> <span class="c1">// 注意定义数组长度比输出数组大 1</span> </code></pre></div></div> <p>其它更多的方法可以自行类推；</p> Fri, 02 Aug 2019 00:00:00 +0000 https://knightyun.github.io/2019/08/02/js-sparse-array async与await的用法详解 https://knightyun.github.io/2019/08/02/js-async-await <h1 id="async">async</h1> <p>用于声明异步函数，返回值为一个 <code class="highlighter-rouge">Promise</code> 对象，它以类似<strong>同步</strong>的方法来写异步方法，语法与声明函数类似，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello world!</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fn</span><span class="p">().</span><span class="kd">constructor</span><span class="p">);</span> <span class="c1">// Promise()</span> <span class="c1">// 这里证明其返回值为一个 Promise 对象；</span> </code></pre></div></div> <p>也许会有疑问，返回值是 Promise 对象，那么函数本身定义的返回值跑到哪里去了呢？其实，熟悉 Promise 的就知道其异步结果是通过 <code class="highlighter-rouge">.then()</code> 或者 <code class="highlighter-rouge">.catch()</code> 方法来获取并进行进一步处理的，这样一个道理，定义的异步函数中的返回值会当成 <code class="highlighter-rouge">resolve</code> 状态来处理，一般用 <code class="highlighter-rouge">.then()</code> 方法处理，而如果定义的异步函数抛出错误，例如变量未定义，则会被当做 <code class="highlighter-rouge">reject</code> 状态来处理，一般使用 <code class="highlighter-rouge">.catch()</code> 方法来处理；</p> <p>举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 使用 .then() 的情况</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="dl">'</span><span class="s1">Hello world!</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">fn1</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// Hello world!</span> <span class="c1">// 使用 .catch() 的情况</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aaa</span><span class="p">);</span> <span class="c1">// 这里的变量 aaa 未定义，为了制造错误</span> <span class="p">}</span> <span class="nx">fn2</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// ReferenceError: aaa is not defined</span> </code></pre></div></div> <p>假如是既有返回值，又有错误的话，来看看结果如何：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn3</span><span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aaa</span><span class="p">);</span> <span class="c1">// aaa 依然未定义；</span> <span class="k">return</span> <span class="dl">'</span><span class="s1">Hello world!</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">fn3</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// ReferenceError: aaa is not defined</span> </code></pre></div></div> <p>结果证明只会执行 <code class="highlighter-rouge">reject</code> 状态的情况下的语句，忽略了 <code class="highlighter-rouge">resolve</code> 时的代码，所以此处值得 <strong>注意</strong>；</p> <h1 id="await">await</h1> <p>用法顾名思义，有<strong>等待</strong>的意思，语法为：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">myPromise</span><span class="p">();</span> </code></pre></div></div> <p><strong>注意</strong> <code class="highlighter-rouge">await</code> 必须在 <code class="highlighter-rouge">async function</code> 内使用，否则会提示语法错误；</p> <p>这里的 <code class="highlighter-rouge">myPromise()</code> 是一个 Promise对象，而自定义的变量 <code class="highlighter-rouge">value</code> 则用于获取 Promise 对象返回的 <strong>resolve</strong> 状态值，如果 await 后面跟的是其他值，则直接返回该值；</p> <p>所以，所谓<strong>等待</strong>其实就是指暂停当前 <code class="highlighter-rouge">async function</code> 内部语句的执行，等待后面的 <code class="highlighter-rouge">myPromise()</code> 处理完返回结果后，继续执行 <code class="highlighter-rouge">async function</code> 函数内部的剩余语句；</p> <p>举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">resolve</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">// 4 会被直接返回</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 1</span> <span class="c1">// 2 (2 秒后输出)</span> <span class="c1">// 3</span> <span class="c1">// 4</span> </code></pre></div></div> <p>如果不用获取返回值，也可以直接执行语句：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="nx">resolve</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 1</span> <span class="c1">// 2 (2 秒后)</span> <span class="c1">// 3</span> </code></pre></div></div> <p><strong>注意</strong>，如之前所说，await 会等到后面的 Promise <strong>返回结果</strong>后才会执行 async 函数后面剩下的语句，也就是说如果 Promise 不设置返回值（如 resolve），后面的代码就不会执行，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 1</span> <span class="c1">// 2 (2 秒后输出，并且后面不会继续输出 3)</span> </code></pre></div></div> <p>如果 await 后面的 Promise 返回一个 <code class="highlighter-rouge">reject</code> 状态的结果的话，则会被当成错误在后台抛出，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">reject</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 1</span> <span class="c1">// Uncaught (in promise) 2 (2 秒后输出)</span> </code></pre></div></div> <p>如上，2 秒后会抛出出错误，并且 3 这个数并没有被输出，说明后面的执行也被忽略了；</p> <p>async 也可以用于申明匿名函数用于不同场景，或者嵌套使用 async 函数，如 <code class="highlighter-rouge">await async</code> 的形式，只是要在 await 后面使用 async 形式的函数的话，需要这个函数立即执行且有返回值；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">fn</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">await</span> <span class="p">(</span><span class="k">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">})();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">3</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">await</span> <span class="nx">fn2</span><span class="p">());</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 1</span> <span class="c1">// 2</span> <span class="c1">// 3</span> </code></pre></div></div> <p>另外，await 后面的 Promise 返回的 reject， 也可以被该 async 函数返回的 Promise 对象以 reject 状态获取，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">reject</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span> <span class="p">});</span> <span class="c1">// 1</span> <span class="c1">// 2 (2 秒后输出)</span> </code></pre></div></div> <p>这种情况就不会以错误抛出，直接对异常值进行了处理，并且最后同样没有输出数字 3，即后面的代码依然被忽略了；</p> Fri, 02 Aug 2019 00:00:00 +0000 https://knightyun.github.io/2019/08/02/js-async-await Linux中sudo免密码 https://knightyun.github.io/2019/06/20/sudo-nopasswd <p>平时在 Linux 中执行一些命令时，可能会遇到 <code class="highlighter-rouge">Permission denied</code> 这样的提示，即该用户没有权限；</p> <p>所以一般会想到在命令最前面加上 <code class="highlighter-rouge">sudo</code> 后再执行，然后有可能会提示输入当前用户的密码；</p> <p>再接下来，如果命令没有正常执行，一般又会提示：<code class="highlighter-rouge">user is not in the sudoers file. This incident will be reported.</code>，即当前用户没有出现在这个叫 <code class="highlighter-rouge">sudoers</code> 的文件里面，那么这个文件在哪里呢？</p> <p>一般在这个位置：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/sudoers </code></pre></div></div> <p>所以只需要把当前用户添加到这个文件就行了，执行 <code class="highlighter-rouge">su</code> 后根据提示输入 <code class="highlighter-rouge">root</code> 账户密码，切换到 root 用户，然后用 <code class="highlighter-rouge">vi /etc/sudoers</code> 或者 <code class="highlighter-rouge">visudo</code> 命令编辑该文件；</p> <p>在里面可以找到这一行：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root ALL=(ALL:ALL) ALL </code></pre></div></div> <p>大致意思是 root 用户具有所有权限，所以可以在下面加入这么一行：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>user ALL=(ALL:ALL) NOPASSWD:ALL </code></pre></div></div> <p>其中 <code class="highlighter-rouge">user</code> 是当前登录的用户名，这样以后使用该账户执行 <code class="highlighter-rouge">sudo</code> 就不用输入密码了；</p> <p>如果存在多个账户，要让这些账户执行 <code class="highlighter-rouge">sudo</code> 时都不用输入密码的话，可以添加下面这行：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%sudo ALL=(ALL:ALL) NOPASSWD:ALL </code></pre></div></div> <p>保存退出就 OK 了。</p> Thu, 20 Jun 2019 00:00:00 +0000 https://knightyun.github.io/2019/06/20/sudo-nopasswd JavaScript事件循环 https://knightyun.github.io/2019/06/20/js-event-loop <h1 id="运行时runtime">运行时（runtime）</h1> <p>一个 JavaScript 运行时包含 <strong>栈(stack), 堆(heap), 队列(queue)</strong>;</p> <h1 id="栈-stack">栈 (stack)</h1> <p><strong>栈</strong> 具有 <strong>先进后出 (FILO, First In Last Out)</strong> 的特点，有时也叫做 <strong>堆栈</strong>，可以理解为一个开口向上的容器，先进入的物体压瓶底，后进入的物体一层层向上堆叠，最后取出时，也是一个个拿出来，先拿出最后放进去的，也就是在最上面那个，最后拿出的就是之前第一个放入瓶底的物体；其中容器里的每一个物体叫做 <strong>栈帧</strong>，理解为动画的每一帧，即最小单元；</p> <p>动画描述：</p> <p><img src="https://i.loli.net/2019/06/19/5d0a3c772749842497.gif" alt="stack_null.gif" /></p> <p>JavaScript 执行时，每一个调用函数执行时会被压入栈中，称为 <strong>压栈</strong>，这个函数执行完毕后从栈中弹出，称为 <strong>弹栈</strong>；即某个物体放入容器一定时间后，再从容器里面取出来，方便为下一次放入物体腾出空间；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 1.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 0.</span><span class="dl">'</span><span class="p">);</span> <span class="nx">fn1</span><span class="p">();</span> <span class="c1">// Message 0.</span> <span class="c1">// Message 1.</span> </code></pre></div></div> <p>如果一个函数执行时还会调用第二个函数，那么第一个函数压入栈底后，随后第二个函数便会压在第一个上面，如果还存在第三个、第四个等等，便以此类推向上堆叠，直到最后调用的一个函数执行完之后，在从后往前一次弹出每一个函数；</p> <p>可以理解为容器放入第一个物体后，本来应该随后取出的，但是这个物体又牵连了第二个物体，所以又继续放入第二个，甚至第三个、第四个等等；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 1.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">fn1</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 2.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn3</span><span class="p">()</span> <span class="p">{</span> <span class="nx">fn2</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 3.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 0.</span><span class="dl">'</span><span class="p">);</span> <span class="nx">fn3</span><span class="p">();</span> <span class="c1">// Message 0.</span> <span class="c1">// Message 1.</span> <span class="c1">// Message 2.</span> <span class="c1">// Message 3.</span> <span class="c1">// 可以慢慢看几遍捋一下顺序</span> </code></pre></div></div> <p>演示动画：</p> <p><img src="https://i.loli.net/2019/06/19/5d0a400b56afd25428.gif" alt="stack_fn.gif" /></p> <p>到这里可能就有问题了，函数能无限调用下去？能无限向栈中压入物体？当然，这个容器是有限制的，例如，在电脑浏览器控制台输入以下代码：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="nx">fn</span><span class="p">(){</span><span class="nx">fn</span><span class="p">()})()</span> </code></pre></div></div> <p>其实就是一个递归函数，不断调用自己，并且一直执行下去，那么不出意外，会弹出如下错误提示：</p> <p><img src="https://i.loli.net/2019/06/18/5d08ec91b92e653156.png" alt="stack-exceed-fn.png" /></p> <p>大致意思就是说执行栈发生了溢出，就是不断调用的函数太多了，超过了栈的规定大小；</p> <p>也可以尝试输入以下代码，看一下使用的浏览器的栈的尺寸：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">++</span><span class="nx">i</span><span class="p">);</span> <span class="nx">fn</span><span class="p">();</span> <span class="p">})()</span> </code></pre></div></div> <p>回车之后，在浏览器没有卡死的情况下 -_-，n 分钟之后，应该会出现以下错误提示：</p> <p><img src="https://i.loli.net/2019/06/18/5d08ecab407ee90019.png" alt="stack-exceed-num.png" /></p> <p>最后一个出现的数字应该就是极限了，这里使用的是 Chrome 浏览器，可以看出还是比较大的；</p> <h1 id="堆-heap">堆 (heap)</h1> <p><strong>堆</strong> 在运行期间被用来动态分配内存，比如给变量、对象、数组、字符串等分配特定的内存地址，用以访问，不像栈和队列，它是一个非结构化的区域；</p> <h1 id="队列-queue">队列 (queue)</h1> <p><strong>队列</strong> 具有 <strong>先进先出 (FIFO, First In First Out)</strong> 的特点，这里就理解为排队取餐的一队人，先到先得，然后从前面先走，后来的排在最后，并且不允许插队；</p> <p>在 JavaScript 运行时中，队列的结构被应用到了 <strong>消息队列</strong> 中；前面说到代码执行时，调用函数执行时被压入执行栈 (call stack) 中，并且需要等待该函数彻底执行完后，才能弹出栈，但是假如遇到 <code class="highlighter-rouge">setTimeout</code> 这样延时事件，由于 JavaScript 引擎的 <strong>单线程</strong> 特点，区别于其他语言，因此执行是不会因为延时函数而中断的，此时便会将 <code class="highlighter-rouge">setTimeout</code> 延时调用的函数放入 <strong>消息队列</strong> 中，等待当前环境所有压栈、弹栈操作执行完毕，再按照顺序执行队列中的调用函数；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 1.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">fn1</span><span class="p">();</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="nx">delay1</span><span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 2.</span><span class="dl">'</span><span class="p">);</span> <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn3</span><span class="p">()</span> <span class="p">{</span> <span class="nx">fn2</span><span class="p">();</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="nx">delay2</span><span class="p">(){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 2.5.</span><span class="dl">'</span><span class="p">)</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 3.</span><span class="dl">'</span><span class="p">)</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Message 0.</span><span class="dl">'</span><span class="p">)</span> <span class="nx">fn3</span><span class="p">();</span> <span class="c1">// Message 0.</span> <span class="c1">// Message 1.</span> <span class="c1">// Message 3.</span> <span class="c1">// Message 2.</span> <span class="c1">// Message 2.5. (大约 1 秒后)</span> </code></pre></div></div> <p>动画演示：</p> <p><img src="https://i.loli.net/2019/06/19/5d0a53f02b34680755.gif" alt="stack_fn_queue.gif" /></p> <p>这里的结果就明显与之前的例子不同了，根据上面的描述，顺序为：</p> <ul> <li>输出 <code class="highlighter-rouge">Message 0.</code>；</li> <li><code class="highlighter-rouge">fn3()</code> 压入栈底；</li> <li>然后压入 <code class="highlighter-rouge">fn2()</code>；</li> <li>最后压入 <code class="highlighter-rouge">fn1()</code>；</li> <li><code class="highlighter-rouge">fn1()</code> 内的语句执行完后，输出 <code class="highlighter-rouge">Message 1.</code>；</li> <li>执行函数 <code class="highlighter-rouge">fn2()</code> 的语句；</li> <li>由于 <code class="highlighter-rouge">fn2()</code> 内的 <code class="highlighter-rouge">setTimeout()</code> 函数是一个延时函数，所以其调用函数 <code class="highlighter-rouge">delay1()</code> 就被放到了消息队列中；</li> <li>然后执行 <code class="highlighter-rouge">fn3()</code> 中的 <code class="highlighter-rouge">setTiemout()</code>，其调用函数 <code class="highlighter-rouge">delay2()</code> 也被放入了队列中；</li> <li>由于 <code class="highlighter-rouge">delay1()</code> 的延时小于 <code class="highlighter-rouge">delay2()</code>，所以 <code class="highlighter-rouge">delay2()</code> 被放到了 <code class="highlighter-rouge">delay()</code> 的后面，反之颠倒顺序；</li> <li>输出 <code class="highlighter-rouge">fn3()</code> 中的 <code class="highlighter-rouge">Message 3.</code>；</li> <li>此时开始执行消息队列的函数；</li> <li>先执行 <code class="highlighter-rouge">delay1()</code> 输出 <code class="highlighter-rouge">Message 2.</code>；</li> <li>然后执行 <code class="highlighter-rouge">delay2()</code> 输出 <code class="highlighter-rouge">Message 2.5</code>；</li> </ul> <p><strong>注意</strong>，即使 <code class="highlighter-rouge">delay1()</code> 的延时为 <code class="highlighter-rouge">0</code>，也并不意味着该回调函数会在 0 毫秒后执行，即不会立即执行，由于机制原因，同样会被放入消息队列中，只不过会 <strong>比较早执行</strong> 而已；</p> <h1 id="事件循环-event-loop">事件循环 (Event Loop)</h1> <p>所谓事件循环，大致就是上诉过程；这里的 <strong>事件</strong> 指的就是消息队列中的消息，即队列中的调用函数；<strong>循环</strong> 即不断执行完队列中的消息，并等待是否有新消息到达，进而将其执行的这一循环过程；</p> <h1 id="宏任务微任务">宏任务/微任务</h1> <p>由于 JavaScript 的执行是<strong>单线程</strong>的（浏览器是多线程的），所以为了避免代码执行时遇到一些耗时的操作阻塞后续操作，就有了<strong>同步任务</strong>和<strong>异步任务</strong>之分；在 js 执行期间，遇到同步任务就执行<strong>入栈</strong>操作，遇到异步任务就放入<strong>队列</strong>中，栈中的同步任务执行完后再执行队列中的异步任务，也就是上面说的事件循环，这样就避免了耗时任务对栈中主线程的阻塞，一般大多数函数和变量声明都是同步任务，异步任务占少数如 <code class="highlighter-rouge">setTimeout()</code>, <code class="highlighter-rouge">setInterval()</code>, <code class="highlighter-rouge">Promise()</code> 等；其中，异步任务又可分为<strong>宏任务</strong>和<strong>微任务</strong>；</p> <p>宏任务常见的有 <code class="highlighter-rouge">setTimeout()</code>, <code class="highlighter-rouge">setInterval()</code>，微任务常见的便是 <code class="highlighter-rouge">Promise()</code> 和 <code class="highlighter-rouge">process.nextTick()</code>（nodejs 中使用）；之前只提到消息队列，这里为了便于理解可以把宏任务和微任务看成两个分开的队列：宏任务队列与微任务队列；</p> <p>我们通过以下代码看一下同步任务、宏任务、微任务的执行顺序：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sync task.</span><span class="dl">'</span><span class="p">);</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Macro task.</span><span class="dl">'</span><span class="p">);</span> <span class="p">},</span> <span class="mi">0</span><span class="p">);</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">Micro task.</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="p">})</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">End.</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// Sync task.</span> <span class="c1">// End.</span> <span class="c1">// Micro task.</span> <span class="c1">// Macro task.</span> </code></pre></div></div> <p>接下来我们把宏任务和微任务的顺序换一下，再看一下结果：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sync task.</span><span class="dl">'</span><span class="p">);</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">Micro task.</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span> <span class="p">})</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Macro task.</span><span class="dl">'</span><span class="p">);</span> <span class="p">},</span> <span class="mi">0</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">End.</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// Sync task.</span> <span class="c1">// End.</span> <span class="c1">// Micro task.</span> <span class="c1">// Macro task.</span> </code></pre></div></div> <p>综合结果证明，任务的执行顺序是：</p> <pre><code class="language-txt">同步任务 --&gt; 微任务 --&gt; 宏任务 </code></pre> Thu, 20 Jun 2019 00:00:00 +0000 https://knightyun.github.io/2019/06/20/js-event-loop JavaScript实现元素全排列 https://knightyun.github.io/2019/05/11/js-permutation <h1 id="排列-permutation--arrangement">排列 (Permutation / Arrangement)</h1> <h2 id="概念">概念</h2> <p>n 个不同元素中任意选取 m (m &lt;= n) 个元素进行排列，所有排列情况的个数叫做 <strong>排列数</strong>，其值等于：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A = n! / (n - m)! </code></pre></div></div> <p><code class="highlighter-rouge">!</code> 表示数学中的阶乘运算符，可以通过以下函数实现：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">n</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span> <span class="c1">// 24</span> </code></pre></div></div> <p>当 n = m 时，称为 <strong>全排列</strong>，其值等于：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A = n! </code></pre></div></div> <p>全排列相当于将<strong>所有元素</strong>进行排序，得到所有不同顺序情况的个数；</p> <h2 id="分析">分析</h2> <p>利用阶乘函数，通过上述数学公式只能得到所有情况的个数值，不容易得到具体的每种情况，要获取每种情况的输出值的话需要另寻他法；</p> <p>用数组举例分析：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>全排列： [1, 2, 3] =&gt; [ [1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1] ] 共 6 种情况 树状图表示： 1 2 3 / \ / \ / \ 2 3 1 3 1 2 | | | | | | 3 2 3 1 2 1 =&gt; 6 3 个元素中选取 2 个时：(n = 3, m = 2) [1, 2, 3] =&gt; [ [1, 2], [1, 3], [2, 1], [2, 3], [3, 1], [3, 2] ] 共 6 种情况 树状图表示： 1 2 3 / \ / \ / \ 2 3 1 3 1 2 =&gt; 6 </code></pre></div></div> <h2 id="实现">实现</h2> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="cm">/* 参数 a 为输入数组， 元素个数 n 为 a 的长度， 选取个数为 m； */</span> <span class="kd">function</span> <span class="nx">permutation</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 保存最终输出结果</span> <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// 定义 m 值默认等于 n，即全排列</span> <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">||</span> <span class="nx">n</span><span class="p">;</span> <span class="c1">// 定义递归函数保存结果到数组中</span> <span class="c1">// _a 为输入数组，</span> <span class="c1">// tmpResult 为保存单个情况结果的数组</span> <span class="kd">function</span> <span class="nx">recur</span><span class="p">(</span><span class="nx">_a</span><span class="p">,</span> <span class="nx">tmpResult</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">tmpResult</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 结果达到 m 个时保存结果，</span> <span class="c1">// 停止递归并进入下一次遍历</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tmpResult</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">_a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 复制一份输入数组，防止引用值被改变</span> <span class="kd">let</span> <span class="nx">tmpA</span> <span class="o">=</span> <span class="nx">_a</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span> <span class="c1">// 复制一份保存结果的数组，防止每次遍历相互影响</span> <span class="kd">let</span> <span class="nx">_tmpResult</span> <span class="o">=</span> <span class="nx">tmpResult</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span> <span class="c1">// 保存当前遍历值</span> <span class="nx">_tmpResult</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tmpA</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="c1">// 删除当前遍历值，传递参数进入下一层递归</span> <span class="nx">tmpA</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="nx">recur</span><span class="p">(</span><span class="nx">tmpA</span><span class="p">,</span> <span class="nx">_tmpResult</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 开始执行递归，然后返回最后结果</span> <span class="nx">recur</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">permutation</span><span class="p">(</span><span class="nx">arr</span><span class="p">));</span> <span class="c1">// 3 个数全排列：</span> <span class="cm">/* [ [1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1] ] */</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">permutation</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// 3 个数中选取 2 个数排列：</span> <span class="cm">/* [ [1, 2], [1, 3], [2, 1], [2, 3], [3, 1], [3, 2] ] */</span> </code></pre></div></div> <p>最终实现函数就是 <code class="highlighter-rouge">permutation(a, m)</code>，其中参数 <code class="highlighter-rouge">a</code> 为输入数组，包含需要排列的所有元素，参数 <code class="highlighter-rouge">m</code> 为选取需要排列的个数，默认等于输入数组的长度，即默认全排列，注意 <code class="highlighter-rouge">m</code> 不能大于元素个数；</p> <h2 id="拓展">拓展</h2> <p>以上函数输出值为一个二维数组，如果需要便于观察，输出一个一维数组，可以定义一个合并函数：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">));</span> <span class="p">}</span> <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]));</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span> <span class="c1">// [123, 132, 213, 231, 312, 321]</span> </code></pre></div></div> Sat, 11 May 2019 00:00:00 +0000 https://knightyun.github.io/2019/05/11/js-permutation JavaScript之常见算法排序 https://knightyun.github.io/2019/05/01/js-sort <h1 id="冒泡排序">冒泡排序</h1> <p>冒泡排序即数组从头到尾，依次比较相邻两数的大小，不符合顺序则交换位置，一直循环直到排序完成。如果是升序排序，那么每一轮的一系列比较和交换之后，最大那个数一定会被排到最后（不信可以动手验证一下），可以理解为<strong>冒泡</strong>到最后，这样每一轮的最大那个数都冒到最后，所以每一轮需要比较的总数都在减少，直到剩一个数为止，序列就有序了，降序也是同样的道理；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 输入值 _arr 为需要排序的数组，返回一个有序新数组</span> <span class="kd">function</span> <span class="nx">bubbleSort</span><span class="p">(</span><span class="nx">_arr</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">_arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <h1 id="选择排序">选择排序</h1> <p>选择排序即从数组第一个数到倒数第二个数，分别与后面的数中的选出的最值（升序就是最小值）进行比较，满足条件（升序就是大于最小值）就交换位置，然后完成排序。这里可以理解为先<strong>选择</strong>出最小值，然后与前面的数进行比较和交换，就不用像冒泡那样挨个比较和交换了；另外，这里为了交换方便，记录的最值其实是该值在数组中的<strong>索引</strong>，而不是实际值；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">selectSort</span><span class="p">(</span><span class="nx">_arr</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">_arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">minIdx</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">minIdx</span><span class="p">])</span> <span class="nx">minIdx</span> <span class="o">=</span> <span class="nx">j</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// 如果当前值已经是最小值，就可以不用交换，</span> <span class="c1">// 避免浪费时间</span> <span class="k">if</span> <span class="p">(</span><span class="nx">minIdx</span> <span class="o">!==</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">minIdx</span><span class="p">];</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">minIdx</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <h1 id="插入排序">插入排序</h1> <p>插入排序即从第二个到最后一个数，分别与排在前面的有序序列（第一轮该序列只有一个数，肯定是有序的，之后每一轮结束这个有序序列都会增加）中的每个数进行比较，然后<strong>插入</strong>合适的位置使其有序，直到最后一个数插入时完成排序；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">insertSort</span><span class="p">(</span><span class="nx">_arr</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">_arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 先将插入值（当前值）备份，方便后续插入操作</span> <span class="kd">let</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="c1">// 插入值在有序序列中从右向左比较</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 下面就是“插入”操作的实现：</span> <span class="c1">// 如果插入值小于比较值（j-1），则将前面的数向后挪一位，</span> <span class="c1">// 这样就可以把被插入的空间留出来了，并且在不断向前移动</span> <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="c1">// 如果插入值大于或等于比较值，则把插入值放到这个比较值的后面</span> <span class="c1">// 也就是之前留出来的插入空间</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <h1 id="快速排序">快速排序</h1> <p>快速排序在数组中任选一个数（下面选第一个数）作中间值，然后将余下的数分别与其比较，比中间值小则放到左边，否则放右边，然后再进行递归，将放在左边和右边的数组分别作为新数组进行同样的排序操作，直到数组不能再分，最后将所有排序结果合并；这里<strong>快速</strong>可以理解为整个操作过程相比于其他方法简单快捷，找好任一个中间值后便将剩下的数挨个放入其左或右，而不用管左右数组是否有序，直到递归完成就整体有序了，至于排序是否快速就要看情况了；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 方法一：</span> <span class="kd">function</span> <span class="nx">quickSort</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">mid</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="c1">// 基准（中间值）</span> <span class="nx">left</span> <span class="o">=</span> <span class="p">[],</span> <span class="c1">// 放到基准左边的数</span> <span class="nx">right</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// 放到基准右边的数</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">mid</span><span class="p">)</span> <span class="p">{</span> <span class="nx">left</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">right</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 递归分割下去，不能分割时合并左中右数组返回</span> <span class="k">return</span> <span class="nx">quickSort</span><span class="p">(</span><span class="nx">left</span><span class="p">).</span> <span class="nx">concat</span><span class="p">(</span><span class="nx">mid</span><span class="p">).</span> <span class="nx">concat</span><span class="p">(</span><span class="nx">quickSort</span><span class="p">(</span><span class="nx">right</span><span class="p">));</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 方法二：</span> <span class="kd">function</span> <span class="nx">quickSort</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">midIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 基准值的索引</span> <span class="c1">// 这里执行的就是把值放入基准左边还是右边的操作</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 由于基准是第一个数，并且是从左向右遍历，</span> <span class="c1">// 所以后面的遍历值如果小于基准就先删除再 unshift 到最前面，</span> <span class="c1">// 这样就实现了“放到左边”，</span> <span class="c1">// 如果大于或等于基准就不用管，也就“放到右边”了；</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">midIdx</span><span class="p">])</span> <span class="p">{</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span> <span class="nx">midIdx</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">quickSort</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">midIdx</span><span class="p">)).</span> <span class="nx">concat</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">midIdx</span><span class="p">]).</span> <span class="nx">concat</span><span class="p">(</span><span class="nx">quickSort</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">midIdx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)));</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 经测试方法一比方法二快一些，数组越大相差倍数数量级也越大。</span> <span class="c1">// 显而易见方法一在空间上消耗不少，所以在时间上占优势；</span> </code></pre></div></div> <h1 id="归并排序">归并排序</h1> <p>归并排序<strong>递归</strong>地将数组分割为两个部分（左数组与右数组），直到不能再分，然后再定义一个合并函数，负责<strong>递归</strong>地将两部分合并为一个有序数组作为返回值；合并函数其实会是合并两个有序的数组，合并方法便是分别将两数组第一个数取出（删除）放入返回数组中，至于两个数先放哪一个，可以通过比较大小来确定；所以这里的<strong>归并</strong>可以理解为递<strong>归</strong>地合<strong>并</strong>为一个有序序列；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">mergeSort</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 不能再分时返回数组，执行之后的合并操作</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// 将数组分割成两部分</span> <span class="kd">let</span> <span class="nx">mid</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">mid</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">right</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">mid</span><span class="p">);</span> <span class="c1">// 递归地合并每次分割的左右数组</span> <span class="k">return</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">mergeSort</span><span class="p">(</span><span class="nx">left</span><span class="p">),</span> <span class="nx">mergeSort</span><span class="p">(</span><span class="nx">right</span><span class="p">));</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 把左右数组合并为一个有序数组的函数</span> <span class="kd">function</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span><span class="p">)</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span> <span class="kd">let</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">left</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">right</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 分割后左数组为空的情况</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">left</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">right</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span> <span class="c1">// 右数组为空</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">right</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span> <span class="c1">// 左右数组都不为空</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// 较小的元素优先放入</span> <span class="k">if</span> <span class="p">(</span><span class="nx">left</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">right</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">left</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">right</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 不存在左右数组都为空的情况，因为总循环次数为 len</span> <span class="c1">// 所以左右数组都空之前已经停止循环了</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> Wed, 01 May 2019 00:00:00 +0000 https://knightyun.github.io/2019/05/01/js-sort JavaScript面向对象编程 https://knightyun.github.io/2019/05/01/js-oop <h1 id="概述">概述</h1> <p>面向对象编程思想，顾名思义，即模仿现实世界的存在物，一切节对象，拥有各自的特性与行为，如人类，外貌、肤色、身高、体重等是其特征，能吃饭睡觉行走是其行为；</p> <p>同样，编程中，一个对象拥有 <strong>属性(key/property)</strong>，相当于人类的特征，当然这些属性一般都有 <strong>属性值(value)</strong>，相当于人类特征的具体内容，如黄皮肤、身高 180cm；对象还拥有一类特殊属性，叫 <strong>方法(method)</strong>，也可以理解为一种属性，只不过它的属性值是一个函数，对象的方法就相当于人类的行为，如行走、吃饭、说话，别人叫你名字时你会做出回应等；</p> <h1 id="构造函数">构造函数</h1> <p>通常申明一个对象是这样的：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name, age 是对象 obj 的属性</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="na">greet</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">you</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// greet 是对象 obj 的方法，可以接受参数</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">you</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">, my name is </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// 'knight'</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">cloud</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'Hello cloud, my name is knight'</span> </code></pre></div></div> <p>面向对象编程则使用 <strong>构造函数</strong> 创建一个 <strong>对象构造器</strong>，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">greet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">you</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">you</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">, my name is </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>其实就是申明一个函数，只不过函数名通常首字母大写来区分普通函数，函数的作用也与普通函数有所区别；其中的 <strong><code class="highlighter-rouge">this</code></strong> 指向当前环境的对象，是一种方便的写法；</p> <h1 id="对象实例">对象实例</h1> <p>上面创建了一个对象构造函数，当然这还只是一个函数，不是一个直接能用的对象，从构造函数得到对应的对象，称为创建该构造函数的一个 <strong>实例(instance)</strong>，即一个新对象，使用 <code class="highlighter-rouge">new</code> 关键字：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">greet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">you</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">you</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">, my name is </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="c1">// 创建对象实例</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// "knight"</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">cloud</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// "Hello cloud, my name is knight"</span> </code></pre></div></div> <h2 id="new">new</h2> <p>使用 <code class="highlighter-rouge">new</code> 关键字时，其实大致执行了以下操作：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 正常使用 new</span> <span class="kd">function</span> <span class="nx">Obj</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">(</span><span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// Knight</span> <span class="c1">// 模拟使用 new</span> <span class="kd">function</span> <span class="nx">Obj</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">_new</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// 先创建一个空对象</span> <span class="nx">result</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="c1">// 执行原型链连接</span> <span class="kd">var</span> <span class="nx">_result</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span> <span class="c1">// 执行构造函数方法</span> <span class="k">if</span> <span class="p">(</span><span class="nx">_result</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 构造函数有返回值则返回该值</span> <span class="k">return</span> <span class="nx">_result</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span> <span class="c1">// 否则返回该对象</span> <span class="p">}</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">_new</span><span class="p">(</span><span class="nx">Obj</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// Knight</span> </code></pre></div></div> <h2 id="instanceof">instanceof</h2> <p>判断某对象是否是某函数的实例，需要用到 <code class="highlighter-rouge">instanceof</code> 操作符，注意是操作符，类似 <code class="highlighter-rouge">+ - * /</code>，而不是函数，用法如下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">date</span> <span class="k">instanceof</span> <span class="nb">Date</span><span class="p">);</span> <span class="c1">// true</span> </code></pre></div></div> <h2 id="constructor">constructor</h2> <p>反过来，想要知道某对象的构造函数，可以使用 <code class="highlighter-rouge">constructor</code> 属性，一般对象都有这个属性，其值为该对象的构造函数；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="kd">constructor</span><span class="p">);</span> <span class="c1">// function Obj(){this.name='knight'}</span> <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="kd">constructor</span><span class="p">);</span> <span class="c1">// function Date(){[native code]}</span> </code></pre></div></div> <h1 id="原型">原型</h1> <p>构造函数创建实例后，函数内部定义的属性和方法也会复制一份到实例中，这类属性称为 <strong>own property</strong>，对象实例可以通过方法 <code class="highlighter-rouge">hasOwnProperty()</code> 检测是否拥有某属性，返回 <code class="highlighter-rouge">true / false</code>；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">));</span> <span class="c1">// true</span> </code></pre></div></div> <p>构造函数还能定义一种属性，叫做 <strong>prototype</strong>(原型)，这样所有实例都能获取函数定义的 <strong>公共</strong> 属性，定义方式如下：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">// 只能外部定义，不能在函数内部定义；</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span> <span class="c1">// 20</span> </code></pre></div></div> <p><strong>注意：</strong><code class="highlighter-rouge">prototype</code> 是函数的一个属性，同时<strong>对象</strong>也有一个隐式的原型，即对象的 <code class="highlighter-rouge">__proto__</code> 属性（前后各有两个下划线）指向其构造函数的 <code class="highlighter-rouge">prototype</code>，另外函数也存在 <code class="highlighter-rouge">__proto__</code> 属性指向其构造函数，不过对象是没有 <code class="highlighter-rouge">prototype</code> 属性的；通常存在以下关系：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{};</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span> </code></pre></div></div> <p>其实这就是常说的<strong>原型链</strong>，一般对象存在以下原型链指向关系：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{};</span> <span class="nx">o</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="c1">// true，对象是 Object 的实例</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="c1">// true，Object 是 Function 的实例，因为 Object 本身就是函数</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="c1">// true，Function 是 Function 的实例，Function 也是函数</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="c1">//true，函数的原型其实是个对象</span> <span class="nx">Objec</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// true，这是原型链指向的顶端，默认设为 null</span> </code></pre></div></div> <p>当定义较多属性时，可以将 <code class="highlighter-rouge">prototype</code> 定义为一个新对象：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="na">hobby</span><span class="p">:</span> <span class="dl">'</span><span class="s1">game</span><span class="dl">'</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hobby</span><span class="p">);</span> <span class="c1">// 'game'</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="kd">constructor</span><span class="p">);</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>如上，将 <code class="highlighter-rouge">prototype</code> 定义为新对象时，会 <strong>删除</strong> 对象的 <code class="highlighter-rouge">constructor</code> 值，因为 <code class="highlighter-rouge">constructor</code> 属性是定义在构造函数的 <code class="highlighter-rouge">prototype</code> 对象中的，所以从新定义 <code class="highlighter-rouge">prototype</code> 对象时需要 <strong>添加</strong> <code class="highlighter-rouge">constructor</code> 属性喝值：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span> <span class="na">constructor</span><span class="p">:</span> <span class="nx">Obj</span><span class="p">,</span> <span class="c1">// 只需写出构造函数名即可</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="na">hobby</span><span class="p">:</span> <span class="dl">'</span><span class="s1">game</span><span class="dl">'</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="kd">constructor</span><span class="p">);</span> <span class="c1">// function Obj(){this.name='knight'}</span> </code></pre></div></div> <p>这里也可看出，<code class="highlighter-rouge">constructor</code> 虽然可以判断对象的构造函数，但是它却是可以被更改的，因此尽量使用 <code class="highlighter-rouge">instanceof</code> 判断；</p> <h1 id="遍历对象属性">遍历对象属性</h1> <p>常用的遍历方法是 <code class="highlighter-rouge">for...in</code>，该方法可以遍历出对象的所有属性，包括原型 <code class="highlighter-rouge">prototype</code> 中定义的属性，因为 <code class="highlighter-rouge">prototype</code> 中的属性是无法用 <code class="highlighter-rouge">.hasOwnProperty()</code> 方法访问的，用法如下:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">age</span><span class="dl">'</span><span class="p">));</span> <span class="c1">// 非 own 属性</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="cm">/* 'name': 'knight' 'age': 20 */</span> </code></pre></div></div> <h1 id="继承">继承</h1> <p>多个构造函数需要相同的 <code class="highlighter-rouge">prototype</code> 时，避免每个设置一遍，重复代码，可以定义一个公共的 <code class="highlighter-rouge">prototype</code>，使用 <code class="highlighter-rouge">Object.create()</code> 复用代码:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">common</span> <span class="o">=</span> <span class="p">{</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">common</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span> <span class="c1">// 20</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// {}</span> </code></pre></div></div> <p>注意 <code class="highlighter-rouge">Object.create()</code> 方法是将括号内的对象设置为定义的对象的 <code class="highlighter-rouge">__proto__</code> 属性，所以直接输出 <code class="highlighter-rouge">obj</code> 会出现 <code class="highlighter-rouge">{}</code>，但是却可以访问其值，即该值在它的原型链上；</p> <p>该方法也可以用来 <strong>继承</strong> 其他构造函数的 <code class="highlighter-rouge">prototype</code> 属性，实现代码复用：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Common</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">hobby</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">game</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="nx">Common</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">Obj</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">knight</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Obj 继承 Common</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Common</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// 相当于 Obj.prototype.__proto__ = Common.prototype</span> <span class="c1">// 不要忘记把 constructor 改回来</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span> <span class="c1">// 20</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// {name: "knight"}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hobby</span><span class="p">);</span> <span class="c1">// undefined</span> </code></pre></div></div> <p>不过该方法存在问题，即子类只能继承父类原型中的属性和方法，父类中的私有属性和方法无法获取；</p> <p>改进版：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Common</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">Obj</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="nx">Common</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Common</span><span class="p">();</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">(</span><span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// {age: 20, name: "Knight"}</span> </code></pre></div></div> <p>这里就解决了之前的问题，子类可以继承父类的私有属性和方法，并且还能进行参数传递，同时也继承了父类的原型中的属性和方法；但是，细看会发现，构造函数其实被执行了两次，因此在实例和实例的原型中会出现相同的属性；</p> <p>最终版：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Common</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">Obj</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="nx">Common</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// 相当于只执行了 obj.prototype = new Common(); 步骤中的原型链连接操作</span> <span class="c1">// 即 obj.prototype.__proto__ = Common.prototype</span> <span class="c1">// 而没有执行构造函数 Common()</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Common</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="nx">Obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Obj</span><span class="p">(</span><span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// {age: 20, name: "Knight"}</span> </code></pre></div></div> <p>这种组合方式也基本成为了最理想的继承实现方式；</p> Wed, 01 May 2019 00:00:00 +0000 https://knightyun.github.io/2019/05/01/js-oop ECMAScript 发展简史 https://knightyun.github.io/2019/05/01/js-ecmascript-history <blockquote> <p>ECMAScript，简称 ES，是 JavaScript 的标准版，经历了不同版本的变化；</p> </blockquote> <ul> <li> <p>最初由于网速慢，网页验证表单需要通过服务器完成，因此Netscape（网景）公司决定开发这样一种用于处理验证的客户端语言；</p> </li> <li> <p>1995年，发布 LiveScript，由于当时 Java 很火，就顺便改名为 JavaScript 蹭热度，与 Netscape Navigator 2 一同发布，成为 JavaScript 1.0;</p> </li> <li> <p>1996年，JavaScript 1.1 与 Netscape Navigator 3 发布，同时微软也在 IE3 中加入 JScript（避免命名授权问题）；</p> </li> <li> <p>1997年，ECMAScript 成为 JavaScript 的标准版本，标准命名为 ECMA-262，第一版为 ES1.0；</p> </li> <li> <p>1998年，ES2.0 发布；</p> </li> <li> <p>1999年，ES3.0 发布，标志其成为一门真正编程语言，成为JavaScript语法基础，即我们所学的 JavaScript；</p> </li> <li> <p>2000年，ES4.0 发布，新标准几乎是区别于ES3的新语言，所以由于激进未通过，激烈争论了几年。。。</p> </li> <li> <p>2008年，ES3.1 发布，作为 ES4.0 的替代方案，中止了 ES4.0的发布；</p> </li> <li> <p>2009年，ES3.1 作为第五版（ES5.0）正式发布；</p> </li> <li> <p>2011年，ES5.1 发布，成为国际标准；</p> </li> <li> <p>2015年，ES6 正式成为国际标准，又称 ES2015，也是指 ES5.1 后的下一代JavaScript标准；</p> </li> </ul> <p><strong>总结：JavaScript = ECMAScript(核心) + DOM + BOM;</strong></p> Wed, 01 May 2019 00:00:00 +0000 https://knightyun.github.io/2019/05/01/js-ecmascript-history JavaScript之call，bind，apply方法及 this 的用法辨析 https://knightyun.github.io/2019/05/01/js-call <h1 id="概述">概述</h1> <p>JavaScript函数中的三个方法<code class="highlighter-rouge">.call()</code>, <code class="highlighter-rouge">.apply()</code>, <code class="highlighter-rouge">.bind()</code>，总体来说主要功能就是改变函数中 <code class="highlighter-rouge">this</code> 关键字的指向，因为 <code class="highlighter-rouge">this</code> 默认指向<strong>当前环境的对象</strong>；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">,</span> <span class="na">getName</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// this 指向 obj 对象</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span> <span class="c1">// 'Knight'</span> </code></pre></div></div> <h1 id="call">call()</h1> <p><code class="highlighter-rouge">.call()</code> 可以用于改变 <code class="highlighter-rouge">this</code> 值的指向，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// 此处 this 指向全局对象 window;</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Cloud</span><span class="dl">'</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">();</span> <span class="c1">// 'Knight'</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// 'Cloud'</span> <span class="c1">// 此处指向了 obj 对象，所以 name 变了</span> </code></pre></div></div> <p>也可以传递函数参数，平常调用函数的形式可能是这样：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// 5</span> </code></pre></div></div> <p>现在也可以这样调用：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">n</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// 5</span> <span class="c1">// 因为函数里没有用到 this，</span> <span class="c1">// 所以可以设置为 null</span> </code></pre></div></div> <h1 id="apply">apply()</h1> <p><code class="highlighter-rouge">.apply()</code> 与 <code class="highlighter-rouge">.call()</code> 类似，第一个参数也是用于改变 <code class="highlighter-rouge">this</code> 指向，区别就是 <code class="highlighter-rouge">apply()</code> 接受的函数参数是一个<strong>数组</strong>，例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Mu name is </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> years old.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">arr</span><span class="p">);</span> <span class="c1">// My name is Knight, 5 years old.</span> <span class="c1">// 使用 call() 的情况：</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// My name is Knight, 5 years old.</span> </code></pre></div></div> <h1 id="bind">bind()</h1> <p><code class="highlighter-rouge">.bind()</code> 也与 <code class="highlighter-rouge">.call()</code> 类似，改变 this 指向，传递函数参数，区别在于 <code class="highlighter-rouge">.bind()</code> 方法结果是创建一个新的 <strong>绑定函数</strong>，而之前的 <code class="highlighter-rouge">.call()</code> 和 <code class="highlighter-rouge">.apply()</code> 结果都是 <strong>立即执行函数</strong>，举例来理解：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Knight</span><span class="dl">'</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">My name is </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> years old.</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> <span class="kd">var</span> <span class="nx">fnn</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// fn.bind() 是一个函数，不会立即执行</span> <span class="nx">fnn</span><span class="p">();</span> <span class="c1">// My name is Knight, 5 years old.</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)();</span> <span class="c1">// 这种写法就是立即执行函数了，</span> <span class="c1">// 结果与上面一样;</span> </code></pre></div></div> <h1 id="this-的困境">this 的困境</h1> <p>考虑以下情况：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn2: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn2</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn1: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn1</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="dl">'</span><span class="s1">here</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 'fn1: here'</span> </code></pre></div></div> <p>结果不会输出 <code class="highlighter-rouge">fn2: here</code>，因为函数定义 <code class="highlighter-rouge">fn2</code> 里的 <code class="highlighter-rouge">this</code> 是一个新的指向，并且未定义，与外部函数 <code class="highlighter-rouge">fn1</code> 中的 <code class="highlighter-rouge">this</code> 不同；</p> <p>所以我们通常会进行一下处理：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">function</span> <span class="nx">fn2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn2: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// 对 this 进行转存</span> <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="nx">fn2</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn1: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn1</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="dl">'</span><span class="s1">here</span><span class="dl">'</span><span class="p">);</span> <span class="cm">/* fn2: here fn1: here */</span> </code></pre></div></div> <p>当然，ES6中的<strong>箭头函数</strong>解决了上述问题：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">fn2</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn2: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn2</span><span class="p">();</span> <span class="nx">fn2</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="dl">'</span><span class="s1">there</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">fn1: </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fn1</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="dl">'</span><span class="s1">here</span><span class="dl">'</span><span class="p">);</span> <span class="cm">/* fn2: here fn2: here fn1: here */</span> </code></pre></div></div> <p>由于 <code class="highlighter-rouge">.call()</code> 方法对箭头函数不起作用，所以上面的第二行输出与第一行相同；</p> Wed, 01 May 2019 00:00:00 +0000 https://knightyun.github.io/2019/05/01/js-call 个人博客网站添加文章搜索功能 https://knightyun.github.io/2019/03/04/articles-search <p>现在很多网站页面里都有搜索模块，包括在线搜索、站内搜索等等，尤其是博客类网站，文章搜索功能就显得比较重要，现在以个人博客网站为例，详细介绍如何给页面添加搜索功能模块，至于如何搭建个人博客网站，可以参考这篇文章：<a href="https://knightyun.github.io/2018/04/01/github-pages-blog">https://knightyun.github.io/2018/04/01/github-pages-blog</a>；</p> <h1 id="功能分析">功能分析</h1> <p>为网页添加搜索模块的第三方网站有不少，实现效果也都不错，既然人家都能通过代码实现此功能，与其过度依赖第三方，何不自己研究一下原理自己实现呢<em>_</em>；</p> <p>网页内搜索功能无非就是在文本输入框内输入一串想要搜索的关键字符串，点击搜索按钮后查找匹配出站内所有文章的匹配结果进行输出，再附上一个文章的链接；针对这个功能，作者本人第一时间想到的则是前端领域里的 <strong>Ajax</strong>，利用 <strong>XMLHttpRequest()</strong> 实现数据的交互，不清楚的可以自行百度快速补习，然后一般博客类网站都有 <strong>RSS</strong> 订阅功能及其数据页面，不清楚的也可以迅速百度了解一下，其实就是站内某个目录内存在一个叫 <strong>feed.xml</strong> 或者类似名字的页面，XML格式的，早期用于实现新闻内容订阅的，现在用的也比较广泛，里面存储的就是文章相关的一些数据，因此我们就可以获取这个文件里面的所有内容然后实现搜索匹配；</p> <p>如果像我一样用 <strong>Gihub Pages</strong> 搭建的个人博客网站的话，无论用的 <strong>jekyll</strong> 或者 <strong>hexo</strong>，一般这个 feed.xml 文件就位于 <strong>根目录</strong> 下，并且该文件同时记录着某一篇文章所对应的 <strong>标题、页面链接、文章内容</strong> 等内容，这三个部分后面将用到，xml 内容大致如下：</p> <p><img src="https://i.loli.net/2019/03/04/5c7d2c5c9a6ee.png" alt="rss" /></p> <p>当然有其他更好的实现方法可以自行参考或者在文末评论，那么接下来便通过这个方法来一步步实现搜素功能；</p> <h1 id="功能实现">功能实现</h1> <p>先预览一下页面最终的实现效果：</p> <p><img src="https://i.loli.net/2019/03/04/5c7cea40495b1.png" alt="search-box" /></p> <p>或者在这里：<a href="https://knightyun.github.io/">https://knightyun.github.io/</a> 预览我的博客的搜索模块的最终实现；</p> <h5 id="html部分">HTML部分</h5> <p>即页面样式，组成很简单，即一个文本输入框<code class="highlighter-rouge">&lt;input&gt;</code>和一个搜索图标，这里图标可以自行搜索下载一个，或者像下面一样使用在线图标，全部代码如下：</p> <p>先在<code class="highlighter-rouge">&lt;header&gt;&lt;/header&gt;</code>内部添加以下代码，使用在线图标：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"https://fonts.googleapis.com/icon?family=Material+Icons"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span> </code></pre></div></div> <p>然后在网页内需要添加搜索栏的合适位置添加以下代码，一般放在顶部导航栏：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"search"</span><span class="nt">&gt;</span> <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"material-icons search-icon search-start"</span><span class="nt">&gt;</span>search<span class="nt">&lt;/i&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"search-input"</span> <span class="na">placeholder=</span><span class="s">"Searching..."</span> <span class="nt">/&gt;</span> <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"material-icons search-icon search-clear"</span><span class="nt">&gt;</span>clear<span class="nt">&lt;/i&gt;</span> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"search-results"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>上面的<strong>clear</strong>是一个清除输入框内容的图标，<strong>search-results</strong>是用于输出匹配到的结果的板块；</p> <h5 id="css部分">CSS部分</h5> <p>然后来看一下<strong>CSS</strong>样式代码，仅供参考：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.search</span> <span class="p">{</span> <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span> <span class="nl">line-height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">padding-right</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span> <span class="p">}</span> <span class="nc">.search</span> <span class="nc">.search-icon</span> <span class="p">{</span> <span class="nl">float</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="m">10px</span><span class="p">;</span> <span class="nl">line-height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span> <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span> <span class="p">}</span> <span class="nc">.search</span> <span class="nc">.search-input</span> <span class="p">{</span> <span class="nl">float</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="m">30%</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">line-height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span> <span class="nl">border</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="m">#ddd</span><span class="p">;</span> <span class="nl">border-radius</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span> <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span> <span class="p">}</span> <span class="nc">.search</span> <span class="nc">.search-clear</span> <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span> <span class="p">}</span> <span class="nc">.search</span> <span class="nc">.search-results</span> <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span> <span class="nl">z-index</span><span class="p">:</span> <span class="m">1000</span><span class="p">;</span> <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span> <span class="nl">top</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">right</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span> <span class="nl">max-height</span><span class="p">:</span> <span class="m">400px</span><span class="p">;</span> <span class="nl">overflow</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span> <span class="nl">text-align</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span> <span class="nl">border-radius</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span> <span class="nl">background</span><span class="p">:</span> <span class="m">#ccc</span><span class="p">;</span> <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">.3rem</span> <span class="m">.5rem</span> <span class="m">#333</span><span class="p">;</span> <span class="p">}</span> <span class="nc">.search</span> <span class="nc">.search-results</span> <span class="nc">.result-item</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="no">aqua</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span> <span class="nl">padding</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span> <span class="nl">border-radius</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span> <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>样式可以自行随意调整，最终感觉好看就OK；</p> <h5 id="javascript部分">JavaScript部分</h5> <p>接下来就是重头戏了，也是实现搜索功能的核心部分，搜索逻辑的实现；</p> <p>再来大致分析一下逻辑，和实现的思路：</p> <ol> <li>利用XMLHttpRequest()获取站内feed.xml内的所有数据，保存到一个XML DOM对象中；</li> <li>将XML对象中的文章标题、链接、内容、索引等通过<code class="highlighter-rouge">getElementsByTagName()</code>等方法获取并保存到对应数组变量中；</li> <li>用户在输入框输入查找内容，提交后内容保存到一个字符串类型变量中；</li> <li>遍历保存文章内容的数组，通过<code class="highlighter-rouge">.search()</code>等方法和输入值进行匹配；</li> <li>匹配成功后得到所有匹配成功的数组元素的索引值，该索引值也是该内容的标题、链接数组对应的索引值；</li> <li>将最终搜集的文章标题、链接，以及匹配到的内容片段摘取输出到页面；</li> </ol> <p>这里附上最终的 js 实现代码与注释：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 获取搜索框、搜索按钮、清空搜索、结果输出对应的元素</span> <span class="kd">var</span> <span class="nx">searchBtn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.search-start</span><span class="dl">'</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">searchClear</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.search-clear</span><span class="dl">'</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">searchInput</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.search-input</span><span class="dl">'</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">searchResults</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.search-results</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 申明保存文章的标题、链接、内容的数组变量</span> <span class="kd">var</span> <span class="nx">searchValue</span> <span class="o">=</span> <span class="dl">''</span><span class="p">,</span> <span class="nx">arrItems</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arrContents</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arrLinks</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arrTitles</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arrResults</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">indexItem</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">itemLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">tmpDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span> <span class="nx">tmpDiv</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">result-item</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// ajax 的兼容写法</span> <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span> <span class="o">||</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="dl">'</span><span class="s1">Microsoft.XMLHTTP</span><span class="dl">'</span><span class="p">);</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span> <span class="nx">xml</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">;</span> <span class="nx">arrItems</span> <span class="o">=</span> <span class="nx">xml</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">item</span><span class="dl">'</span><span class="p">);</span> <span class="nx">itemLength</span> <span class="o">=</span> <span class="nx">arrItems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="c1">// 遍历并保存所有文章对应的标题、链接、内容到对应的数组中</span> <span class="c1">// 同时过滤掉 HTML 标签</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">itemLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">arrContents</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arrItems</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">description</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span> <span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;.*</span><span class="se">?</span><span class="sr">&gt;/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span> <span class="nx">arrLinks</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arrItems</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">link</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span> <span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;.*</span><span class="se">?</span><span class="sr">&gt;/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span> <span class="nx">arrTitles</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arrItems</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span> <span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;.*</span><span class="se">?</span><span class="sr">&gt;/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 开始获取根目录下 feed.xml 文件内的数据</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/feed.xml</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span> <span class="nx">searchBtn</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">searchConfirm</span><span class="p">;</span> <span class="c1">// 清空按钮点击函数</span> <span class="nx">searchClear</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">searchInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchClear</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// 输入框内容变化后就开始匹配，可以不用点按钮</span> <span class="c1">// 经测试，onkeydown, onchange 等方法效果不太理想，</span> <span class="c1">// 存在输入延迟等问题，最后发现触发 input 事件最理想，</span> <span class="c1">// 并且可以处理中文输入法拼写的变化</span> <span class="nx">searchInput</span><span class="p">.</span><span class="nx">oninput</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">searchConfirm</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="p">}</span> <span class="nx">searchInput</span><span class="p">.</span><span class="nx">onfocus</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">block</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">searchConfirm</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">searchInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchClear</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">searchInput</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="sr">/^</span><span class="se">\s</span><span class="sr">+$/</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 检测输入值全是空白的情况</span> <span class="nx">searchInit</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">itemDiv</span> <span class="o">=</span> <span class="nx">tmpDiv</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="nx">itemDiv</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">请输入有效内容...</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemDiv</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// 合法输入值的情况</span> <span class="nx">searchInit</span><span class="p">();</span> <span class="nx">searchValue</span> <span class="o">=</span> <span class="nx">searchInput</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="c1">// 在标题、内容中查找</span> <span class="nx">searchMatching</span><span class="p">(</span><span class="nx">arrTitles</span><span class="p">,</span> <span class="nx">arrContents</span><span class="p">,</span> <span class="nx">searchValue</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 每次搜索完成后的初始化</span> <span class="kd">function</span> <span class="nx">searchInit</span><span class="p">()</span> <span class="p">{</span> <span class="nx">arrResults</span> <span class="o">=</span> <span class="p">[];</span> <span class="nx">indexItem</span> <span class="o">=</span> <span class="p">[];</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">block</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchClear</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">block</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">searchMatching</span><span class="p">(</span><span class="nx">arr1</span><span class="p">,</span> <span class="nx">arr2</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 忽略输入大小写</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="dl">'</span><span class="s1">i</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 在所有文章标题、内容中匹配查询值</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">itemLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">search</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">arr2</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">search</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 优先搜索标题</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">search</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr1</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr2</span><span class="p">;</span> <span class="p">}</span> <span class="nx">indexItem</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// 保存匹配值的索引</span> <span class="kd">var</span> <span class="nx">indexContent</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">search</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span> <span class="c1">// 此时 input 为 RegExp 格式 /input/i，转换为原 input 字符串长度</span> <span class="kd">var</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">3</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// 将匹配到内容的地方进行黄色标记，并包括周围一定数量的文本</span> <span class="nx">arrResults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="nx">indexContent</span> <span class="o">-</span> <span class="nx">step</span><span class="p">,</span> <span class="nx">indexContent</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;mark&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="nx">indexContent</span><span class="p">,</span> <span class="nx">indexContent</span> <span class="o">+</span> <span class="nx">l</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/mark&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="nx">indexContent</span> <span class="o">+</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">indexContent</span> <span class="o">+</span> <span class="nx">l</span> <span class="o">+</span> <span class="nx">step</span><span class="p">));</span> <span class="p">}</span> <span class="p">}</span> <span class="c1">// 输出总共匹配到的数目</span> <span class="kd">var</span> <span class="nx">totalDiv</span> <span class="o">=</span> <span class="nx">tmpDiv</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="nx">totalDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">总匹配：&lt;b&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">indexItem</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/b&gt; 项</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">totalDiv</span><span class="p">);</span> <span class="c1">// 未匹配到内容的情况</span> <span class="k">if</span> <span class="p">(</span><span class="nx">indexItem</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">itemDiv</span> <span class="o">=</span> <span class="nx">tmpDiv</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="nx">itemDiv</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">未匹配到内容...</span><span class="dl">'</span><span class="p">;</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemDiv</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// 将所有匹配内容进行组合</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arrResults</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">itemDiv</span> <span class="o">=</span> <span class="nx">tmpDiv</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="nx">itemDiv</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">&lt;b&gt;《</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">arrTitles</span><span class="p">[</span><span class="nx">indexItem</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">》&lt;/b&gt;&lt;hr /&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">arrResults</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">itemDiv</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">onclick</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">changeHref(arrLinks[indexItem[</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">]])</span><span class="dl">'</span><span class="p">);</span> <span class="nx">searchResults</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemDiv</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">changeHref</span><span class="p">(</span><span class="nx">href</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 在当前页面点开链接的情况</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">href</span><span class="p">;</span> <span class="c1">// 在新标签页面打开链接的代码，与上面二者只能取一个，自行决定</span> <span class="c1">// window.open(href);</span> <span class="p">}</span> </code></pre></div></div> <p>可以把上面的代码保存到<code class="highlighter-rouge">search-box.js</code>这样的 js 文件中，然后引入到 html 页面里；</p> <p>看一下最终效果： <img src="https://i.loli.net/2019/03/04/5c7d2d2c18d93.png" alt="final" /></p> <p>或者来我的主页查看：<strong><a href="https://knightyun.github.io/">https://knightyun.github.io/</a></strong></p> Mon, 04 Mar 2019 00:00:00 +0000 https://knightyun.github.io/2019/03/04/articles-search 编程范式之命令式与函数式 https://knightyun.github.io/2019/01/27/programming-paradigm <p>很多语言是<strong>聚范式/多重范式</strong>编程，即支持多在编程范式，如面向对象(Java)，面向过程(C语言)，泛函(函数式)，元程序设计等；以下例子都用 <strong>JavaScript</strong> 举例；</p> <h1 id="命令式编程imperative">命令式编程(Imperative)</h1> <p>如命令一般指导程序一步步完成功能，如 for 循环：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">n</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span> <span class="p">}</span> <span class="nx">myFn</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// 3</span> </code></pre></div></div> <h1 id="函数式编程声明式functionaldeclarative">函数式编程/声明式(Functional/Declarative)</h1> <p><strong>函数式编程特点：</strong></p> <ul> <li>函数式编程是声明式的；</li> <li>提倡纯函数理念，变量私有，不同于面向对象编程的成员共享；</li> <li>无副作用，不影响其他外部变量；</li> <li>有些类似初中数学纯函数f(x)的定义，提供输入值，返回新的输出值，每次提供相同输入值总能返回相同输出值，使线程安全可靠；</li> </ul> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Array</span><span class="p">.</span><span class="nx">map</span><span class="p">();</span> <span class="c1">// 纯函数，输出唯一</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span> <span class="c1">// 非纯函数，输出不唯一</span> </code></pre></div></div> <ul> <li>函数的大量使用，变量中存储函数，动态创建函数，返回值为函数，函数作为参数传递，等等；</li> </ul> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 字符串通过函数储存在变量中</span> <span class="kd">var</span> <span class="nx">myStr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="dl">'</span><span class="s1">Hello World</span><span class="dl">'</span><span class="p">};</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myStr</span><span class="p">);</span> <span class="c1">// Hello World</span> <span class="c1">// 对象属性值储存为函数</span> <span class="kd">var</span> <span class="nx">myObj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Cloud</span><span class="dl">'</span><span class="p">,</span> <span class="na">getName</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span> <span class="c1">// Cloud</span> <span class="c1">// 动态创建函数，用时调用，用完销毁</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello </span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="dl">'</span><span class="s1">World</span><span class="dl">'</span><span class="p">;</span> <span class="p">})());</span> <span class="c1">// Hello World</span> <span class="c1">// 函数作为参数进行传递</span> <span class="kd">function</span> <span class="nx">paraFn</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myFn</span><span class="p">(</span><span class="nx">paraFn</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">World</span><span class="dl">'</span><span class="p">));</span> <span class="c1">// Hello World</span> <span class="c1">// 函数作为返回值</span> <span class="kd">function</span> <span class="nx">myFn2</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello </span><span class="dl">'</span><span class="p">;</span> <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">World</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myFn2</span><span class="p">()());</span> <span class="c1">// Hello World</span> </code></pre></div></div> <p><strong>总结：</strong>例如for循环一个数组，命令式便是写出具体循环的方式，声明式便是只写声明函数，只要循环结果，具体方式交给程序执行；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 命令式</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="p">[];</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">b</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="c1">// [1, 4, 9]</span> <span class="c1">// 声明式</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span> <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span> <span class="k">return</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">i</span><span class="p">;</span> <span class="p">});</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="c1">// [1, 4, 9]</span> </code></pre></div></div> <p>同样的结果，<strong>代码量和理解难易</strong>上，声明式都明显优于命令式对吧；</p> <p><strong>声明式编程：</strong></p> <p>特点：</p> <ul> <li> <p>说明想要实现的功能，让机器完成步骤以及如何实现；</p> </li> <li> <p>免去一些不必要的命令步骤，让思维集中在功能开发上，而不是冗长的复杂过程实现；</p> </li> </ul> <p>递归实现阶乘便是一个典型的函数式：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="c1">// 3 x 2 x 1 = 6</span> </code></pre></div></div> <p><strong>.map() .reduce()</strong>等 也是申明式编程函数；</p> <h1 id="函数合成">函数合成</h1> <p>一个值变成另一个值，中间经过多个函数，将多个函数合并为一个函数来实现；</p> <p>举个例子：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 高中数学常见的过程 g(x) = 2x; h(x) = x + 3; f(x) = 2x + 3; // 则可变换为以下形式，即我们所学的复合函数 f(x) = h(g(x)); </code></pre></div></div> <p>上面的<strong>f(x)</strong>便是一个合成函数，实现了变量<strong>x</strong>到<strong>2x + 3</strong>的转变；</p> <p>js的实现：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">gFn</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span><span class="mi">2</span><span class="p">;</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">hFn</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hFn</span><span class="p">(</span><span class="nx">gFn</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span> <span class="c1">// 5</span> <span class="c1">// 使用函数合成</span> <span class="kd">function</span> <span class="nx">fFn</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">hFn</span><span class="p">(</span><span class="nx">gFn</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fFn</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// 5</span> </code></pre></div></div> <h1 id="函数柯理化currying">函数柯理化(Currying)</h1> <p>以逻辑学家<strong><em>Haskell Curry</em></strong>命名，即使接收多个参数的函数变成接受单个参数的函数的过程。单参数会使函数合成更简单；</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 原函数</span> <span class="kd">function</span> <span class="nx">plusFn</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span><span class="p">;</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">plusFn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="c1">// 6</span> <span class="c1">// 柯理化后</span> <span class="kd">function</span> <span class="nx">plusFn</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">plusFn</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">));</span> <span class="c1">// 6</span> </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/programming-paradigm Kali Linux 自定义分辨率 https://knightyun.github.io/2019/01/27/linux-xrandr <p>Kali中无分辨率1920 x 1080，自定义的步骤：</p> <h1 id="方法一">方法一</h1> <p>控制台输入：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cvt 1920 1080 </code></pre></div></div> <p>会得到以下内容：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 1920x1080 59.96 Hz (CVT 2.07M9) hsync: 67.16 kHz; pclk: 173.00 MHz Modeline "1920x1080_60.00" 173.00 1920 2048 2248 2576 1080 1083 1088 1120 -hsync +vsync </code></pre></div></div> <p>复制后面的内容，然后在新控制台输入：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo xrandr --newmode "1920x1080_60.00" 173.00 1920 2048 2248 2576 1080 1083 1088 1120 -hsync +vsync </code></pre></div></div> <p>然后再输入：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>xrandr <span class="nt">--addmode</span> Virtual1 <span class="s2">"1920x1080_60.00"</span> </code></pre></div></div> <p>最后系统设置选择分辨率或者：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>xrandr <span class="nt">--output</span> Virtual1 <span class="nt">--mode</span> <span class="s2">"1920x1080_60.00"</span> </code></pre></div></div> <p>但是此方法<strong>重启会失效</strong>，因此可以使用方法二；</p> <h1 id="方法二">方法二</h1> <p>在 <code class="highlighter-rouge">/etc/profile</code> 文件末尾假如以下代码：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xrandr <span class="nt">--newmode</span> <span class="s2">"1920x1080_60.00"</span> 173.00 1920 2048 2248 2576 1080 1083 1088 1120 <span class="nt">-hsync</span> +vsync xrandr <span class="nt">--addmode</span> Virtual1 <span class="s2">"1920x1080_60.00"</span> </code></pre></div></div> <p>重启完成。</p> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/linux-xrandr Linux强行取消挂载 https://knightyun.github.io/2019/01/27/linux-umount <p>Linux系统有时需要取消挂载一些设备或者目录，</p> <p>例如：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># /dev/sdb挂载到了 /mnt/usb</span> umount /mnt/usb </code></pre></div></div> <p>但是多半会提示：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount: /mnt/usb: target is busy </code></pre></div></div> <p>如果已 <strong>备份</strong> 了数据需要强行卸载，并且尝试 <code class="highlighter-rouge">umount -f /mnt/usb</code> 还是失败的情况</p> <p>可以使用命令：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuser <span class="nt">-cu</span> /mnt/usb <span class="c">#查看挂载文件进程</span> fuser <span class="nt">-mv</span> /dev/sdb <span class="c">#或者查看挂载点进程</span> fuser <span class="nt">-ck</span> /mnt/usb <span class="c">#结束进程</span> fuser <span class="nt">-mk</span> /dev/sdb <span class="c">#使用挂载点结束进程</span> </code></pre></div></div> <p>或者使用 <strong>懒卸载</strong> 方式，命令执行后系统会自动关闭相关进程后再卸载：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount <span class="nt">-l</span> /mnt/usb </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/linux-umount Linux中apt install的lock问题 https://knightyun.github.io/2019/01/27/linux-apt-lock <p>Linux系统中有时执行 apt install 时，可能会显示以下问题：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E: 无法获得锁 /var/lib/dpkg/lock - open <span class="o">(</span>11: 资源暂时不可用<span class="o">)</span> E: 无法锁定管理目录<span class="o">(</span>/var/lib/dpkg/<span class="o">)</span>，是否有其他进程正占用它？ </code></pre></div></div> <p>根据提示分别找到对应的两个lock文件，移除即可；</p> <p>解决方法：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo rm</span> /var/cache/apt/archives/lock <span class="nb">sudo rm</span> /var/lib/dpkg/lock </code></pre></div></div> <p>再次运行就成功了。</p> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/linux-apt-lock JavaScript深度迭代遍历未知对象 https://knightyun.github.io/2019/01/27/js-iteration <p>面向对象编程的语言，都存在对对象的一些操作，其中就包括遍历未知对象的属性值。</p> <h1 id="通常情况">通常情况</h1> <p>常见的遍历对象的方法：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cloud</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span> <span class="p">}</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="c1">// name: cloud</span> <span class="c1">// age: 20</span> </code></pre></div></div> <h1 id="特殊情况">特殊情况</h1> <p>但是对象中又含有子对象，对象的属性又是另一个对象，或者更深层嵌套，上面方法就不适用了；</p> <p>下面使用<strong>递归</strong>实现这个功能：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="p">{</span> <span class="na">firstName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cloud</span><span class="dl">'</span><span class="p">,</span> <span class="na">lastName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">huang</span><span class="dl">'</span> <span class="p">},</span> <span class="na">age</span><span class="p">:</span> <span class="mi">20</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="c1">// 这里使用递归，属性类型为对象则进一步遍历</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span> <span class="c1">// 输出：</span> <span class="c1">// name: [object Object]</span> <span class="c1">// firstName: cloud</span> <span class="c1">// lastName: huang</span> <span class="c1">// age: 20</span> </code></pre></div></div> <p>这样的话不论对象有多复杂的结构都能全部遍历到位；</p> <h1 id="困境">困境</h1> <p>但同时，这也是个问题，一些对象层次非常深甚至是死循环的情况就尴尬了，类似于子对象属性与父对象属性一样，尝试用上诉函数遍历一下浏览器的<code class="highlighter-rouge">window</code> 对象就能体会了，你会后悔的；</p> <p>所以为避免这种尴尬情况，设置一个<strong>迭代深度值</strong>吧，指定遍历到第几代：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// depth为迭代深度值</span> <span class="kd">function</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="nx">depth</span><span class="o">++</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">depth</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>或者使用一种类似<strong>懒加载</strong>的形式：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 判断用户是否要继续迭代</span> <span class="k">if</span> <span class="p">(</span><span class="nx">confirmFn</span><span class="p">(</span><span class="dl">'</span><span class="s1">是否深入遍历？</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span> <span class="nx">myFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/js-iteration css属性前浏览器厂商前缀 https://knightyun.github.io/2019/01/27/css-webkit <p>CSS3中一些新功能也是目前导致各大浏览器不兼容的一个原因，这些新功能的出现，浏览器厂商们变便开始尝试融合、试验，所以就在这些功能前加上自己的特定前缀来执行自己的特定解决方法，为了让这些功能能在完全确认下来前使用；</p> <p>下面就是我们经常用到的前缀及其兼容浏览器：</p> <h2 id="-webkit-">-webkit-</h2> <p>Apple Webkit团队，兼容Android, Safari, Chrome, BlackBerry等；</p> <h2 id="-moz-">-moz-</h2> <p>Mozilla，兼容Firefox等;</p> <h2 id="-ms-">-ms-</h2> <p>Microsoft基金会，兼容IE;</p> <h2 id="-o-">-o-</h2> <p>兼容Opera, Opera Mini, Opera Mobile;</p> <p>因此对于一些较新的css3特性，需要添加以上前缀兼容每个浏览器，例如实现线性渐变，标准写法是 <code class="highlighter-rouge">linear-gradient()</code>，但是一下浏览器还未完全确定这一特性，就在前面添加一个前缀来进行试验执行，如 <code class="highlighter-rouge">-webkit-linear-gradient</code>；</p> <p>下面是开发中常用的兼容写法：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="n">linear-gradient</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="no">green</span><span class="p">,</span> <span class="no">blue</span><span class="p">);</span> <span class="nl">background</span><span class="p">:</span> <span class="n">-webkit-linear-gradient</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="no">green</span><span class="p">,</span> <span class="no">blue</span><span class="p">);</span> <span class="nl">background</span><span class="p">:</span> <span class="n">-moz-linear-gradient</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="no">green</span><span class="p">,</span> <span class="no">blue</span><span class="p">);</span> <span class="nl">background</span><span class="p">:</span> <span class="n">-o-linear-gradient</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="no">green</span><span class="p">,</span> <span class="no">blue</span><span class="p">);</span> <span class="nl">background</span><span class="p">:</span> <span class="n">-ms-linear-gradient</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="no">green</span><span class="p">,</span> <span class="no">blue</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/css-webkit CSS3过渡与动画 https://knightyun.github.io/2019/01/27/css-transition-animation <p>CSS3中出现很多新的特性，下面就讲一下其中比较好玩的<strong>3D操作</strong>，<strong>过渡</strong>和<strong>动画</strong>效果；</p> <h1 id="过渡transition">过渡(transition)</h1> <p>过渡就是使瞬间的样式变化，按照一定方式变得缓慢平缓；</p> <p>例如鼠标划过超链接时颜色的变化，点击按钮后的颜色变化等，默认转化都是瞬间完成，可能你已经习惯了这种变换，但有时候平缓一些看着还是比较舒适的；</p> <p>要实现样式的过渡变化，那么首先就学要有<strong>样式变换</strong>，例如鼠标划过，单击按钮，点击图片等操作，来实现颜色，尺寸，位置等样式的变化；</p> <p>下面是鼠标划过段落使文本变红的操作，应用所有 <code class="highlighter-rouge">transition</code>属性：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">p</span><span class="nd">:hover</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nt">p</span> <span class="p">{</span> <span class="nl">transition-property</span><span class="p">:</span> <span class="n">color</span><span class="p">;</span> <span class="nl">transition-duration</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="nl">transition-timing-function</span><span class="p">:</span> <span class="n">linear</span><span class="p">;</span> <span class="nl">transition-delay</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c3488ab322.gif" alt="image" /></p> <p>一共四个值，功能基本都是字面翻译的意思：</p> <ul> <li><strong>transition-property</strong></li> </ul> <p>执行过渡的属性，例子设置为颜色color的变化，也可以是width, font-size等，不设置的话默认是<code class="highlighter-rouge">all</code>，即所有属性；</p> <ul> <li><strong>transition-duration</strong></li> </ul> <p>过渡的时间，单位是秒，如1s, 2.3s，不设置的话默认 <code class="highlighter-rouge">0s</code>，即无过渡效果；</p> <ul> <li><strong>transition-timing-function</strong></li> </ul> <p>设置过渡时的变化方式，默认是 <code class="highlighter-rouge">ease</code>，即速度由慢到快再到慢，常用的还有 <code class="highlighter-rouge">linear</code>，线性变化速度均匀，还有其他几个方式，过渡时间短的话看不出什么区别；</p> <ul> <li><strong>transition-delay</strong></li> </ul> <p>延迟时间，即多少秒后执行过渡效果，默认 <code class="highlighter-rouge">0s</code>，不延迟；</p> <p>当然这么多单词可能记不住，一般使用快捷写法：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">p</span> <span class="p">{</span> <span class="nl">transition</span><span class="p">:</span> <span class="n">color</span> <span class="m">2s</span> <span class="n">linear</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span> <span class="c">/*最少要指定过渡时间*/</span> <span class="nt">p</span> <span class="p">{</span> <span class="nl">transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>也可以设置每个样式分别过渡，例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">p</span> <span class="p">{</span> <span class="nl">transition</span><span class="p">:</span> <span class="n">color</span> <span class="m">2s</span> <span class="n">linear</span><span class="p">,</span> <span class="n">font-size</span> <span class="m">.5s</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="m">1s</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>每个样式过渡之间用<strong>逗号</strong>隔开就行了；</p> <p>最后，由于是新特性，为了兼容性需要加上浏览器厂商前缀：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">p</span> <span class="p">{</span> <span class="nl">transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="nl">-webkit-transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="nl">-moz-transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="nl">-ms-transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="nl">-o-transition</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <h1 id="动画animation">动画(animation)</h1> <p>CSS3的动画是个很不错的技术，基本能取代一些动图，javascript，flash等；</p> <p>而动画里最重要的概念就是<strong>关键帧</strong>，也许你用PS做gif动图的时候看见过这个概念，所谓动画就是一帧一帧图片连续切换实现的效果，关键帧就是里面主要的一些帧；</p> <p>实现CSS动画也需要设置关键帧 <code class="highlighter-rouge">@keyframes</code>：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@keyframes</span> <span class="n">my-animation</span> <span class="p">{</span> <span class="nt">0</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nt">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span> <span class="p">}</span> <span class="nt">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>格式如上，@keyframes后面跟的是自定义的<strong>动画名称</strong>，后面会用到。里面的<strong>0%，50%，100%</strong>便是设置的三个关键帧及其对应样式，如果只需要设置首尾两个关键帧，可以这样写：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@keyframes</span> <span class="n">my-animation</span> <span class="p">{</span> <span class="nt">from</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span> <span class="p">}</span> <span class="nt">to</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c4eae8329a.gif" alt="image" /></p> <p>当然样式除了color还能设置多项样式；</p> <p>定义好关键帧后就直接在需要应用动画的元素标签内使用就行了，格式及所有属性如下：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p { animation-name: my-animation; animation-duration: 3s; animation-timing-function: ease; animation-delay: 0; animation-iteration-count: 3; animation-direction: normal; animation-play-state: running; } </code></pre></div></div> <p>发现了吧，很多属性和<strong>transition</strong>里面一样，简单介绍下：</p> <ul> <li><strong>animation-name</strong></li> </ul> <p>就是之前跟在@keyframea后面的自定义名称，之前设置的是 <code class="highlighter-rouge">my-animation</code>;</p> <ul> <li><strong>animation-duration</strong></li> <li><strong>animation-timing-function</strong></li> <li><strong>animation-delay</strong></li> </ul> <p>和前面一样，默认分别为 <code class="highlighter-rouge">0, ease, 0</code>；</p> <ul> <li><strong>animation-iteration-count</strong></li> </ul> <p>动画播放的次数，默认 <code class="highlighter-rouge">1</code>，但一般设置为 <code class="highlighter-rouge">infinite</code>，即无限循环；</p> <ul> <li><strong>animation-direction</strong></li> </ul> <p>动画播放的方向，<code class="highlighter-rouge">normal</code>为默认，正向播放，<code class="highlighter-rouge">reverse</code>为反向播放，<code class="highlighter-rouge">alternate</code>为正向后反向，<code class="highlighter-rouge">alternate-reverse</code>为反向后正向；</p> <ul> <li><strong>animation-play-state</strong></li> </ul> <p>播放状态，默认 <code class="highlighter-rouge">running</code>，运行，<code class="highlighter-rouge">paused</code>为暂停，可以在javascript中使用对动画进行控制；</p> <p>当然，这个属性比之前的transition还多，也有简便写法：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">p</span> <span class="p">{</span> <span class="nl">animation</span><span class="p">:</span> <span class="n">my-animation</span> <span class="m">3s</span> <span class="n">linear</span> <span class="n">infinite</span> <span class="n">alternate</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>其中 <code class="highlighter-rouge">animation-name</code> 和 <code class="highlighter-rouge">animation-duration</code>为必须设置的属性；</p> <p>同样，记得考虑浏览器兼容：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@-webkit-keyframes</span> <span class="n">mycanimation</span> <span class="p">{</span> <span class="nt">from</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span> <span class="p">}</span> <span class="nt">to</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="nt">p</span> <span class="p">{</span> <span class="nl">-webkit-animation</span><span class="p">:</span> <span class="n">my-animation</span> <span class="m">3s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span> <span class="p">}</span> <span class="c">/* -moz-, -ms-, -o- 格式类似 */</span> </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/css-transition-animation CSS3之2D与3D变换 https://knightyun.github.io/2019/01/27/css-transform <h1 id="目录">目录</h1> <hr /> <ul> <li><a href="#目录">目录</a></li> <li><a href="#关于坐标轴">关于坐标轴</a></li> <li><a href="#2d变换">2D变换</a> <ul> <li><a href="#translatexy">translate(x,y)</a></li> <li><a href="#rotatedeg">rotate(deg)</a></li> <li><a href="#scalexy">scale(x,y)</a></li> <li><a href="#skewxdegydeg">skew(xdeg,ydeg)</a></li> <li><a href="#matrixabcde">matrix(a,b,c,d,e)</a></li> </ul> </li> <li><a href="#3d变换">3D变换</a> <ul> <li><a href="#translate3dxyz">translate3d(x,y,z)</a></li> <li><a href="#rotate3dxyzdeg">rotate3d(x,y,z,deg)</a></li> <li><a href="#scale3dxyz">scale3d(x,y,z)</a></li> <li><a href="#matrix3d">matrix3d()</a></li> <li><a href="#perspective">perspective</a></li> <li><a href="#perspective-origin">perspective-origin</a></li> <li><a href="#backface-visibility">backface-visibility</a></li> </ul> </li> <li><a href="#其他属性">其他属性</a> <ul> <li><a href="#transform-origin">transform-origin</a></li> <li><a href="#transform-style">transform-style</a></li> <li><a href="#css-3d">CSS 3D</a></li> </ul> </li> </ul> <hr /> <p>css3实现了对元素执行2D平面变换，以及视觉上的3D空间变换，2D变换平时可能用的较多，3D效果也能锦上添花；</p> <h1 id="关于坐标轴">关于坐标轴</h1> <p>初中数学的几何学里我们便开始接触坐标轴，最基本的是平面直角坐标系<code class="highlighter-rouge">XoY</code>，然后延伸出空间直角坐标系<code class="highlighter-rouge">XYZ</code>，现在我们来说一下css中的坐标系；</p> <p>css甚至一下设备相关的开发中，基本都遵循这样一套坐标系：以手机屏幕为例，坐标系<strong>圆点</strong>位于屏幕最左上角；<strong>x轴</strong>水平，向右为正方向；<strong>y轴</strong>垂直，向下为正方向；<strong>z轴</strong>垂直于整个屏幕平面，向外为正方向，就是屏幕光线射向你眼睛的方向；</p> <p>如图：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c05d7bfbf0.png" alt="image" /></p> <h1 id="2d变换">2D变换</h1> <p>包括平移<code class="highlighter-rouge">translate()</code>，旋转<code class="highlighter-rouge">rotate()</code>，缩放<code class="highlighter-rouge">scale()</code>，倾斜<code class="highlighter-rouge">skew()</code>，矩阵<code class="highlighter-rouge">matrix()</code>；</p> <h2 id="translatexy">translate(x,y)</h2> <p>平移操作，包括<code class="highlighter-rouge">translateX(x)</code>, <code class="highlighter-rouge">translateY(y)</code>，括号内填平移参数值，可以是负值，即反方向；</p> <p>例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="c">/*元素向右平移50px，向下移60px*/</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translateX</span><span class="p">(</span><span class="m">50px</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">60px</span><span class="p">);</span> <span class="p">}</span> <span class="c">/*简写形式，效果相同*/</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translate</span><span class="p">(</span><span class="m">50px</span><span class="p">,</span> <span class="m">60px</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><strong>注意</strong><code class="highlighter-rouge">translate()</code>只指定一个值则默认是<strong>x轴</strong>位移，即水平移动；</p> <h2 id="rotatedeg">rotate(deg)</h2> <p>元素旋转，括号中参数为旋转角度，<strong>顺时针</strong>为正值，<strong>逆时针</strong>为负值，单位为<code class="highlighter-rouge">deg</code>，即多少度；</p> <p>例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="c">/* 顺时针旋转30° */</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c1133253ba.png" alt="rotate" /></p> <h2 id="scalexy">scale(x,y)</h2> <p>缩放元素，参数分别为x轴，y轴缩放倍数，包括<code class="highlighter-rouge">scaleX(x)</code>和<code class="highlighter-rouge">scaleY(y)</code>，提供一个参数表示<strong>按比例</strong>缩放；</p> <p>例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="c">/* 横向缩小一半，纵向放大一倍 */</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">.5</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c11e1729ad.png" alt="scale1" /></p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="c">/* 按比例放大3倍 */</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scale</span><span class="p">(</span><span class="m">3</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c11e1b4e89.png" alt="scale2" /></p> <h2 id="skewxdegydeg">skew(xdeg,ydeg)</h2> <p>包含<code class="highlighter-rouge">skewX(deg)</code>, <code class="highlighter-rouge">skewY(deg)</code>，表示在水平和垂直方向倾斜的角度；</p> <p>例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">skewX</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">skewY</span><span class="p">(</span><span class="m">45deg</span><span class="p">);</span> <span class="p">}</span> <span class="c">/* 简写 */</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">,</span> <span class="m">45deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>需要<strong>注意</strong>，如果元素为一个矩形，那么<code class="highlighter-rouge">skewX(30deg)</code>表示矩形<strong>顶边固定</strong>，底边<strong>向右</strong>倾斜<code class="highlighter-rouge">30deg</code>；<code class="highlighter-rouge">skewY(30deg)</code>表示矩形<strong>左边框固定</strong>，右边框<strong>向下</strong>倾斜<code class="highlighter-rouge">30deg</code>；</p> <p>可以根据上面讲的屏幕坐标系来记忆，x轴位于屏幕顶部，方向向右；y轴位于屏幕左部，方向向下；</p> <p>如果<code class="highlighter-rouge">skew()</code>只指定一个值，默认是<strong>水平倾斜</strong>；</p> <p><strong>skewX(30deg)</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c0fc60c6bd.png" alt="skewX" /></p> <p><strong>skewY(30deg)</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c10c4b187a.png" alt="skewY" /></p> <h2 id="matrixabcde">matrix(a,b,c,d,e)</h2> <p>这是一个综合属性，之前的平移，缩放，旋转，倾斜都能通过这个矩阵函数实现，对，大学里<strong>线性代数</strong>中的矩阵 T_T；</p> <p>其实这个函数就是前面四种操作的<strong>原理</strong>，函数共有六个参数，四种操作都对应不同的参数改变方式，像我们这种非数学专业的就不赘述原理了，前面的操作基本够用了(想寻找刺激就去百度“css matrix”吧)~~;</p> <h1 id="3d变换">3D变换</h1> <p>所谓3D就是在前面2D平面上多了一个<strong>z轴</strong>，方法名也差不多，然后能以分别以三根轴位基准进行变换，实现立体效果；</p> <p>看一下所有3D操作方法：</p> <h2 id="translate3dxyz">translate3d(x,y,z)</h2> <p>结合前面讲的空间坐标系和 x, y, z轴的位置，三个参数分别对应元素在三个坐标轴方向的平移值，也包含三个方法<code class="highlighter-rouge">translateX(x)</code>, <code class="highlighter-rouge">translateY(y)</code>, <code class="highlighter-rouge">translateZ(z)</code>；</p> <p>举例：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translateX</span><span class="p">(</span><span class="m">50px</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">60px</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translateZ</span><span class="p">(</span><span class="m">70px</span><span class="p">);</span> <span class="p">}</span> <span class="c">/* 简写 */</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">translate3d</span><span class="p">(</span><span class="m">50px</span><span class="p">,</span> <span class="m">60px</span><span class="p">,</span> <span class="m">70px</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><strong>注意：</strong> 关于设置 <code class="highlighter-rouge">translateZ(z)</code> 看不出效果的问题，后面说到设置<code class="highlighter-rouge">persoective</code>时会解释；</p> <h2 id="rotate3dxyzdeg">rotate3d(x,y,z,deg)</h2> <p>参数<code class="highlighter-rouge">x, y, z</code>为空间坐标系的一个坐标位置，然后由原点<code class="highlighter-rouge">(0, 0, 0)</code>指向这个点形成一个有方向的新轴，数学中称矢量，最后一个参数就是元素围绕刚才所形成的新轴旋转的度数；</p> <p>也包括 <code class="highlighter-rouge">rotateX(deg)</code>, <code class="highlighter-rouge">rotateY(deg)</code>, <code class="highlighter-rouge">rotateZ(deg)</code>，之前2D的 <code class="highlighter-rouge">rotate()</code> 便是这里的 <code class="highlighter-rouge">rotateZ()</code>；</p> <p>至于旋转的方向，判断方法类似于物理中的<strong>左手定则</strong>：角度指定为正的话，左手拇指与四指垂直，拇指指向元素围绕旋转的坐标轴或自定义轴，四指弯曲围绕方向就是旋转方向；</p> <p>举例：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotateX</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotateY</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotataZ</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="p">}</span> <span class="c">/* 自定义轴旋转 */</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotate3d</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">30deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><strong>rotateX(30deg)</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c13d0c4eef.png" alt="rotateX" /></p> <p><strong>rotateY(30deg)</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c142489a1d.png" alt="rotateY" /></p> <p>关于为什么这里的旋转不是想象中的效果，而是缩小，主要是没有设置视点，后面会讲；</p> <h2 id="scale3dxyz">scale3d(x,y,z)</h2> <p>元素关于三个轴的缩放比例，包括<code class="highlighter-rouge">scaleX(x)</code>, <code class="highlighter-rouge">scaleY(y)</code>, <code class="highlighter-rouge">scaleZ(z)</code>，举例：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scaleX</span><span class="p">(</span><span class="m">2</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scaleY</span><span class="p">(</span><span class="m">2</span><span class="p">);</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scaleZ</span><span class="p">(</span><span class="m">2</span><span class="p">);</span> <span class="p">}</span> <span class="c">/* 简写 */</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scale3d</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>需要<strong>注意</strong>这里的<code class="highlighter-rouge">scaleZ()</code>，正常情况下，扩大z轴会是物体<strong>变厚</strong>，但是css里面呈现的平面元素并没有<strong>厚度</strong>，所以这里的缩放z轴其实是缩放元素在z轴的<strong>坐标</strong>，所以要有效果必须要指定<code class="highlighter-rouge">translateZ()</code>的值；</p> <p>举例：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span> <span class="nl">perspective</span><span class="p">:</span> <span class="m">500</span><span class="p">;</span> <span class="p">}</span> <span class="nt">div</span> <span class="p">{</span> <span class="c">/* 必须这个顺序，先缩放后平移，不然无效果 */</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">scaleZ</span><span class="p">(</span><span class="m">2</span><span class="p">)</span> <span class="n">translateZ</span><span class="p">(</span><span class="m">100px</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c17ef48ae2.png" alt="scaleZ" /></p> <p>按照上面样式才能看到<code class="highlighter-rouge">scaleZ(2)</code>的效果，因为后面在z轴上移动了<code class="highlighter-rouge">100px</code>，缩放比例为2，最终会移动<code class="highlighter-rouge">200px</code>，屏幕上则表现为元素放大了一下，这是透视效果，就是那个 <code class="highlighter-rouge">perspective</code> 值，下面会讲到；</p> <h2 id="matrix3d">matrix3d()</h2> <p>和前面2D的<code class="highlighter-rouge">matrix()</code>相似，只不过这里括号里的参数有<strong>16个</strong>，矩阵更加复杂，跳过吧﹋o﹋，有兴趣可以自行百度~~；</p> <h2 id="perspective">perspective</h2> <p>在上面的示例中，有关z轴的平移和缩放通常情况下是看不出效果的，正是缺少这项属性值，叫做 <strong>透视</strong>，美术或设计中会出现这个词汇，就是实现物体近大远小的效果，远小最终会小到一个点，那就是 <strong>透视点</strong>，<code class="highlighter-rouge">perspective</code>就是用来设置那个点距离元素有多远，一般300~600很体现很好的透视效果，<strong>值越小元素透视变形越严重</strong>；</p> <p>需要<strong>注意</strong>的是，这项属性设置在应用透视效果元素的<strong>父元素</strong>的样式中，才能看出效果，例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span> <span class="nl">perspective</span><span class="p">:</span> <span class="m">500</span><span class="p">;</span> <span class="c">/* 考虑浏览器兼容 */</span> <span class="nl">-webkit-perspective</span><span class="p">:</span> <span class="m">500</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>也可以设置在元素本身，格式为：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">);</span> <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><strong>rotateX(45deg)</strong> 的更真实的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c1929babb1.png" alt="rotateX" /></p> <p><strong>rotateY(45deg)</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c19c45bbb4.png" alt="rotateY" /></p> <h2 id="perspective-origin">perspective-origin</h2> <p>此项设置透视点的位置，默认在元素几何中心，需要设置的话，格式如下：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span> <span class="c">/* 默认中心 */</span> <span class="nl">perspective-origin</span><span class="p">:</span> <span class="nb">center</span> <span class="nb">center</span><span class="p">;</span> <span class="c">/* 左上角 */</span> <span class="nl">perspective-origin</span><span class="p">:</span> <span class="nb">left</span> <span class="nb">top</span><span class="p">;</span> <span class="c">/* 右边中心 */</span> <span class="nl">perspective-origin</span><span class="p">:</span> <span class="nb">right</span> <span class="nb">center</span><span class="p">;</span> <span class="c">/* 底部中心 */</span> <span class="nl">perspective-origin</span><span class="p">:</span> <span class="nb">bottom</span> <span class="nb">center</span><span class="p">;</span> <span class="c">/* 也可以是长度 */</span> <span class="nl">perspective-origin</span><span class="p">:</span> <span class="m">30px</span> <span class="m">40px</span><span class="p">;</span> <span class="c">/*最后记得加 -webkit- 兼容 */</span> <span class="p">}</span> </code></pre></div></div> <p><strong>perspective-origin: left center</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c1c4ab6feb.png" alt="lc" /></p> <p><strong>perspective-origin: right center</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c1c4a7c0bf.png" alt="rc" /></p> <h2 id="backface-visibility">backface-visibility</h2> <p>翻译过来叫背面是否可见，可以设置<code class="highlighter-rouge">visible</code>和<code class="highlighter-rouge">hidden</code>，默认可见，比如元素正面有文字，设置背面可见，则关于y轴旋转180°后元素内文字变成镜像，否则不会出现；</p> <p><strong>backface-visibility: visible</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c1d8b0651d.png" alt="vi" /></p> <p><strong>backface-visibility: hidden</strong> 的效果(有旋转，只是背面不可见，则看不见了)：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c1e297689d.png" alt="hi" /></p> <h1 id="其他属性">其他属性</h1> <h2 id="transform-origin">transform-origin</h2> <p>设置2D/3D变化的基准，可以是长度值，也可以是 <code class="highlighter-rouge">left, right, top, bottom</code>，例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="c">/* 关于元素左上角旋转 */</span> <span class="nl">transform-origin</span><span class="p">:</span> <span class="nb">left</span> <span class="nb">top</span><span class="p">;</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><img src="https://i.loli.net/2019/01/26/5c4c1ed5f21a6.png" alt="lt" /></p> <h2 id="transform-style">transform-style</h2> <p>设置元素如何在3D空间呈现被嵌套的元素，选择是 <code class="highlighter-rouge">flat</code> 和 <code class="highlighter-rouge">preserve-3d</code>，默认<code class="highlighter-rouge">flat</code>；</p> <p>这里这么来理解，之前我们对一个元素执行变换时，都是以屏幕所在平面的坐标系在变换，但是元素如果存在子元素的话，<code class="highlighter-rouge">transform-style</code>就是用来确定在哪套坐标系上进行变换，<code class="highlighter-rouge">flat</code>表示任然以屏幕坐标系为基准，<code class="highlighter-rouge">preserve-3d</code>表示以<strong>变换后的父元素所在平面的坐标系</strong>为基准；</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">#parent</span> <span class="p">{</span> <span class="nl">transform-style</span><span class="p">:</span> <span class="n">preserve-3d</span><span class="p">;</span> <span class="nl">-webkit-transform-style</span><span class="p">:</span> <span class="n">preserve-3d</span><span class="p">;</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">)</span> <span class="n">rotateY</span><span class="p">(</span><span class="m">45deg</span><span class="p">);</span> <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">)</span> <span class="n">rotateY</span><span class="p">(</span><span class="m">45deg</span><span class="p">);</span> <span class="p">}</span> <span class="nf">#child</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">)</span> <span class="n">rotateX</span><span class="p">(</span><span class="m">45deg</span><span class="p">);</span> <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">perspective</span><span class="p">(</span><span class="m">500</span><span class="p">)</span> <span class="n">rotateX</span><span class="p">(</span><span class="m">45deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p><strong>flat</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c238db14da.png" alt="flat" /></p> <p><strong>preserve-3d</strong> 的效果：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c238dc1ae1.png" alt="pre" /></p> <p>例如，父元素绕x轴旋转了45度，并且设置<code class="highlighter-rouge">transform-style: preserve-3d</code>，而嵌套的子元素只绕y轴旋转45度，那么最终效果就是子元素绕父元素平面的y轴旋转了45度，看起来就像先x轴转45度后y轴转45度的效果；</p> <p>最后，别忘了为以上所有特性添加浏览器兼容前缀；</p> <p>顺便附上一个以上功能综合效果的演示页面，请戳下面：</p> <h2 id="css-3d"><a href="http://huangqiyun.top/css3d/">CSS 3D</a></h2> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/css-transform CSS单位与尺寸参数 https://knightyun.github.io/2019/01/27/css-px <h1 id="css单位">css单位</h1> <h2 id="px">px</h2> <p>常用的单位，即像素pixel缩写，但通常被当做绝对单位，但严格说并不是，因为官方考虑到观看不同设备显示屏时，使网页设计出的某一图形的显示大小在人眼中的观看效果差不多，而定义的一个相对值，即人以一臂之遥观看96DPI的显示屏的角度，大概就是利用透视的近大远小原理，照顾不同设备的最终观看效果。</p> <p>比如某网页图形设置为一固定的px值，在手机浏览器上显示是用直尺测大概1cm，但是同样在不缩放情况下，电脑显示屏测量可能就是1.5cm左右，如果是打印机打印出来的话也许就是2cm左右了。</p> <h2 id="em">em</h2> <p>常用的相对单位，前面的数字是比例，即相对于<strong>父元素</strong>的字体尺寸的比例，比如父元素字体16px，子元素设置1em，也可以理解为100%，那么子元素也是16px，同样，2em就是200%，32px，也可以是小数0.2em，1.5em等等。</p> <h2 id="rem">rem</h2> <p>类似于em，但rem是相对于<strong>根元素html</strong>，例如用css标签选择器给html标签设置字体尺寸font-size大小为20px，那么文档中的每个1rem就代表20px，1.5em代表30px，以此类推。</p> <h2 id="incmmm">in，cm，mm</h2> <p>这些虽然是生活中的物体测量单位，但网页的1cm尺寸的元素显示到显示器上，用直尺测量通常不是标准1cm，因为css已经默认设置1in=96px，前面也讲过px会因显示屏而不同，因此最终尺寸也不是绝对的，其他也差不多，所以这类尺寸很少用。</p> <p>尺寸比较：</p> <p><img src="https://i.loli.net/2019/01/26/5c4c2fdf10206.png" alt="size" /></p> <h1 id="显示原理">显示原理</h1> <h2 id="dpi-ppi">dpi, ppi</h2> <p>dpi(dot per inch)，即每英寸多少点，是针对打印机的一个概念，点可以理解为墨点；</p> <p>ppi(pixel per inch)，即每英寸多少像素，是针对显示器的概念，开发中一般关心显示器问题，所以一般认为<code class="highlighter-rouge">dpi</code>和<code class="highlighter-rouge">ppi</code>是同一个概念；</p> <h2 id="dpr">dpr</h2> <p>dpr(device pixel ratio)，即物理像素与独立像素的比例；</p> <ul> <li>物理像素</li> </ul> <p><strong>物理像素</strong>也叫<strong>设备像素</strong>，屏幕显示图像都是由很多个像素点组成，屏幕出厂时本身带的点阵数就是它的物理像素；</p> <ul> <li>独立像素</li> </ul> <p>而<strong>独立像素</strong>，又叫<strong>逻辑像素</strong>，或者<strong>css像素</strong>，顾名思义，逻辑嘛，当然是独立于物理的概念，大小没有固定实际值，也是前面提到的css里面的<code class="highlighter-rouge">1px</code>；</p> <p>逻辑像素可以通过js代码获取，<code class="highlighter-rouge">screen.width</code>获取逻辑像素宽度，<code class="highlighter-rouge">screen.height</code>是高度；至于<code class="highlighter-rouge">dpr</code>，可以通过<code class="highlighter-rouge">devicePixelRatio</code>这个全局属性获取，现在的新一些的安卓智能手机一般这个比例是<strong>3</strong>，电脑的一般是<strong>1</strong>，iphone、iPad一般是<strong>2</strong>；</p> <p><strong>注意</strong>，dpr为<strong>1</strong>，说明一个css像素块由<code class="highlighter-rouge">1x1</code>个物理像素块来显示，也就是一个物理像素，如果为<strong>2</strong>，则是一个css像素由<code class="highlighter-rouge">2x2</code>个物理像素来显示，也就是<strong>4</strong>个像素块，以此类推；这里也就能明白了，dpr的存在就是为了是小尺寸设备屏幕显示出高画质图形，细节更高就更清晰了；</p> <p>现在来说设备像素的获取，并没有直接的获取方法，所以可以通过<strong>dpr乘以逻辑像素的方法获取</strong>；</p> <p>综合举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">logicWidth</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">logicHeight</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">dpr</span> <span class="o">=</span> <span class="nx">devicePixelRatio</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">deviceWidth</span> <span class="o">=</span> <span class="nx">logicWidth</span> <span class="o">*</span> <span class="nx">dpr</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">deviceHeight</span> <span class="o">=</span> <span class="nx">logicHeight</span> <span class="o">*</span> <span class="nx">dpr</span><span class="p">;</span> <span class="c1">// 输出逻辑像素</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">逻辑像素：</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">logicWidth</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">x</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">logicHeight</span><span class="p">);</span> <span class="c1">// 输出设备像素</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">物理像素：</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">deviceWidth</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">x</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">deviceHeight</span><span class="p">);</span> </code></pre></div></div> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/css-px 用CSS画一些多边形状 https://knightyun.github.io/2019/01/27/css-draw-polygon <p>CSS是个很强大的网页开发工具，使生硬的网页变得丰富绚丽，css能实现很多效果，比如css3中的过渡与动画效果都很好看，最基本的就是画一个具有长宽的矩形，通过设置 <code class="highlighter-rouge">border-radius</code> 又能实现画圆形和椭圆形，但是其他多边形似乎没有直接能用的属性，比如<strong>三角形</strong>，<strong>五角星</strong>，<strong>六边形</strong>等等；</p> <p>下面根据几何顺序依次来实现一下：</p> <h1 id="圆形">圆形</h1> <html> <div style="border:1px solid green; padding:10px;"> <div style="width:40px; height:40px; background:red; border-radius:20px;"></div> </div> <br /> </html> <blockquote> <h4 id="分析">分析:</h4> </blockquote> <p>在长宽相等的正方形中使用 <code class="highlighter-rouge">border-radius</code> 属性，其值等于长或宽的一半；</p> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">background</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-radius</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <h1 id="椭圆形">椭圆形</h1> <html> <div style="border:1px solid green; padding:10px;"> <div style="width:60px; height:40px; background:red; border-radius:50%"></div> </div> <br /> </html> <blockquote> <h4 id="分析-1">分析</h4> </blockquote> <p>同样是 <code class="highlighter-rouge">border-radius</code> 属性，只不过其值有变化，使用 <code class="highlighter-rouge">border-radius: 30px/20px</code>，意思是原矩形宽度方向半径设为 30px，高度方向半径设为 20px，或者简写为 <code class="highlighter-rouge">boder-radius: 50%</code>，一个意思，宽度和高度方向的半径各位宽度和高度的一半；</p> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">background</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-radius</span><span class="p">:</span> <span class="m">30px</span> <span class="p">/</span> <span class="m">20px</span><span class="p">;</span> <span class="c">/* 或者这样 border-radius: 50%; */</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <h1 id="三边形">三边形</h1> <html> <div style="border:1px solid green; padding:10px;"> <div style="width:30px; height:40px; border-left:20px solid transparent; border-right:20px solid transparent; border-bottom:40px solid red;"></div> </div> <br /> </html> <blockquote> <h4 id="分析-2">分析</h4> </blockquote> <p>没有直接能用的三角形的属性，可以利用CSS的<strong>盒子模型</strong>，就是下面这种，像 <code class="highlighter-rouge">&lt;p&gt;, &lt;h1&gt;, &lt;div&gt;</code> 这些标签都是一个“盒子”，标签内的文本是内容区，周围的彩色边界设置的是 <code class="highlighter-rouge">border</code> 值，当然还有边界与内容区中间的 <code class="highlighter-rouge">padding</code> 值，以及边界外的 <code class="highlighter-rouge">margin</code> 值；</p> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 60px; height: 40px; background: red; color: white; border-top:10px solid green; border-bottom: 10px solid blue; border-left: 15px solid yellow; border-right: 15px solid aqua">内容</div> </div> <br /> </html> <p>所以由图就能想到办法了，就是让某一条边界的宽度值直接等于盒子的宽度，并设置一个边界颜色，其他边界线设置不同的宽度值来调整三角形的斜度，并把边界线颜色设置为透明 <code class="highlighter-rouge">transparent</code> 即可；</p> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span><span class="m">30px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span><span class="m">40px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span><span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span><span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span><span class="m">40px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <h1 id="矩形">矩形</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 60px; height: 40px; background: red;"></div> </div> <br /> </html> <p>最简单的形状，就不分析了；</p> <h1 id="梯形">梯形</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 60px; height: 40px; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 40px solid red;"></div> </div> <br /> </html> <blockquote> <h4 id="分析-3">分析</h4> </blockquote> <p>方法有些像三角形，只不过底部边界线宽度等于矩形高度，左右两边的边界线宽度小于矩形宽度值即可（感觉这两句话绕就比划着再读几遍 -_-）;</p> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nt">div</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">40px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <h1 id="平行四边形">平行四边形</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="display: inline-block; width: 60px; height: 40px; border-left: 10px solid transparent; border-bottom: 40px solid red;"> </div><div style="display: inline-block; width: 10px; height: 40px; border-left: 10px solid red; border-bottom: 40px solid transparent;"></div> </div> <br /> </html> <blockquote> <h4 id="分析-4">分析</h4> </blockquote> <p>看成一个倾斜过的矩形，所以可以使用 <code class="highlighter-rouge">transform: skew()</code> 属性，括号内是倾斜角度，比如30度就是 <code class="highlighter-rouge">30deg</code>，还有 <code class="highlighter-rouge">transform</code> 是CSS3中的一个新属性，所以需要加浏览器前缀进行兼容，例如 ：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">-moz-transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">-ms-transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="nl">-o-transform</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="m">30deg</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>另外脑洞够大可以发挥一下想象，平行四边形可以看成一个直角梯形与一个直角三角形的组合，或者一个矩形与两个直角三角形的组合；</p> <p>直角梯形与直角三角形组合的代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nf">#div0</span> <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">40px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div1</span> <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span> <span class="nl">width</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">40px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div0"</span><span class="nt">&gt;&lt;/div&gt;</span><span class="c">&lt;!-- --&gt;</span><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <p><strong>注意：</strong> 两个 <code class="highlighter-rouge">&lt;div&gt;</code> 标签之间如果有<strong>换行</strong>或者空格的话，最终两个块图形间会出现一条<strong>细缝</strong>，所以写的时候就要避免换行，或者像上面一样把换行<strong>注释掉</strong>；</p> <h1 id="五边形">五边形</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 50px; height: 10px; border-left: 25px solid transparent; border-right: 25px solid transparent; border-bottom: 10px solid red;"> </div><div style="width: 50px; height: 40px; border-top: 40px solid red; border-left: 10px solid transparent; border-right: 10px solid transparent;"></div> </div> <br /> </html> <blockquote> <p>分析</p> </blockquote> <p>五边形可以看成上面的三角形与下面梯形的组合，当然数学好的可以计算一下尺寸就能画出一个正五边形了；</p> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nf">#div0</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">25px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">25px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div1</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">border-top</span><span class="p">:</span> <span class="m">40px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div0"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <p>更多边的形状基本思路都一样，想着用三角形，矩形，梯形这些基本形象进行组合基本上都能实现，下面的形状就只放形状和源码了；</p> <h1 id="五角星">五角星</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 40px; height: 60px; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 60px solid red;"> <div style="height: 20px;"></div> <div style="width: 60px; height: 18px; border-top: 25px solid red; border-left: 30px solid transparent; border-right: 30px solid transparent; margin-left: -30px;"></div> <div style="width: 40px; height: 15px; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 15px solid white; margin-left: -20px;"></div> </div> </div> <br /> </html> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nf">#div0</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">60px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div1</span> <span class="p">{</span> <span class="nl">height</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div2</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">18px</span><span class="p">;</span> <span class="nl">border-top</span><span class="p">:</span> <span class="m">25px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">30px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">30px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">margin-left</span><span class="p">:</span> <span class="m">-30px</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div3</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">40px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">20px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">solid</span> <span class="no">white</span><span class="p">;</span> <span class="nl">margin-left</span><span class="p">:</span> <span class="m">-20px</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div0"</span><span class="nt">&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div2"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div3"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <h1 id="六边形">六边形</h1> <html> <div style="border:1px solid green; padding:10px"> <div style="width: 60px; height: 30px; border-left: 15px solid transparent; border-right: 15px solid transparent; border-bottom: 30px solid red;"></div> <div style="width: 60px; height: 30px; border-top: 30px solid red; border-left: 15px solid transparent; border-right: 15px solid transparent;"></div> </div> <br /> </html> <p>代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span> <span class="nt">&lt;head&gt;</span> <span class="nt">&lt;title&gt;</span>CSS<span class="nt">&lt;/title&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nf">#div0</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">30px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div1</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">60px</span><span class="p">;</span> <span class="nl">height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span> <span class="nl">border-top</span><span class="p">:</span> <span class="m">30px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span> <span class="nl">border-left</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="nl">border-right</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> <span class="nt">&lt;body&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div0"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/body&gt;</span> <span class="nt">&lt;/html&gt;</span> </code></pre></div></div> <p>当然网页上画像上面这种基本图形，或者跟复杂的几何图形，曲线图形等，多半用到<strong>canvas</strong>或者<strong>SVG</strong>这两个工具，功能很强大，可以自行了解；</p> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/css-draw-polygon Base64码简介 https://knightyun.github.io/2019/01/27/base64 <h1 id="简介">简介</h1> <p>base64是一个保存二进制数据的工具，将多种形式的二进制数据或其构成的文件以ASCII的形式保存，因为很多地方不支持直接的二进制文件保存或呈现，比如可以将图片直接转换成base64码嵌入HTML文档中，而避免使用网络http加载图片；</p> <h1 id="组成">组成</h1> <p><code class="highlighter-rouge">A-Z a-z 0-9 + /</code> 共64个字符(不信自己数一下);</p> <h1 id="转换">转换</h1> <ol> <li> <p>如果是图片直接转换成二进制文件，字符先转换成ASCII字符码，再转换成二进制；网上直接搜“base64转换工具”就会出来很多在线转换网站，上传图片或者输入文本，一键转换；</p> </li> <li> <p>将上面的64个字符按上面顺序排列得到64个索引，索引从<strong>0</strong>开始，<strong>63</strong>结束；</p> </li> <li> <p>因为 64 = 2^6，所以要使二进制包含64种不同情况，需要取6比特位，即<code class="highlighter-rouge">000000</code>这种，把之前文件转换得到的二进制数据按每<strong>6比特位</strong>取一次，然后得到一个6位二进制数再转换成相应十进制数，这个数就是索引，然后按照索引取相应的64字符中的某一个，最后把所有取得的字符连接就是base64码；</p> </li> <li> <p>编码需要原文本总字节数(字符数)能<strong>被3整除</strong>(字节数除以3无余数)，因此取到最后的字符时如果凑不够，缺位全部用 <code class="highlighter-rouge">0</code> 补齐，最后的只要是<strong>全为0的6比特位</strong>，全部转换成字符 <strong><code class="highlighter-rouge">=</code></strong>，所以最多会出现<strong>2个 =</strong>；</p> </li> </ol> <h1 id="使用">使用</h1> <p>假设一个 .png 图片转换得到的base64码为 <code class="highlighter-rouge">abcdefg</code>，标准格式为：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data:image/png;base64,abcdefg </code></pre></div></div> <p>在浏览器地址栏输入以上字符串回车就能看见图片了，一般浏览器都支持解析base64码(里面的base64码换成自己的)；</p> <p>或者用在html的 <code class="highlighter-rouge">img</code> 标签中：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;img</span> <span class="na">alt=</span><span class="s">""</span> <span class="na">src=</span><span class="s">"data:image/png;base64,abcdefg"</span> <span class="nt">/&gt;</span> </code></pre></div></div> <p>再或者用在markdown格式文本中：</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">![</span><span class="nv">base64</span><span class="p">](</span><span class="sx">data:image/png;base53,abcdefg</span><span class="p">)</span> </code></pre></div></div> <p>可以把 <code class="highlighter-rouge">data:</code> 看成像 <code class="highlighter-rouge">http:</code> 一样的一种协议，下面是其他格式，根据格式应该就能猜到其用途：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data:,文本数据 data:text/plain,文本数据 data:text/html,HTML代码 data:text/html;base64,base64编码的HTML代码 data:text/css,CSS代码 data:text/css;base64,base64编码的CSS代码 data:text/javascript,Javascript代码 data:text/javascript;base64,base64编码的Javascript代码 data:image/gif;base64,base64编码的gif图片数据 data:image/png;base64,base64编码的png图片数据 data:image/jpeg;base64,base64编码的jpeg图片数据 data:image/x-icon;base64,base64编码的icon图片数据 </code></pre></div></div> <h1 id="效果">效果</h1> <p>例如下面的星星图标：</p> <p><img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAQAAAD8x0bcAAAA2UlEQVR4AZWSAQZCQRCGv05QgXpQqCggukAgQeSpEwREoO4Qqg5RoYA6T6GqIIACvKqMMdZK9C1r5t+dmbE7/E+SKj26nz3BV9IseTlrSQqPHGc9jIjUOlPAIeBiGdZszD4SYCycMjXqjjdHifM0cUuMGAfzn8QRQnGGdAgpAlAipMNQgtsIfYnZkcUly070PsJAU18pg1LmquoAoWUdjEAZm9byG28AFSpA028cZioFTHkQMSGjysx/zBsnK3Li/tkvpHDI2wVb7MnjEbD6+cFGQkalZ6PyD2/u1Ikpara+FgAAAABJRU5ErkJggg==" alt="base64_img" /></p> <p>其实它的base64码是这样的：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAQAAAD8x0bcAA AA2UlEQVR4AZWSAQZCQRCGv05QgXpQqCggukAgQeSpEwRE oO4Qqg5RoYA6T6GqIIACvKqMMdZK9C1r5t+dmbE7/E+SKj 26nz3BV9IseTlrSQqPHGc9jIjUOlPAIeBiGdZszD4SYCyc MjXqjjdHifM0cUuMGAfzn8QRQnGGdAgpAlAipMNQgtsIfY nZkcUly070PsJAU18pg1LmquoAoWUdjEAZm9byG28AFSpA 028cZioFTHkQMSGjysx/zBsnK3Li/tkvpHDI2wVb7MnjEb D6+cFGQkalZ6PyD2/u1Ikpara+FgAAAABJRU5ErkJggg== </code></pre></div></div> <p>为了显示方便所以进行了换行，理论上是很长的<strong>一行</strong>连续文本，中间不能有空格或者换行，这个图片仅有274字节(Byte)大，所以base64码还算短，几十上百K的图片就很长了，<strong>100K</strong>图片就有<strong>13万</strong>多个字符；</p> <p>如果是文本的话，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello World </code></pre></div></div> <p>以字符串 <code class="highlighter-rouge">Hello </code> 举例，后面类推，先将每个字符转换成ASCII码，再转换成二进制：</p> <style> table th, table td { border: 1px solid black; text-align: center; } </style> <table> <thead> <tr> <th style="text-align: center">字符</th> <th style="text-align: center">H</th> <th style="text-align: center">e</th> <th style="text-align: center">l</th> <th style="text-align: center">l</th> <th style="text-align: center">o</th> <th style="text-align: center">空格</th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><strong>ASCII</strong></td> <td style="text-align: center">72</td> <td style="text-align: center">101</td> <td style="text-align: center">108</td> <td style="text-align: center">108</td> <td style="text-align: center">111</td> <td style="text-align: center">32</td> </tr> <tr> <td style="text-align: center"><strong>二进制</strong></td> <td style="text-align: center">01001000</td> <td style="text-align: center">01100101</td> <td style="text-align: center">01101100</td> <td style="text-align: center">01101100</td> <td style="text-align: center">01101111</td> <td style="text-align: center">01000000</td> </tr> </tbody> </table> <p>以字符串 <code class="highlighter-rouge">Hel</code> 为例，将二进制转化成base64码：</p> <style> table th, table td { border: 1px solid; text-align: center; } </style> <table style="text-align: center"> <tr> <th>字符</th> <th colspan="8">H</th> <th colspan="8">e</th> <th colspan="8">l</th> </tr> <tr> <th>二进制</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>1</td><td>0</td><td>0</td><td>0</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>0</td><td>1</td><td>0</td><td>1</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>1</td><td>1</td><td>0</td><td>0</td> </tr> <tr> <th>Base64补0</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>1</td><td>0</td><td>0</td><td>0</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>0</td><td>1</td><td>0</td><td>1</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>1</td><td>1</td><td>0</td><td>0</td> </tr> <tr> <th>Base64结果</th> <td colspan="6">S</td> <td colspan="6">G</td> <td colspan="6">V</td> <td colspan="6">s</td> </tr> </table> <p>上面是不用补码的情况，即字符总数是3的倍数；下面是最后剩两个字符需要补码的情况：</p> <table style="text-align: center"> <tr> <th>字符</th> <th colspan="8">H</th> <th colspan="8">e</th> <th colspan="8"></th> </tr> <tr> <th>二进制</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>1</td><td>0</td><td>0</td><td>0</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>0</td><td>1</td><td>0</td><td>1</td> <td> </td><td> </td><td> </td><td> </td> <td> </td><td> </td><td> </td><td> </td> </tr> <tr> <th>Base64补0</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>1</td><td>0</td><td>0</td><td>0</td> <td>0</td><td>1</td><td>1</td><td>0</td> <td>0</td><td>1</td><td>0</td><td>1</td> <th>0</th><th>0</th><th>0</th><th>0</th> <th>0</th><th>0</th><th>0</th><th>0</th> </tr> <tr> <th>Base64结果</th> <td colspan="6">S</td> <td colspan="6">G</td> <td colspan="6">T</td> <th colspan="6">=</th> </tr> </table> <p>然后是最后只剩一个字符的例子：</p> <table style="text-align: center"> <tr> <th>字符</th> <th colspan="8">H</th> <th colspan="8"> </th> <th colspan="8"> </th> </tr> <tr> <th>二进制</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>1</td><td>0</td><td>0</td><td>0</td> <td> </td><td> </td><td> </td><td> </td> <td> </td><td> </td><td> </td><td> </td> <td> </td><td> </td><td> </td><td> </td> <td> </td><td> </td><td> </td><td> </td> </tr> <tr> <th>Base64补0</th> <td>0</td><td>1</td><td>0</td><td>0</td> <td>0</td><td>0</td><td>0</td><td>0</td> <th>0</th><th>0</th><th>0</th><th>0</th> <th>0</th><th>0</th><th>0</th><th>0</th> <th>0</th><th>0</th><th>0</th><th>0</th> <th>0</th><th>0</th><th>0</th><th>0</th> </tr> <tr> <th>Base64结果</th> <td colspan="6">S</td> <th colspan="6">A</th> <th colspan="6">=</th> <th colspan="6">=</th> </tr> </table> <p><strong>值得注意</strong>的是base64码 <code class="highlighter-rouge">A</code> 的二进制也是 <code class="highlighter-rouge">000000</code>，上面例子中 <code class="highlighter-rouge">A</code> 的二进制码是部分补全后全为0，只有6个0全是补全的时候才都转换为字符 <code class="highlighter-rouge">=</code>；</p> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/base64 UTF-8, ASCII, unicode的介绍与区分 https://knightyun.github.io/2019/01/27/ascii-unicode <h1 id="背景">背景</h1> <p>人类能通过肉眼识别文字和字符，并能通过知识了解他们的含义，但是计算机内部不论存储还是控制，都是通过二进制码实现，因为二进制的 <code class="highlighter-rouge">0</code>, <code class="highlighter-rouge">1</code> 刚好对应基础电路中的<strong>开</strong>和<strong>关</strong>，然后组合进行复杂的系统控制；</p> <p>将人类识别的字符转换成计算机识别的二进制数据的过程，叫做<strong>编码</strong>，顾名思义，编程二进制数字码，如 <code class="highlighter-rouge">0101101100011001</code>这样的；相反，就叫做<strong>解码</strong>，把二进制码解释为字符；</p> <h1 id="ascii">ASCII</h1> <p>首先ASCII全称(American Standard Code for Information Interchange，美国信息交换标准代码)，是一个<strong>字符集</strong>，顾名思义，很多字符的集合；</p> <p>像前面提到的，人类与计算机语言不通，一个识别字符，一个识别二进制，所以<strong>ASCII</strong>就充当了这样一个<strong>翻译官</strong>，其内容是编码与字符的映射，即一个字符只对应一个固定的编码，例如字符 <code class="highlighter-rouge">A</code> 的编码为 <code class="highlighter-rouge">65</code>，字符 <code class="highlighter-rouge">a</code> 的编码为 <code class="highlighter-rouge">122</code>；当然这个编码是<strong>十进制</strong>的，计算机内部把十进制转换成二进制就能供底层使用了；</p> <p>另外需要知道的是，一字节(1 Byte)等于八比特位(8 bit)，8 bit就是这样的：<code class="highlighter-rouge">01010101</code>，八位二进制的所有不同表示一共 <strong>2^8 = 256</strong> 个，而且一般都是从 <strong>0</strong> 开始数，所以表示的十进制数的范围就是 <strong>0 - 255</strong>，这也是ASCII编码映射字符数的范围，包含大小写字母和一些其他常用的符号；</p> <h1 id="unicode">Unicode</h1> <p>看完上面肯定就会疑惑ASCII总共才表示256个字符，怎么处理当今世界巨大的信息量的，由于这个字符集最初是老外发明的，表示所有字母和一些字符对他们当时来说可能很足够了，但是先进计算机遍布全球大部分地方，汉语、韩语、日语、阿拉伯语等语言数不过来，所以ASCII明显不够用了；虽然中国之前也制定了是和中文的编码字符集叫 <strong>GB2313</strong> 等系列；</p> <p>因此，便顺应时代需要产生了一种更庞大的字符集叫 <strong>Unicode</strong>，有时也叫<strong>万国码</strong>，顾名思义，几乎表示了世界上所有语言的字符，可以理解为 <code class="highlighter-rouge">Unique code</code>，独一无二的的编码；</p> <p>目前Unicode的编码范围达到了<strong>21位</strong>，即 <code class="highlighter-rouge">0x0000 - 0x10ffff</code> 的范围，二进制为 <code class="highlighter-rouge">1 0000 1111 1111 1111 1111</code>，刚好21位；十进制表示为 <code class="highlighter-rouge">1114111</code>，就是一百万多个字符，已经相当多了；</p> <p>如果要使用UNIcode，以在 <strong>HTML</strong> 中为例，假如知道一个字符的Unicode码是 <code class="highlighter-rouge">0x0394</code>,那么就在标签中添加代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ni">&amp;#x0394;</span> </code></pre></div></div> <p>放在标签中就是：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h5&gt;</span>这个Unicode码对应的字符是：<span class="ni">&amp;#x0394;</span><span class="nt">&lt;/h5&gt;</span> </code></pre></div></div> <p>结果是这样：</p> <blockquote> <h5>这个Unicode码对应的字符是：&#x0394;</h5> </blockquote> <p>其实那个Unicode编码就是对应的大小希腊字母德尔塔，数学或物理中经常用到的字符；</p> <p>也可以用 JavaScript 来遍历一部分Unicode与字符的对应关系：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mh">0x00ff</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">: &amp;#x</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">;&lt;br&gt;</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>页面就会出现前256个字符及其Unicode码；</p> <h1 id="utf-8-utf-16-utf-32">UTF-8, UTF-16, UTF-32</h1> <p>首先UTF全称(Unicode Transformation Format)，所以它是一种针对前面提到的Unicode的<strong>编码格式</strong>，常见的格式就是 <strong>UTF-8</strong>，还有 <code class="highlighter-rouge">UTF-16</code>, <code class="highlighter-rouge">UTF-32</code>；</p> <p>UTF-8 其中的 <code class="highlighter-rouge">8</code> 表示的是 <code class="highlighter-rouge">8 bit</code>，即Unicode中每8位表示一个字符，UTF-16 和 UTF-32 类似，因为Unicode最多才21位，32位大于21位，所以 UTF-32 的格式就可以表示所有字符对应的Unicode码了，但是呢，32位也就是<strong>4字节</strong>，让每个字符都占用4字节太费空间了，所以出现了<strong>UTF-8</strong>和<strong>UTF-16</strong>;</p> <p>UTF-8 定义 <code class="highlighter-rouge">0 - 7 bit</code> 的 Unicode 用一字节表示，这里就与<strong>ASCII</strong>一样了，<code class="highlighter-rouge">8 - 11 bit</code> 用两字节表示，<code class="highlighter-rouge">12 - 16 bit</code> 用三字节表示，<code class="highlighter-rouge">17 - 21 bit</code> 用四字节表示;</p> <p>UTF-8 编码规则如下：</p> <style> table th, table td { border: 2px solid black; } </style> <table> <thead> <tr> <th style="text-align: center">Unicode</th> <th style="text-align: center">bit</th> <th style="text-align: left">UTF-8</th> <th style="text-align: center">byte</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">0x0000 - 0x007f</td> <td style="text-align: center">0 - 7</td> <td style="text-align: left">0XXX XXXX</td> <td style="text-align: center">1</td> </tr> <tr> <td style="text-align: center">0x0080 - 0x07ff</td> <td style="text-align: center">8 - 11</td> <td style="text-align: left">110X XXXX 10XX XXXX</td> <td style="text-align: center">2</td> </tr> <tr> <td style="text-align: center">0x0800 - 0xffff</td> <td style="text-align: center">12 - 16</td> <td style="text-align: left">1110 XXXX 10XX XXXX 10XX XXXX</td> <td style="text-align: center">3</td> </tr> <tr> <td style="text-align: center">0x1 0000 - 0x1f ffff</td> <td style="text-align: center">17 - 21</td> <td style="text-align: left">1111 0XXX 10XX XXXX 10XX XXXX 10XX XXXX</td> <td style="text-align: center">4</td> </tr> </tbody> </table> <p>规律是：</p> <ul> <li>每个字节中不足8位的，高位(左边)先用0补上，比如 <code class="highlighter-rouge">0XXXX XXXX</code>；</li> <li>超过两字节表示的UTF-8，第一个字节高位添加两个 <code class="highlighter-rouge">1</code> 和一个 <code class="highlighter-rouge">0</code>，后面的字节高位添加 <code class="highlighter-rouge">10</code>；</li> <li>三、四字节同理，几个字节高位就添几个 <code class="highlighter-rouge">1</code> 再加上一个 <code class="highlighter-rouge">0</code>，其余字节高位添 <code class="highlighter-rouge">10</code>；</li> </ul> <p>可以看出 UTF-8 这种针对不同位数使用不同字节数编码的方式有效的利用了空间，避免了一些浪费，当然，事物都有利弊，空间降下去，时间也就升上去了；</p> Sun, 27 Jan 2019 00:00:00 +0000 https://knightyun.github.io/2019/01/27/ascii-unicode 电脑固态硬盘接口辨析 https://knightyun.github.io/2018/12/08/ssd <p>固态硬盘相比传统机械硬盘读写速度快许多，固态硬盘目前分为M.2接口与SATA接口。</p> <h1 id="sata接口">SATA接口</h1> <p>SATA（Serial ATA，Serial Advanced Technology Attachment，串行高级技术附件），一种硬盘接口规范。</p> <p>SATA3是目前大多数笔记本使用的接口规范版本，尺寸比msata大一些，有个硬壳盒包装；</p> <p>如下图，就是笔记本上取下的固态：</p> <p><img src="https://i.loli.net/2018/12/08/5c0b60b71fa9c.jpg" alt="sata_one" /> <img src="https://i.loli.net/2018/12/08/5c0b60ae9c878.jpg" alt="sata_two" /></p> <p>PCI-E(PCI Express)新一代总线接口，取代PCI总线接口，称为第三代I/O总线技术，提高了带宽，PCI Express的接口根据总线位宽不同而有所差异，包括x1、x4、x8以及x16(x2)模式将用于内部接口而非插槽模式。</p> <p><strong>PCI-E传输速度大于SATA。</strong></p> <h1 id="m2接口">M.2接口</h1> <p>M.2是intel推出替代mSATA(mini-SATA，小尺寸SATA规范接口，多应用于笔记本固态硬盘接口)的新接口规范，尺寸更小，传输性能更高，为满足超级本用户而推出；</p> <p>M.2接口有两种类型：Socket 2（ngff）和Socket 3（nvme），Socket2支持SATA、PCI-E X2接口，PCI-E ×2接口标准，最大的读取速度可以达到700MB/s，写入达到550MB/s。Socket 3可支持PCI-E ×4接口，理论带宽达4GB/s。</p> <p>NVME(Non-Volatile Memory express，非易失性内存主机控制器接口规范)，充分利用PCIE通道的低延时和并行性，降低AHCI的高延时和提高SATA的性能；</p> <ul> <li>NVME缺口靠右边，使用一缺固态;</li> </ul> <p><img src="https://i.loli.net/2018/12/08/5c0b60b31adf5.jpg" alt="m.2_1" /> <img src="https://i.loli.net/2018/12/08/5c0b60b4589e0.jpg" alt="m.2_0" /></p> <ul> <li>NGFF缺口靠左边，使用两缺m.2固态;</li> </ul> <p><img src="https://i.loli.net/2018/12/08/5c0bbc1207a8b.jpg" alt="c3fb1290842eb6f7.jpg" /></p> <p>购买更换时需要注意主板插槽上缺口靠哪边，一般安装是固态条元器件面朝上。</p> <p>并且，不要把它和内存条搞混，区别在于接口位置。</p> Sat, 08 Dec 2018 00:00:00 +0000 https://knightyun.github.io/2018/12/08/ssd 搭建个人论坛网站图文教程 https://knightyun.github.io/2018/11/25/discuz-website <h1 id="关于建站">关于建站</h1> <p>前面的文章介绍过如何使用Github Pages提供的仓库服务搭建Jekyll个人博客，链接在这 <a href="https://knightyun.github.io/2018/04/01/github-pages-blog">https://knightyun.github.io/2018/04/01/github-pages-blog</a>，现在来了解一下如何一步步搭建自己的论坛网站。</p> <p>搭建个人论坛网站，也相当于建站的一种，通常的套路便是<strong>域名+主机空间+网页源码程序</strong>，网页文件上传到虚拟空间，一般这些空间都安装有网站所需环境，如PHP和数据库等，然后把域名和主机空间绑定，这样就能在浏览器中输入域名（网址）访问所建网页，不然理论上只能通过虚拟主机的IP访问，但是通常有<strong>IP访问限制</strong>不允许你这么做。</p> <p>域名和主机空间可以在各大网站市场购买，通常是按年或按月付费，如阿里云和华为云。这里说一个需要<strong>注意</strong>的东西，产品列表中的<strong>虚拟空间、虚拟主机</strong>这类产品，指的是云服务器分配出的一部分磁盘空间，也叫网站空间，即只能通过服务商提供的控制面板进行访问控制，上传或者下载网页文件；而<strong>云服务器、云主机</strong>这类名称指的是有独立操作系统的服务器，可理解为一台可远程桌面控制访问的-云电脑。当然他们也能通过价格区分，一般情况，域名几十块每年，空间几百每年，主机几千每年，更高级的企业级服务就更贵了-_-。</p> <h1 id="关于论坛">关于论坛</h1> <p>能力强大的大佬可以自己编写网页和程序文件上传到主机空间，普通选手一般选择使用一些开源的网站源码，网上能找到很多，懂一些网页基础的也可以后期修改一些内部样式效果。</p> <p>这里我们使用<strong>Discuz</strong>提供的论坛建设服务，相当于让你下载一份网站源码压缩包，解压后上传到自己的网页空间，然后安装他们的程序。先看一下其<a href="http://www.comsenz.com/">官网</a>的简介：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa5a2311d32.png" alt="Image Title" /></p> <p>他们提供的服务还是不错的，这个源码也是免费下载的，当然也有其他付费服务可以自行了解，下面是他们提供服务的企业，看样子还是很厉害的：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa5b4142af4.png" alt="Image Title" /></p> <h1 id="开始安装">开始安装</h1> <p>首先到其官网<a href="http://www.comsenz.com/downloads/install/discuzx#down_open">下载页面</a>，然后选择下载的版本，我们这里选择简体UTF-8，点击下载等待完成：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa5f33e7571.png" alt="Image Title" /></p> <p>也可以到其<a href="http://www.discuz.net/forum.php">官方论坛</a>了解，版本更新就在这里发布，我们去其官方gitee，点击<a href="https://gitee.com/ComsenzDiscuz/DiscuzX">下载页面</a>下载：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa872216ff4.png" alt="Image Title" /></p> <p>如图所示下载zip压缩文件即可。由于作者使用最上面那个下载页面的压缩文件测试不成功，因此使用这个下载页面的压缩包。</p> <p>解压后进入<strong>upload</strong>文件夹，其他都是一些说明性文档，可以自行了解一下：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa609973982.png" alt="Image Title" /></p> <p>然后把upload目录下的所有文件复制到自己购买的空间的网页根目录下，一般是wwwroot这类名字，可以在里面新建一个文件夹例如<strong>discuz</strong>，然后拷贝到这个文件目录里面，这样就不妨碍以后用虚拟空间制作其他网页。</p> <p><img src="https://i.loli.net/2018/11/25/5bfa630914816.png" alt="Image Title" /></p> <p>其主要文件大概就这些，我这里用自己的虚拟机建设的网站做演示，大家就上传到自己虚拟空间目录下，然后在自己电脑浏览器输入绑定的域名进行访问，关于如何绑定域名，很简单并且网上教程很多，自行了解。我自己电脑作为服务器因此网址如图所示，如果域名为<code class="highlighter-rouge">test.com</code>，并且上面提到的所有文件保存在<code class="highlighter-rouge">discuz·里面，那么访问网址就输入</code>test.com/discuz/`，然后进入安装页面：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa838094975.png" alt="Image Title" /></p> <p>然后点同意，下一步，进入如下页面，选择<strong>全新安装</strong>：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa8b39abfe0.png" alt="Image Title" /></p> <p>设置数据库，数据库名，用户名，密码，一般买虚拟空间有送一个数据库，没有的话就单独买一个数据库服务器，把地址改一下就行了，邮箱填常用的，用于发送错误报告：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa8c222e37b.png" alt="Image Title" /></p> <p>等待页面安装完成，就能点击访问了：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa8e647689c.png" alt="Image Title" /></p> <p>那些推荐应用可以暂时不管，以后还能安装，直接点击右下方访问，看看效果：</p> <p><img src="https://i.loli.net/2018/11/25/5bfa9f083d437.png" alt="Image Title" /></p> <p>右上方是用户注册和登录的地方，管理员就用刚才安装页面设置那个账号和密码，就是<strong>admin</strong>那个。点击右上方<strong>模块管理，管理中心</strong>就可以进入后台管理一个内容和功能了，会再次验证密码，还是刚才那个。</p> <p><img src="https://i.loli.net/2018/11/25/5bfaa02b2a22d.png" alt="Image Title" /></p> <p>整个系统比较庞大，功能模块也相当多，有时间多多摸索一下就能熟练管理了。</p> Sun, 25 Nov 2018 00:00:00 +0000 https://knightyun.github.io/2018/11/25/discuz-website JavaScript逻辑运算符“&&”和“||”短路原则的应用 https://knightyun.github.io/2018/06/01/js-logic-compute <h1 id="逻辑运算符">逻辑运算符</h1> <p>在Javascript中，有逻辑运算符 <code class="highlighter-rouge">与 &amp;&amp;</code>, <code class="highlighter-rouge">或 ||</code>, <code class="highlighter-rouge">非 !</code>，常在条件句或循环中进行逻辑判断。</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">||</span> <span class="nx">a</span> <span class="o">!=</span> <span class="nx">c</span><span class="p">))</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>括号中表达式值为<strong>真</strong>，最后提示“true”。</p> <h1 id="短路原则">短路原则</h1> <p>在逻辑运算中，这是一个通用的原则，这是由于表达式从左到右执行的特性，为了减少运算量而给运算器规定的操作。主要针对 <code class="highlighter-rouge">&amp;&amp;</code> 和 <code class="highlighter-rouge">||</code> 两种运算。</p> <ul> <li> <p><code class="highlighter-rouge">&amp;&amp;</code> 的判断是<strong>同真为真，一假为假</strong>，则运算如果左边的表达式值为 <code class="highlighter-rouge">false</code>，那么就不会再执行右边的表达式了，如果左表达式为 <code class="highlighter-rouge">true</code>，就会继续执行右表达式；</p> </li> <li> <p><code class="highlighter-rouge">||</code> 的判断是<strong>一真为真，同假为假</strong>，则运算如果坐表达式值为 <code class="highlighter-rouge">true</code>，那么就不用执行右边的表达式了，如果左表达式为 <code class="highlighter-rouge">false</code>，就会继续执行右表达式；</p> </li> </ul> <p>举例说明：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">msg1</span><span class="dl">"</span><span class="p">);</span> <span class="p">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">msg2</span><span class="dl">"</span><span class="p">);</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">msg3</span><span class="dl">"</span><span class="p">);</span> <span class="p">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">msg4</span><span class="dl">"</span><span class="p">);</span> </code></pre></div></div> <p>结果是提示<strong>“msg1”</strong>和<strong>“msg4”</strong>。原理如上述。</p> <p>因此，如果有以下表达式：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>也许你会使用<strong>三目运算</strong>简化成这样：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">)</span> <span class="p">:</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">);</span> </code></pre></div></div> <p>其实也可以这样写：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">);</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">);</span> </code></pre></div></div> <h1 id="javascript中的应用">Javascript中的应用</h1> <p>在javascript中，只有<code class="highlighter-rouge">对象(Object)</code>和布尔值<code class="highlighter-rouge">true</code>为真，其它例如 <code class="highlighter-rouge">undefined</code>, <code class="highlighter-rouge">NaN</code>, <code class="highlighter-rouge">false</code> 等，值为 <code class="highlighter-rouge">false</code>。为被定义的对象或未赋值变量也是 <code class="highlighter-rouge">false</code>，因为其值都是 <code class="highlighter-rouge">undefined</code>，这里就可以应用于检查某变量是否<strong>已定义</strong>。</p> <p>举例说明：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">b</span><span class="p">;</span> <span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">defined</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//已定义a，提示“defined”</span> <span class="nx">o</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">defined</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//已定义对象o，提示“defined”</span> <span class="nb">Object</span> <span class="o">&amp;&amp;</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">defined</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//Object是一个已知的全局对象，提示“defined”</span> <span class="nx">b</span> <span class="o">||</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">not defined</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//b未赋值，提示“not defined”</span> <span class="nx">p</span> <span class="o">||</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">not defined</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//未定义p，提示“not defined”</span> </code></pre></div></div> <p>除了这个也能衍生出其它相同原理的应用，类似于判断赋值 <code class="highlighter-rouge">var a = (b &gt; 0) &amp;&amp; '9'</code> 或判断定义变量 <code class="highlighter-rouge">var abc = abc || ""</code> 等。</p> <p>js中使用这种方法可以减少代码量，提示性能，但同时也降低了代码<strong>可读性</strong>，比如个人觉得还是看以下代码比较舒适：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>方法的选择就要视情况而权衡了。</p> Fri, 01 Jun 2018 00:00:00 +0000 https://knightyun.github.io/2018/06/01/js-logic-compute jQuery初识之安装与语法简介 https://knightyun.github.io/2018/06/01/jq-syntax <h1 id="概念">概念</h1> <p>jQuery是一个JavaScript<strong>函数库</strong>，是一个比较流行的<strong>js框架</strong>，功能就是简化 js 代码的书写，因为一些功能用原生javascript书写代码量是很大的。可以理解为<strong>javascript query</strong>，毕竟Query也是它的一个功能。</p> <h1 id="安装">安装</h1> <p>要使用jQuery库，可以从网上下载得到jQuery的 <code class="highlighter-rouge">.js</code> 文件，也可以使用<strong>CDN (Content Delivery Content 内容分发网络)</strong>加载jQuery。</p> <h2 id="下载">下载</h2> <p>需要去jQuery官网：<a href="http://jquery.com/">jquery.com</a> 下载需要的jQuery库，一般有两个版本，<code class="highlighter-rouge">production</code> 表示已被压缩精简的版本，用于放到实际网站中，<code class="highlighter-rouge">development</code> 表示测试开发版，用于编写和开发，是<strong>可读</strong>的代码。</p> <p>例如目前最新的版本是 <code class="highlighter-rouge">jquery-3.3.1.js</code>，压缩版后缀是 <code class="highlighter-rouge">.min.js</code>，开发版文件有一万多行，就是正常格式的JavaScript源代码，包含一些注释，文件大小为 <code class="highlighter-rouge">266k</code>；压缩版就是去掉里面不必要的<strong>空格</strong>，<strong>回车</strong>与<strong>注释</strong>，所以最后文件实际内容只有<strong>一行！</strong>，文件大小为 <code class="highlighter-rouge">85k</code>，压缩了近<strong>三倍</strong>，这也是网页都使用压缩版，提升网页性能的原因。</p> <p>下载好后放到网页文件夹中，然后使用 <code class="highlighter-rouge">&lt;script&gt;</code> 标签引用，例如：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">scr=</span><span class="s">"/js/jquery-3.3.1.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span> </code></pre></div></div> <p>路径中填写 <code class="highlighter-rouge">.js</code> 文件的实际存放位置。</p> <h2 id="cdn">CDN</h2> <p>使用CDN（内容分发网络）就可以不用下载jQuery文件，优点是可以使用这个机制尽量避开网络中一些影响数据传输的路线，提高访问速度和稳定性。原理就是使用在各处配置的<strong>节点服务器</strong>，让用户就近获取所需内容。</p> <p>常见CDN有很多，例如百度、新浪、谷歌、微软等，如果是国内站点的话，建议使用国内CDN，国外站点可以使用谷歌或微软，提高速度。</p> <p>以百度CDN为例，安装方法如下：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span> </code></pre></div></div> <p>微软CDN：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://ajax.microsoft.com/ajax/jquery/jquery-1.3.2.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span> </code></pre></div></div> <p>微软jQuery历史版本可以从这里查看<a href="https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview#jQuery_Releases_on_the_CDN_0">https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview#jQuery_Releases_on_the_CDN_0</a>。</p> <p>更多内容可以访问<strong>百度静态资源公共库</strong><a href="http://cdn.code.baidu.com/">(http://cdn.code.baidu.com/)</a>，其他CDN可以自行百度搜索。</p> <h1 id="语法">语法</h1> <p>jQuery的基础语法是通过<strong>选取（query）</strong>文档中的元素，对其进行<strong>操作（action）</strong>，语法是：</p> <p><code class="highlighter-rouge">$(selector).action()</code></p> <h2 id="选择器">选择器</h2> <p><code class="highlighter-rouge">selector</code> 是选择器，类似于<strong>CSS选择器</strong>，常见的有：</p> <ul> <li>元素选择器，如： <code class="highlighter-rouge">$("p")</code></li> <li>ID选择器，如：<code class="highlighter-rouge">$("#myId")</code></li> <li>类选择器，如：<code class="highlighter-rouge">$(".myClass")</code></li> <li>属性选择器，如：<code class="highlighter-rouge">$("[href]")</code></li> </ul> <h2 id="操作">操作</h2> <p><code class="highlighter-rouge">action()</code> 是对所选元素执行的操作，例如：</p> <ul> <li>隐藏元素：<code class="highlighter-rouge">.hide()</code></li> <li>单击事件：<code class="highlighter-rouge">.click(myFunction())</code></li> <li>双击：<code class="highlighter-rouge">.dblclick()</code></li> <li>悬停：<code class="highlighter-rouge">.hover()</code></li> </ul> <p>其他语法与JavaScript类似，代码写在 <code class="highlighter-rouge">&lt;script&gt;</code> 中，例如隐藏 p 元素：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>有时需要等文档加载完毕后执行代码，很像JavaScript中的 <code class="highlighter-rouge">window.onload</code>：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">}</span> </code></pre></div></div> <p>jQuery中就要这么写：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span> <span class="p">});</span> </code></pre></div></div> <p>简化写法：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span> <span class="p">});</span> </code></pre></div></div> <p>结果都是在整个文档加载完后执行语句。</p> <h2 id="方法链接">方法链接</h2> <p>相对于JavaScript，jQuery又一种特殊的操作方法叫做<strong>方法链接（chaining）</strong>，即在一条语句上，对一个元素执行多个操作，语法是： <code class="highlighter-rouge">$(selector).action1().action2().action3()</code></p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;b&gt;Hello&lt;/b&gt;</span><span class="dl">"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello world</span><span class="dl">"</span><span class="p">);</span> <span class="p">});</span> </code></pre></div></div> <p>结果就是改变元素文本内容后绑定点击事件的调用函数，操作可以绑定多个，并且是<strong>依次执行</strong>，方法类似，其他操作以此类推。</p> Fri, 01 Jun 2018 00:00:00 +0000 https://knightyun.github.io/2018/06/01/jq-syntax addEventListener方法与on事件的区别 https://knightyun.github.io/2018/05/31/js-eventlistener <h1 id="on事件">on事件</h1> <p>Javascript中可以对一些页面的事件设定触发值，例如常用的点击 <code class="highlighter-rouge">onclick</code>，鼠标移动 <code class="highlighter-rouge">onmousemove</code>，或者移动端屏幕点击 <code class="highlighter-rouge">ontouchstart</code>，其它类似的还有 <code class="highlighter-rouge">onmousedown</code>, <code class="highlighter-rouge">onmouseup</code>, <code class="highlighter-rouge">onchange</code>, <code class="highlighter-rouge">onfocus</code>, <code class="highlighter-rouge">onmouseenter</code>, <code class="highlighter-rouge">ontouchmove</code>, <code class="highlighter-rouge">ontouchend</code> 等等，可以对其设定值来实现事件触发后执行的操作，例如：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1</span> <span class="na">onclick=</span><span class="s">"alert('hello');"</span><span class="nt">&gt;</span>Click me<span class="nt">&lt;/h1&gt;</span> </code></pre></div></div> <p>点击后就会弹出提示框，也可以这样写：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1</span> <span class="na">onclick=</span><span class="s">(function(){alert("hello");})()</span><span class="nt">&gt;</span>Click me<span class="nt">&lt;/h1&gt;</span> </code></pre></div></div> <p>这样也能实现同样效果，只是它的值变成了一个匿名函数。</p> <h1 id="addeventlistener方法">addEventListener()方法</h1> <p>这个方法设定一个事件监听器，当某一事件发生通过设定的参数执行操作。语法是：</p> <p><code class="highlighter-rouge">addEventListener(event, function, useCapture)</code></p> <ul> <li>参数 <code class="highlighter-rouge">event</code> 是必须的，表示监听的事件，例如 <code class="highlighter-rouge">click</code>, <code class="highlighter-rouge">touchstart</code> 等，就是之前<strong>不加前缀</strong> <code class="highlighter-rouge">on</code> 的事件。</li> <li>参数 <code class="highlighter-rouge">function</code> 也是必须的，表示事件触发后调用的函数，可以是外部定义函数，也可以是匿名函数。</li> <li>参数 <code class="highlighter-rouge">useCapture</code> 是选填的，填<code class="highlighter-rouge">true</code>或者<code class="highlighter-rouge">false</code>，用于描述事件是<strong>冒泡</strong>还是**捕获，<code class="highlighter-rouge">true</code>表示捕获，默认的<code class="highlighter-rouge">false</code>表示冒泡。</li> </ul> <h2 id="移除事件监听">移除事件监听</h2> <p>如果要移除 addEventListener() 添加的事件监听，就要使用<strong>removeEventListener()</strong>，语法是：</p> <p><code class="highlighter-rouge">removeEventListener(event, function)</code></p> <p>参数与addEventListener()一致。</p> <h2 id="兼容性">兼容性</h2> <p><strong>IE 8</strong>及更早的版本，和<strong>Opera 7.0</strong>及更早的版本，不支持 addEventListener() 和 removeEventListener() 方法，他们使用的是一下方法代替：</p> <p>添加事件： <code class="highlighter-rouge">attachEvent(event, function)</code></p> <p>移除事件： <code class="highlighter-rouge">detachEvent(event, function)</code></p> <p>可以用以下方法解决兼容性问题：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;</span>Click me<span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">div1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">div1</span><span class="dl">"</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nx">div1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">div1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your browser is compatible with addEventListener!</span><span class="dl">"</span><span class="p">;</span> <span class="p">});</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">div1</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span> <span class="nx">div1</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your browser is not compatible with addEventListener!</span><span class="dl">"</span> <span class="p">});</span> <span class="p">}</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <h2 id="冒泡与捕获">冒泡与捕获</h2> <p>这个参数设置的是元素事件的<strong>触发顺序</strong>，即页面中某元素设置了事件监听，其内部元素也设置有事件监听，<strong>冒泡</strong>是先触发最内部元素的事件，再依次触发外一层元素的事件，<strong>捕获</strong>刚好相反，由外到内依次触发。</p> <p>综合举例：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"parent1"</span><span class="nt">&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"child1"</span> <span class="na">style=</span><span class="s">"height:200px;background:#0cc"</span><span class="nt">&gt;</span> 冒泡 <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"parent2"</span><span class="nt">&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"child2"</span> <span class="na">style=</span><span class="s">"height:200px;background:#0cc"</span><span class="nt">&gt;</span> 捕获 <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">parent1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">parent1</span><span class="dl">"</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">child1</span><span class="dl">"</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">parent2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">parent2</span><span class="dl">"</span><span class="p">);</span> <span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">child2</span><span class="dl">"</span><span class="p">);</span> <span class="nx">parent1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">this is parent element</span><span class="dl">"</span><span class="p">);</span> <span class="p">});</span> <span class="nx">child1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">this is child element</span><span class="dl">"</span><span class="p">);</span> <span class="p">});</span> <span class="nx">parent2</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">this is parent element</span><span class="dl">"</span><span class="p">);</span> <span class="p">},</span> <span class="kc">true</span><span class="p">);</span> <span class="nx">child2</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">this is child element</span><span class="dl">"</span><span class="p">);</span> <span class="p">},</span> <span class="kc">true</span><span class="p">);</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>点击“冒泡”模块，先提示子元素后提示父元素；点击“捕获”模块，由于同时设置为 <code class="highlighter-rouge">true</code>，先提示父元素后提示子元素。</p> <h1 id="区别">区别</h1> <p>为某元素设定事件触发函数时，可能会觉得addEventListener和on事件的功能差不多，但是，addEventListener除了可以设置元素<strong>触发顺序</strong>外，还能<strong>多次绑定事件</strong>，因为 on 事件多次绑定的话会出现<strong>覆盖</strong>。</p> <p>举例说明：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span> <span class="na">style=</span><span class="s">"height:200px;background:#0cc"</span><span class="nt">&gt;</span> Click me <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">dib1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">div1</span><span class="dl">"</span><span class="p">);</span> <span class="nx">div1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">message1</span><span class="dl">"</span><span class="p">);</span> <span class="p">});</span> <span class="nx">div1</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">message2</span><span class="dl">"</span><span class="p">);</span> <span class="p">});</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>结果会依次提示“message1”，“message2“。</p> <p>但是js这么写的话：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">div1</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">message1</span><span class="dl">"</span><span class="p">);</span> <span class="p">};</span> <span class="nx">div1</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">message2</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>这里就只会提示最后一个“message2”，因为onclick作为对象div1的一个属性，第二次对其进行赋值就会<strong>覆盖</strong>之前的函数值，这样on事件在某些场合就不适用了。</p> Thu, 31 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/31/js-eventlistener JavaScript闭包详解 https://knightyun.github.io/2018/05/31/js-closure <h1 id="变量作用域">变量作用域</h1> <p>首先来了解一下Javascript中变量的作用域，除了常见的普通变量外，<strong>对象</strong>和<strong>函数</strong>也是一种变量。变量分为局部变量和全局变量。</p> <h2 id="局部变量">局部变量</h2> <p>局部变量就是指在<strong>函数内部</strong>定义的变量，作用域是函数内部网，此变量通常只能在函数内部访问，和外界是区分开的，所以变量名即使和外部的<strong>重复</strong>，也是两个独立的变量，不会相互影响。局部变量在函数执行是创建，执行完后<strong>销毁</strong>。</p> <h2 id="全局变量">全局变量</h2> <p>全局变量就是函数外部定义的变量，作用域是网页中的所有脚本和函数，它们都能够访问，全局变量是页面加载时创建，页面关闭后销毁。</p> <p>综合举例：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fun1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>这里的 <code class="highlighter-rouge">var a = 0;</code> 就是全局变量，<code class="highlighter-rouge">var a = 1;</code> 是局部变量，虽然名字重复，但这里是两个独立变量，但是还是不建议出现重复，提高代码可读性；<code class="highlighter-rouge">b = 2;</code> 也是<strong>全局变量</strong>，因为规定函数内部申明的变量，如果不加 <code class="highlighter-rouge">var</code>，即会被认为是全局变量，尤其这点需要小心。</p> <h1 id="闭包">闭包</h1> <p>先通俗的总结一下，闭包就是一个可以访问其他函数内部变量的<strong>函数</strong>，即一个定义在函数内部的函数，也叫<strong>内嵌函数</strong>。</p> <p>其次，是闭包的作用，因为通常情况函数内部变量是无法在外部访问的，即全局变量也局部变量的区别，而闭包，就实现了能在外部访问某函数内部变量的功能，让这些变量值始终保存在<strong>内存</strong>中。</p> <p>然后，来讲一下如何实现闭包。有以下代码：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fun1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//定义一个局部变量</span> <span class="kd">function</span> <span class="nx">fun2</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//这里的 fun2() 就是闭包</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">//fun2() 是 fun1()的子函数，所以能访问之前定义的局部变量，这个是关键</span> <span class="p">}</span> <span class="k">return</span> <span class="nx">fun2</span><span class="p">;</span> <span class="c1">//然后通过这里，把之前得到的局部变量成功返回到外部去</span> <span class="p">}</span> <span class="nx">fun1</span><span class="p">();</span> <span class="c1">//正常执行函数</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fun1</span><span class="p">();</span> <span class="c1">//将内部变量传递出去，传给变量 result</span> <span class="nx">result</span><span class="p">();</span> <span class="c1">//执行这个函数实现对局部变量的访问</span> </code></pre></div></div> <p>当然形式不止这一种，万变不离其宗，最后实现的功能是一样的，例如下面的方法也是可行的：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fun1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="p">};</span> <span class="p">}</span> <span class="nx">fun1</span><span class="p">();</span> <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fun1</span><span class="p">();</span> <span class="nx">result</span><span class="p">();</span> </code></pre></div></div> <h1 id="注意">注意</h1> <p>也许在很多文章中都能看到这句话“避免滥用闭包”，的确，由于闭包会使一些变量一直保存在内存中，所以如果大量使用的话就会消耗大量内存，影响网页性能。</p> <p>同时，由于闭包的特性，还会在外部改变函数的内部变量值，有时候这是很危险的，举个例子：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fun1</span><span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fun2</span><span class="p">()</span> <span class="p">{</span> <span class="nx">a</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="k">return</span> <span class="nx">fun2</span><span class="p">;</span> <span class="p">}</span> <span class="nx">fun1</span><span class="p">();</span> <span class="c1">//函数正常执行，输出 1</span> <span class="kd">var</span> <span class="nx">change</span> <span class="o">=</span> <span class="nx">fun1</span><span class="p">();</span> <span class="nx">change</span><span class="p">();</span> <span class="c1">//在外部执行这个函数后，函数内部变量 a 的值就被改变了，输出 2</span> </code></pre></div></div> Thu, 31 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/31/js-closure JavaScript计时器函数用法 https://knightyun.github.io/2018/05/24/js-timer-function <p>Javascript中和大多数语言一样，存在计时函数，使某语句或函数不用立即执行，可以延时设定的时间值之后再执行。</p> <h1 id="settimeout">setTimeout()</h1> <p>这个函数表示括号中的代码，延时指定时间后再执行，格式为 <code class="highlighter-rouge">setTimeout("function()", time)</code>，其中 <code class="highlighter-rouge">time</code> 的单位是<strong>毫秒</strong>。</p> <p>例如：</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fx</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">}</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="dl">"</span><span class="s2">fx()</span><span class="dl">"</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span> </code></pre></div></div> <p>也可以写成：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTimoeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> </code></pre></div></div> <p>结果就是页面加载完 2 秒后弹出提示框。</p> <h1 id="cleartimeout">clearTimeout()</h1> <p>clearTimeout() 方法用于结束 setTimeout() 方法的执行，括号中<strong>参数</strong>为 setTimeout() 返回的 <strong>ID 值</strong>。</p> <p>举例说明：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">int1</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">alert</span><span class="p">();},</span> <span class="mi">5000</span><span class="p">);</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">int1</span><span class="p">);</span> </code></pre></div></div> <p>这样就能<strong>终止</strong>代码执行，不会弹出提示框。</p> <h1 id="setinterval">setInterval()</h1> <p>这个函数表示<strong>每隔</strong>指定时间间隔执行一次括号中的代码，格式为：<code class="highlighter-rouge">setInterval("function()", time)</code>， <code class="highlighter-rouge">time</code> 单位依然为毫秒。</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fx</span><span class="p">()</span> <span class="p">{</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span> <span class="nx">setInterval</span><span class="p">(</span><span class="dl">"</span><span class="s2">fx()</span><span class="dl">"</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span> </code></pre></div></div> <p>这里就不要用 <code class="highlighter-rouge">alert()</code> 做实验了，后果你懂的 -_- .</p> <p>同样也能写成：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">);</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span> </code></pre></div></div> <p>效果就是不断输出字符“0”。</p> <h1 id="clearinterval">clearInterval()</h1> <p>用法与 clearTimeout() 一样，终止 setInterval() 的执行，括号中填 setInterval() 的返回值。</p> <p>例如：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">int2</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()[</span> <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">);</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span> <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">int2</span><span class="p">);</span> </code></pre></div></div> <p>这样就能终止输出。</p> <h2 id="注意">注意</h2> <p>有个小问题，用 setTimeout() 举例，假如代码像下面这样写：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fx</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">}</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">fx</span><span class="p">(),</span> <span class="mi">3000</span><span class="p">);</span> </code></pre></div></div> <p>相比上面，就是函数第一个参数少了双引号，猜一下后果会怎样……</p> <p>后果当然是页面加载后立刻弹出提示框，并不会延时 3 秒。下面的写法也是类似的效果：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTimeout</span><span class="p">((</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">})(),</span> <span class="mi">3000</span><span class="p">);</span> </code></pre></div></div> <p>原因都一样，无论是语句块 <code class="highlighter-rouge">fx()</code> 还是匿名函数 <code class="highlighter-rouge">(function(){})()</code>，都是会<strong>立刻执行</strong>的语句，而加双引号的 <code class="highlighter-rouge">"fx()"</code> 和 <code class="highlighter-rouge">function(){}</code> 就是当成一个<strong>参数</strong>传递给了函数 setTimeout()，然后这个<strong>参数</strong>语句直到 setTimeou() 真正执行时才生效，也就是延时3秒后执行。</p> <p>函数 setInterval() 的这个性质与 setTimeout() <strong>类似</strong>。</p> <h1 id="拓展">拓展</h1> <h2 id="回调函数参数">回调函数参数</h2> <p>setTimeout 常见的便是使用两个参数，回调函数和时间，但是它还可以接受更多的参数，作为回调函数调用时传入的参数（可以有多个，按顺序填入即可）；</p> <p>举个例子：</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">){</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">);</span> <span class="p">},</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// 3 秒后输出：</span> <span class="c1">// 3</span> </code></pre></div></div> <h2 id="返回值">返回值</h2> <p>setTimeout, setInterval 的返回值都是一个数字，具体值取决于当前环境的分配，每次调用后这个数字会加一，<code class="highlighter-rouge">clearTimeout()</code>, <code class="highlighter-rouge">clearInterval()</code> 方法传入的参数便是这个数字，只不过平时都是以变量代替；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){},</span> <span class="mi">1000</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){},</span> <span class="mi">1000</span><span class="p">);</span> <span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){},</span> <span class="mi">1000</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span> <span class="c1">// 1 （也可能是其他数字）</span> <span class="c1">// 2</span> <span class="c1">// 3</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 相当于 clearTiemout(1);</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="c1">// clearTimeout(2)</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span> <span class="c1">// clearTimeout(3)</span> </code></pre></div></div> <h2 id="时间精准度">时间精准度</h2> <p>setTimeout 会等到当前任务执行完，即使延迟时间已经到了，所以这也是常说 JavaScript 计时器不一定准确的原因所在，存在所用时间大于指定时间的情况；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">);</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="dl">'</span><span class="s1">console.log("time")</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span> <span class="c1">// 该函数执行 5s 左右</span> <span class="kd">function</span> <span class="nx">delay</span><span class="p">()</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="nx">delay</span><span class="p">();</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">end1</span><span class="dl">'</span><span class="p">);</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">end2</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// start</span> <span class="c1">// end1</span> <span class="c1">// end2</span> <span class="c1">// time</span> </code></pre></div></div> <h2 id="setinterval-的执行间隔">setInterval 的执行间隔</h2> <p>该函数的作用是每隔一定时间执行一遍代码，但是代码的执行时间，被<strong>包括</strong>在间隔时间内，如果执行时间超过了间隔时间，那么下一次执行会立即执行；</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">delay</span><span class="p">()</span> <span class="p">{</span> <span class="kd">let</span> <span class="nx">m</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span> <span class="k">while</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">t</span> <span class="o">&lt;=</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span> <span class="p">;</span> <span class="c1">// 使该函数 执行时间为 3s</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getSeconds</span><span class="p">());</span> <span class="p">}</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getSeconds</span><span class="p">());</span> <span class="nx">setInterval</span><span class="p">(</span><span class="nx">delay</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span> </code></pre></div></div> <p>最后的输出结果将是输出间隔变为 3s，而不是设定的 2s，因为 <code class="highlighter-rouge">delay()</code> 函数的执行时间超过了 <code class="highlighter-rouge">setInterval()</code> 的间隔时间，即间隔时间过了也要等到函数执行完毕，然后下一遍执行就紧接着来，不再有间隔时间，所以就使得最后的结果显示为每隔 3s 输出，其实就是整个 <code class="highlighter-rouge">delay</code> 函数的执行时间，间隔时间可以理解为被<strong>挤</strong>得没有了；</p> Thu, 24 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/24/js-timer-function JavaScript中语句与函数的执行辨析 https://knightyun.github.io/2018/05/23/js-anonymous-function <p>Javascript代码中，语句和函数以及匿名函数的执行存在一些区别，所以在编写过程中也存在一些“坑“。</p> <h1 id="script-中的语句">script 中的语句</h1> <p>html文档中的javascript语句是写在 <code class="highlighter-rouge">&lt;script&gt;&lt;/script&gt;</code> 中的，每条语句末尾需要添加分号 <code class="highlighter-rouge">;</code>，表示此条语句执行结束。例如下面的代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>文档加载到这块代码区域时，就会立刻<strong>执行</strong>这两条语句，即弹出提示框为x的值，但是如果把语句换成函数定义，代码如下：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="kd">function</span> <span class="nx">fx</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">}</span> <span class="nx">fx</span><span class="p">();</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>这时第一行语句会被<strong>执行</strong>，第二至五行是<strong>函数定义</strong>，并不会执行这个函数，直到最后一行语句才会真正<strong>执行</strong>这个定义过的函数。</p> <p>如果需要立刻执行函数的话，就需要使用<strong>匿名函数</strong>了。所谓匿名函数，顾名思义，即不会给这个执行的函数定义“函数名”，而且是一个立即执行的语句。格式如下：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">})();</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p><strong>注意</strong>代码中的三个<strong>括号</strong>的位置，以及最后跟的那个<strong>分号</strong>，表示这是一个立即执行的语句。</p> <p>当然匿名函数也能<strong>传递参数</strong>，例如：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span><span class="p">){</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">})(</span><span class="mi">9</span><span class="p">);</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>效果和上面一样。</p> <p>但有时又需要不立即执行的函数，例如：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>效果与下面代码一样：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="dl">"</span><span class="s2">alert(x)</span><span class="dl">"</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span> <span class="nt">&lt;/script&gt;</span> </code></pre></div></div> <p>这是Javascript中的延时函数，表示2秒后弹出提示。<code class="highlighter-rouge">setTimeout()</code> 自身就是一个<strong>函数</strong>，里面的 <code class="highlighter-rouge">“alert(x)”</code> 是这个函数的一个<strong>参数</strong>，即一个<strong>加引号的语句</strong>。便于理解，可以写成这样：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setTimeout("alert();", 2000); </code></pre></div></div> <p>这样写并不会出错。</p> <p>所以这个函数 <code class="highlighter-rouge">setTimeout()</code> 的参数是一个<strong>不用立即执行</strong>的匿名函数 <code class="highlighter-rouge">function(){}</code>，也可以是一个语句块，从而进行<strong>参数传递</strong>。</p> <p>通俗讲，这里加引号的语句块相当于不加引号的匿名函数。</p> <h1 id="标签属性中的语句">标签属性中的语句</h1> <p>在 html 标签中也能使用语句，通常用于设置元素的属性。</p> <p>先对比区分以下代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span> <span class="kd">function</span> <span class="nx">fx</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">();</span> <span class="p">}</span> <span class="nt">&lt;/script&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">"alert()"</span><span class="nt">&gt;</span>Button1<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">"fx()"</span><span class="nt">&gt;</span>Button2<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">fx()</span><span class="nt">&gt;</span>Button3<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">(function(){alert();})()</span><span class="nt">&gt;</span>Button4<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">"(function(){alert();})()"</span><span class="nt">&gt;</span>Button5<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">function(){alert();}</span><span class="nt">&gt;</span>Button6<span class="nt">&lt;/button&gt;</span> <span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">"function(){alert();}"</span><span class="nt">&gt;</span>Button7<span class="nt">&lt;/button&gt;</span> </code></pre></div></div> <p>猜一下哪个按钮点击无效……</p> <p>答案是最后的<strong>“Button6”</strong>和<strong>“Button7”</strong>，然后就能发现规律了，<strong>属性</strong>所设置的<strong>值</strong>必须是能<strong>立即执行</strong>的<u>语句块</u>、<u>函数</u>或<u>匿名函数</u>，最后那两种情况是行不通的。</p> Wed, 23 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/23/js-anonymous-function web浏览器进化简史 https://knightyun.github.io/2018/05/22/web-browser-history <h2 id="发展史与时间线">发展史与时间线</h2> <ul> <li> <p>1989年，科学家<strong><em>Tim-Berners-Lee</em></strong>发明了<strong>World Wide Web</strong>（万维网）。 <img src="https://i.loli.net/2018/05/22/5b04323d35dcc.png" alt="www.png" /></p> </li> <li> <p>1990年，他开发了世界上第一款网页浏览器，为避免与万维网混淆，改名为<strong>NEXUS</strong>，但不支持图片。 <img src="https://i.loli.net/2018/05/22/5b04323d6cf2f.png" alt="nexus.png" /></p> </li> <li> <p>1993年，伊利诺大学的NCSA组织创造了第一款可显示图片的浏览器，<strong>Mosaic</strong>（马赛克） <img src="https://i.loli.net/2018/05/22/5b04323d04dfc.gif" alt="mosaic.gif" /></p> </li> <li> <p>1994年10月在麻省理工学院计算机科学实验室成立<strong>万维网联盟</strong>。建立者正是万维网的发明者<strong>蒂姆·伯纳斯·李</strong>。万维网联盟(<strong>World Wide Web Consortium</strong>，简称<strong>W3C</strong>)。 <img src="https://i.loli.net/2018/05/22/5b04323c3986d.jpg" alt="w3c.jpg" /></p> </li> <li> <p>1994年，<strong>Mozilla</strong>出现了。不过，鉴于当时 Mosaic 的权势。为了避嫌，最终改名成了<strong>Netscape Navigator</strong>（网景公司开发的网络浏览器）。凭借着html框架显示等新特性，很快成为了<strong>新的霸主</strong>。 <img src="https://i.loli.net/2018/05/22/5b04323c69a6d.jpg" alt="nn.jpg" /></p> </li> <li> <p>1995年微软发布了跟系统“捆绑”的浏览器<strong>Internet Explorer（IE）</strong>，凭借着操作系统的占有率，<strong>IE</strong>就把<strong>Netscape</strong>挤下了霸主宝座。 <img src="https://i.loli.net/2018/05/22/5b04323cc82c2.jpg" alt="ie.jpg" /></p> </li> <li> <p>和 <strong>IE</strong> 差不多时间诞生，还有一直不温不火的 <strong>Opera</strong>。 <img src="https://i.loli.net/2018/05/22/5b04326e039df.jpg" alt="opera.jpg" /></p> </li> <li> <p><strong>NetScape</strong>并未放弃，围绕着浏览器引擎衍生出了人们熟知 <strong>Firefox</strong>。 <img src="https://i.loli.net/2018/05/22/5b04326e06bfd.jpg" alt="firefox.jpg" /></p> </li> <li> <p>2003年，苹果推出的 <strong>Safari</strong>。 <img src="https://i.loli.net/2018/05/22/5b04326e023b8.jpg" alt="safari.jpg" /></p> </li> <li> <p>2008年 <strong>Google</strong> 携 <strong>Chrome</strong> 参战，让 <strong>IE</strong> 逐渐失利。 <img src="https://i.loli.net/2018/05/22/5b04326e31caf.jpg" alt="chrome.jpg" /></p> </li> <li> <p>2015年，微软为了改变局面，推出了 <strong>Edge</strong>。 <img src="https://i.loli.net/2018/05/22/5b04326e00c7f.jpg" alt="edge.jpg" /></p> </li> <li> <p>但 <strong>Chrome</strong> 以及类似内核的浏览器依旧是主流。 <img src="https://i.loli.net/2018/05/22/5b04326e052f1.jpg" alt="chrome-inner.jpg" /></p> </li> </ul> Tue, 22 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/22/web-browser-history CSS样式之内容居中方法 https://knightyun.github.io/2018/05/22/css-content-center <h1 id="水平居中">水平居中</h1> <p>HTML中要实现某一内容水平居中显示，要通过设置css样式来实现，主要分为<strong>行内元素</strong>和<strong>块状元素</strong>两种情况，<strong>块状元素</strong>又可分为<strong>块状定宽</strong>与<strong>块状不定宽</strong>两种情况，接下来依次介绍分析。</p> <h2 id="行内元素">行内元素</h2> <p>像 a、span、i 这类元素叫做行内元素，<strong>文本</strong>和<strong>图片</strong>也是行内元素。行内元素水平居中方法简单，只需要给行内元素的<strong>父元素</strong>设置 <code class="highlighter-rouge">text-align: center;</code> css样式就内实现内容水平居中，例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class = </span><span class="s">"txt"</span><span class="nt">&gt;</span>居中内容<span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>文本内容的<strong>父元素</strong>就是 <code class="highlighter-rouge">div</code> ，这样就内实现水平居中，效果如下：</p> <div align="center"><b>居中内容</b></div> <h2 id="块状定宽元素">块状定宽元素</h2> <p>常见块状元素有 div, p, h 等，定宽即为其设置固定宽度值 <code class="highlighter-rouge">width</code>，这时我们可以为元素设置 <code class="highlighter-rouge">margin-left</code> 和 <code class="highlighter-rouge">margin-right</code> 来实现水平居中，也可以简写为 <code class="highlighter-rouge">margin: 0 auto;</code>，例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class = </span><span class="s">"txt"</span><span class="nt">&gt;</span>居中内容<span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span> <span class="nl">margin</span><span class="p">:</span> <span class="m">10px</span> <span class="nb">auto</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>实现效果如下：</p> <div align="center"><b>居中内容</b></div> <h2 id="块状不定宽">块状不定宽</h2> <p>有时候我们不能限制块状元素的宽度，就是块状不定宽元素，主要有三种方法，接下来一次介绍。</p> <h5 id="1加入-table-标签">1、加入 table 标签</h5> <p>利用 table 标签的<strong>长度自适应性</strong>，长度根据内容自动调整，然后通过设置 <code class="highlighter-rouge">margin: auto;</code> 实现水平居中，例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;</span> <span class="nt">&lt;tbody&gt;</span> <span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;td&gt;</span> <span class="nt">&lt;div</span> <span class="na">class = </span><span class="s">"txt"</span><span class="nt">&gt;</span>居中内容<span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span> <span class="nt">&lt;/tbody&gt;</span> <span class="nt">&lt;/table&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">margin</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>效果如下：</p> <div align="center"><b>居中内容</b></div> <h5 id="2设置为行内元素">2、设置为行内元素</h5> <p>就是通过设置 <code class="highlighter-rouge">display: inline;</code> 将块状元素设置为<strong>行内元素</strong>，然后就是像行内元素一样设置 <code class="highlighter-rouge">text-align: center;</code> 来是内容水平居中，例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class = </span><span class="s">"txt"</span><span class="nt">&gt;</span>居中内容<span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">display</span><span class="p">:</span> <span class="nb">inline</span><span class="p">;</span> <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>效果为：</p> <div align="center"><b>居中内容</b></div> <p><strong>注：</strong></p> <blockquote> <p><strong>使用这种方法虽然可以不用像table增加无语义标签，但是改变了display，所以会少了一些功能，例如不能设置宽度。</strong></p> </blockquote> <h5 id="3设置浮动和相对定位">3、设置浮动和相对定位</h5> <p>这种方法设置就相对复杂，同时设置<strong>浮动</strong>和<strong>相对定位</strong>来实现元素的水平居中。 首先设置<strong>父元素</strong>：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">float</span><span class="o">:</span> <span class="nt">left</span><span class="o">;</span> <span class="nt">position</span><span class="o">:</span> <span class="nt">relative</span><span class="o">;</span> <span class="nt">left</span><span class="o">:</span> <span class="nt">50</span><span class="o">%;</span> </code></pre></div></div> <p>然后设置<strong>子元素</strong>：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">position</span><span class="o">:</span> <span class="nt">relative</span><span class="o">;</span> <span class="nt">left</span><span class="o">:</span> <span class="nt">-50</span><span class="o">%;</span> </code></pre></div></div> <p>通过代码应该好理解，就是通过<strong>50%</strong>那个关键位置来实现水平居中效果，因为<strong>50%</strong>是界面的中央位置，将父元素右移，直到左边框移到中线位置，在将子元素向左移，这样子元素不就居中了吗。</p> <p>这里要<strong>注意</strong>的是分别设置<strong>父元素</strong>的 <code class="highlighter-rouge">50%</code> 和<strong>子元素</strong>的 <code class="highlighter-rouge">-50%</code>。 实现效果如下：</p> <div align="center"><b>居中内容</b></div> <h1 id="垂直居中">垂直居中</h1> <p>说完水平居中接着说垂直居中，这里主要又分为两种情况：<strong>父元素高度确定的单行文本</strong> 和<strong>父元素高度确定的多行文本</strong>。</p> <h2 id="单行文本">单行文本</h2> <p>对于<strong>父元素</strong>高度确定的单行文本，可以通过设置<strong>父元素</strong>的 <code class="highlighter-rouge">height</code> 和 <code class="highlighter-rouge">line-height</code> 高度一致来实现。</p> <p>这里可以这样理解，<code class="highlighter-rouge">height</code> 是元素的高度，例如文本字体的高度，<code class="highlighter-rouge">line-height</code> 是行高，例如文本的行间距，一行文本中，行间距被<strong>分为两部分</strong>，分别位于这行文本的<strong>顶部</strong>和<strong>底部</strong>（因为行间距是两行之间的距离），所以设置 <code class="highlighter-rouge">height</code> 和 <code class="highlighter-rouge">line-height</code> <strong>一样大</strong>的话，<code class="highlighter-rouge">line-height</code> 就被均分为两部分，分别位于元素顶部和底部，这样中间设置为 <code class="highlighter-rouge">height</code> 的元素不就实现<strong>垂直居中</strong>了吗 ^_^ .</p> <p>例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class = </span><span class="s">"txt"</span><span class="nt">&gt;</span>居中内容<span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">height</span><span class="p">:</span> <span class="m">200px</span><span class="p">;</span> <span class="nl">line-height</span><span class="p">:</span> <span class="m">200px</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>效果如下：</p> <pre> 居中内容 </pre> <blockquote> <p><strong>这里需要注意的是关键词“单行文本”，如果使用这种方法但是一行文本超过宽度限制的话，某些内容就会脱离元素块，子元素有多行的话，这几行就会并排居中，并保持设置的行高。</strong></p> </blockquote> <h2 id="多行文本">多行文本</h2> <p>对于父元素高度确定的<strong>文本</strong>和<strong>图片</strong>等内容设置垂直居中，主要有两种方法。</p> <h5 id="1使用-table-标签">1、使用 table 标签</h5> <p>对元素使用<strong>table</strong>标签，包括 tbody，tr，td，然后对父元素设置 <code class="highlighter-rouge">vertical-align: middle;</code> 样式，就能使 <code class="highlighter-rouge">inline-block</code> 类型的子元素垂直居中显示。</p> <p>因为 td 标签<strong>默认</strong>设置了 <code class="highlighter-rouge">vertical-align: middle</code>，所以也可以不用单独设置 <code class="highlighter-rouge">vertical-align</code>。 例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;</span> <span class="nt">&lt;tbody&gt;</span> <span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"txt"</span><span class="nt">&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span> <span class="nt">&lt;/tbody&gt;</span> <span class="nt">&lt;/table&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">height</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ccc</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <blockquote> <p><strong>这里的父元素就是 td，父元素的高度必须确定，就要为其设置 height。</strong></p> </blockquote> <p><strong>注意</strong>这里的 p 元素是 <strong>inline</strong> 类型的，所以设置 <code class="highlighter-rouge">vertical-align: middle</code> 的话会出现错误，若果是图片元素 img 的话，就可以设置 <code class="highlighter-rouge">vertical-align: middle</code>，但是由于 td 标签默认，所以都可以不写。</p> <p>效果如下：</p> <pre> 居中内容 </pre> <h5 id="2设置-table-cell">2、设置 table-cell</h5> <p>第二种方法是把要垂直居中显示的元素的父元素设置为<strong>table-cell (表格单元)</strong>类型：<code class="highlighter-rouge">display: table-cell;</code>，然后设置 <code class="highlighter-rouge">vertical-align: middle</code>就能实现元素垂直居中。</p> <p>但是这个方法存在兼容性问题，<strong>chrome, firefox, IE8以上</strong>才支持这个操作。</p> <p>例如： html:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"txt"</span><span class="nt">&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;p&gt;</span>居中内容<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>css:</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.txt</span> <span class="p">{</span> <span class="nl">height</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ccc</span><span class="p">;</span> <span class="nl">display</span><span class="p">:</span> <span class="nb">table-cell</span><span class="p">;</span> <span class="nl">vertical-align</span><span class="p">:</span> <span class="nb">middle</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <blockquote> <p><strong>同样，要为父元素 div 设置高度 height</strong></p> </blockquote> <p>效果如下：</p> <pre> 居中内容 </pre> <p>这种方法除了兼容性问题外，同时也改变了 <strong>display</strong>类型，会在某些方面带来不便。</p> Tue, 22 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/22/css-content-center css布局模型详细介绍 https://knightyun.github.io/2018/05/04/css-layout-model <p>HTML中元素有三种布局模型：流动模型、浮动模型、层模型。</p> <h1 id="流动模型flow">流动模型（flow）</h1> <p>HTML网页默认布局就是流动模型，布局如下：</p> <p><strong>块级元素(block)</strong>自上而下垂直分布，因为块级元素默认宽度为浏览器窗口的<strong>100%</strong>，或者理解为每个块级元素默认<strong>占一行</strong>。常见块级元素有 <code class="highlighter-rouge">div</code>, <code class="highlighter-rouge">p</code>, <code class="highlighter-rouge">h</code> 等；</p> <p><strong>内联元素(inline)</strong>从左到右水平分布，即不像块级元素那样每个独占一行。常见内联元素有 <code class="highlighter-rouge">a</code>, <code class="highlighter-rouge">span</code>, <code class="highlighter-rouge">em</code> 等。</p> <h1 id="浮动模型float">浮动模型（float）</h1> <p>上面提到的块级元素是每个独占一行显示，但是定义css浮动模型后就能使两个块级元素<strong>并排一行</strong>显示。 例如HTML代码：</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id = </span><span class="s">"div1"</span><span class="nt">&gt;</span> <span class="nt">&lt;p&gt;</span>Hello<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">id = </span><span class="s">"div2"</span><span class="nt">&gt;</span> <span class="nt">&lt;p&gt;</span>World !<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;/div&gt;</span> </code></pre></div></div> <p>显示结果是这样：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello World ! </code></pre></div></div> <p>但是设置浮动css后：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>效果就是这样：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HelloWorld ! </code></pre></div></div> <p>也可以设置元素一左一右显示：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">#div1</span> <span class="p">{</span> <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span> <span class="p">}</span> <span class="nf">#div2</span> <span class="p">{</span> <span class="nl">float</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <h1 id="层模型layerposition">层模型（layer）（position）</h1> <p>类似于PS中的<strong>图层</strong>编辑，HTML中也存在层模型布局，对元素进行<strong>定位</strong>。 层模型有三种：<strong>绝对定位</strong>(absolute)、<strong>相对定位</strong>(relative)、<strong>固定定位</strong>(fixed)。</p> <h2 id="绝对定位">绝对定位</h2> <p>理解就是字面上的意思，简言之就是<strong>相对于上级设置了 position 属性的元素</strong>进行定位，如果没有这类上级就是相对于 <code class="highlighter-rouge">body</code> 标签，也是<strong>浏览器窗口</strong>。需要设置css：<code class="highlighter-rouge">position: absolute;</code>，然后就可以使用 <code class="highlighter-rouge">top</code>, <code class="highlighter-rouge">right</code>, <code class="highlighter-rouge">bottom</code>, <code class="highlighter-rouge">left</code> 这类属性进行定位。例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span> <span class="nl">top</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span> <span class="nl">left</span><span class="p">:</span> <span class="m">150px</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>这样就使板块<strong>向下</strong>移动100像素，<strong>向右</strong>移动150像素。</p> <h2 id="相对定位">相对定位</h2> <p>这里的<strong>相对</strong>较难理解，与数理中的“相对”不太一样，这里是<strong>“相对于自己原来应在的位置”</strong>，需要设置css：<code class="highlighter-rouge">position: relative;</code>，重要的是不用关心<strong>上级是否设置了position属性</strong>，这样就很方便。例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">div</span> <span class="p">{</span> <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span> <span class="nl">top</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span> <span class="nl">right</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>板块就相对于自己没设置样式前的位置，同时向左向下移动100px。</p> <h2 id="固定定位">固定定位</h2> <p>这个就好理解了，所谓<strong>固定</strong>就是指固定于整个浏览器网页窗口不动，即使滚动网页内容也不改变位置，需要设置css：<code class="highlighter-rouge">position: fixed</code>，也可以设置 <code class="highlighter-rouge">top</code>, <code class="highlighter-rouge">right</code>等调整固定的位置。还记得浏览器某些网页右下角的小广告吗，是不是固定在那怎么浏览网页都不动 -_- .</p> Fri, 04 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/04/css-layout-model CSS选择器详细介绍 https://knightyun.github.io/2018/05/02/css-selector <hr /> <p>文章出自个人博客<a href="https://knightyun.github.io/2018/05/02/css-selector">https://knightyun.github.io/2018/05/02/css-selector</a>，转载请申明</p> <hr /> <h1 id="目录-">目录 <span id="home"></span></h1> <ul> <li><a href="#1">基础</a></li> <li><a href="#2">选择器</a> <ul> <li><a href="#2.1">元素选择器</a></li> <li><a href="#2.2">类选择器</a></li> <li><a href="#2.3">ID选择器</a> <ul> <li><a href="#2.3.1">ID选择器与类选择器的区别</a></li> </ul> </li> <li><a href="#2.4">子选择器</a></li> <li><a href="#2.5">后代选择器</a></li> <li><a href="#2.6">通用选择器</a></li> <li><a href="#2.7">属性选择器</a> <ul> <li><a href="#2.7.1">简单属性选择器</a></li> <li><a href="#2.7.2">属性和值选择器</a></li> </ul> </li> <li><a href="#2.8">伪元素选择器</a> <ul> <li><a href="#2.8.1">:active</a></li> <li><a href="#2.8.2">:hover</a></li> <li><a href="#2.8.3">:focus</a></li> <li><a href="#2.8.4">::selection</a></li> <li><a href="#2.8.5">:first-child</a></li> <li><a href="#2.8.6">:nth-child()</a></li> </ul> </li> <li><a href="#2.9">组选择器</a></li> <li><a href="#2.10">相邻同级选择器</a></li> </ul> </li> </ul> <hr /> <h1 id="基础-">基础 <span id="1"></span></h1> <p>CSS（层叠样式表Cascading Style Sheets）,用于修饰HTML网页内容，根据使用位置不同可分为三种样式：<strong>内联式，嵌入式，外部式。</strong></p> <ul> <li><strong>内联式：</strong>标签 <code class="highlighter-rouge">&lt;&gt;</code>内部使用，例如：</li> </ul> <blockquote> <p><code class="highlighter-rouge">&lt;p style = "color: red; font-size: 20px"&gt;&lt;/p&gt;</code>。</p> </blockquote> <ul> <li><strong>嵌入式：</strong>写在 <code class="highlighter-rouge">&lt;style&gt;&lt;/style&gt;</code> 之中，并放在 <code class="highlighter-rouge">&lt;head&gt;&lt;/head&gt;</code> 内，例如：</li> </ul> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span> <span class="c">&lt;!--这里放其它标签，例如 meta，link，script之类--&gt;</span> <span class="nt">&lt;style&gt;</span> <span class="nt">p</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="nl">font-size</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span> <span class="p">}</span> <span class="nt">&lt;/style&gt;</span> <span class="nt">&lt;/head&gt;</span> </code></pre></div></div> <ul> <li><strong>外部式：</strong>写在外部 <code class="highlighter-rouge">.css</code> 文件中，使用如下方式引用：</li> </ul> <blockquote> <p><code class="highlighter-rouge">&lt;link rel = "stylesheet" type="text/css" href="css/index.css"&gt;</code> <code class="highlighter-rouge">href</code> 写 <code class="highlighter-rouge">.css</code> 文件路径，可以是绝对路径或相对路径，相对路径类似于：<code class="highlighter-rouge">../../css/index.css</code>，绝对路径类似于：<code class="highlighter-rouge">/css/index.css</code>。</p> </blockquote> <h1 id="选择器selector">选择器（Selector）<span id="2"></span></h1> <p>三种样式中，<strong>嵌入式</strong>和<strong>外部式</strong>需要使用到<strong>选择器</strong>，也是组成 css 样式的主体例如上例中的 <code class="highlighter-rouge">p { }</code>，主要分为： 元素选择器、类选择器、ID选择器、子选择器、后代选择器、通用选择器、属性选择器、伪元素选择器、组选择器、相邻同级选择器。</p> <h2 id="元素选择器type-selector">元素选择器（Type selector）<span id="2.1"></span></h2> <p>也叫类型选择器，可以理解为<strong>标签选择器</strong>，最基本的选择器，就是使用常见的HTML元素，例如：<code class="highlighter-rouge">body { }</code>, <code class="highlighter-rouge">h { }</code>, <code class="highlighter-rouge">p { }</code>, <code class="highlighter-rouge">div { }</code>, <code class="highlighter-rouge">span { }</code>, <code class="highlighter-rouge">a { }</code> 等。</p> <h2 id="类选择器class-selector">类选择器（Class selector）<span id="2.2"></span></h2> <p><strong>前提</strong>需要在标签内使用<strong>类</strong>标记某处文档，类似：<code class="highlighter-rouge">class = "myClass"</code>，然后它的选择器的格式就为：<code class="highlighter-rouge">.myClass { }</code>，就是在类名前面加个小数点。</p> <h2 id="id选择器id-selecctor">ID选择器（ID selecctor）<span id="2.3"></span></h2> <p>和类选择器类似，<strong>前提</strong>需要在标签内使用<strong>ID</strong>标记某处文档，类似：<code class="highlighter-rouge">id = "myId"</code>，格式为：<code class="highlighter-rouge">#myId { }</code>，就是在 ID 前加个符号 <code class="highlighter-rouge">#</code>。</p> <blockquote> <p><strong>ID选择器与类选择器的区别：</strong> <span id="2.3.1"> 类选择器可以使用多次，ID选择器只能使用一次，例如： <code class="highlighter-rouge">&lt;p class = "one"&gt;This is a test content, &lt;/p&gt;</code> <code class="highlighter-rouge">&lt;p class = "one"&gt;hello world !&lt;/p&gt;</code>，但是ID不能这样。 并且能同时使用多个类分别标记不同样式，例如：<code class="highlighter-rouge">&lt;p class = "one two"&gt;&lt;/p&gt;</code>，ID也不能这样。</span></p> </blockquote> <h2 id="子选择器child-selector-">子选择器（Child selector） <span id="2.4"></span></h2> <p>用于指定标签元素的<strong>子元素</strong>，使用符号 <code class="highlighter-rouge">&gt;</code> 隔开父元素与子元素，例如： HTML：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p1&gt; Hello World !!! &lt;p2&gt;This is a test content&lt;/p2&gt; &lt;/p1&gt; </code></pre></div></div> <p>CSS:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p1&gt;p2 { color: green; font-size: 20px; } </code></pre></div></div> <p>这里就指定了父元素 <code class="highlighter-rouge">p1</code> 的子元素 <code class="highlighter-rouge">p2</code> 的样式，但是<strong>只作用于子元素，不作用于父元素</strong>。</p> <h2 id="后代选择器descendant-selector-">后代选择器（Descendant selector） <span id="2.5"></span></h2> <p>用于指定标签元素的<strong>后代元素</strong>，使用空格符号隔开，例如： html:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p1&gt; Hello world !!! &lt;p2&gt; This is a &lt;a&gt;test&lt;/a&gt; content &lt;/p2&gt; &lt;/p1&gt; </code></pre></div></div> <p>css:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p1 a { color: green; font-size: 20px; } </code></pre></div></div> <p>这里指定了元素 <code class="highlighter-rouge">p1</code> 的后代元素 <code class="highlighter-rouge">a</code> 的样式，注意这里不是<strong>子代元素</strong> <code class="highlighter-rouge">p2</code>，就是作用于<strong>所有指明的后代元素</strong>。</p> <blockquote> <p><strong>子代选择器与后代选择器的区别：</strong> <span id="2.5.1"> 顾名思义的理解，后代就是包含子代在内的所有下代的元素，可以跨越子代直接作用于孙代；而子代只包含父级的<strong>第一代子代</strong>元素。 子代选择器使用符号 <code class="highlighter-rouge">&gt;</code> 隔开，后代选择器使用<code class="highlighter-rouge">空格</code> 隔开。</span></p> </blockquote> <h2 id="通用选择器-">通用选择器 <span id="2.6"></span></h2> <p>顾名思义，使用通配符 <code class="highlighter-rouge">*</code> 设置 html 中<strong>所有标签</strong>的样式，例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="nl">font-size</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span> <span class="p">}</span> </code></pre></div></div> <p>这样就设置了HTML中所有的标签的样式了。</p> <h2 id="属性选择器attribute-selector-">属性选择器（Attribute selector） <span id="2.7"></span></h2> <p>对<strong>具有指定的属性</strong>(attribute)设置样式，使用方括号符号 <code class="highlighter-rouge">[ ]</code>。</p> <h3 id="简单属性选择器-">简单属性选择器 <span id="2.7.1"></span></h3> <p>不用管属性值，例如：</p> <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="nt">href</span><span class="o">]</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">}</span> <span class="nt">a</span> <span class="o">[</span><span class="nt">href</span><span class="o">]</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">}</span> <span class="nt">a</span> <span class="o">[</span><span class="nt">href</span><span class="o">]</span> <span class="o">[</span><span class="nt">title</span><span class="o">]</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">}</span> </code></pre></div></div> <blockquote> <p>以上格式都能实现相同效果，即具有该属性的 <code class="highlighter-rouge">a</code> 标签。</p> </blockquote> <h3 id="属性和值选择器-">属性和值选择器 <span id="2.7.2"></span></h3> <p>具有指定属性与其<strong>指定值</strong>的标签，格式为：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a [title = "link"] {color: red} </code></pre></div></div> <h2 id="伪元素选择器-">伪元素选择器 <span id="2.8"></span></h2> <p>HTML中存在一类与元素控制内容相同的<strong>抽象元素</strong>，但是并不实际存在于HTML文档，给标签的<strong>某种状态</strong>设置样式，例如单击某内容或鼠标滑过某内容，然后设置改变的样式。伪元素种类较多，只列举几个常用例子。</p> <h3 id="active-">:active <span id="2.8.1"></span></h3> <p>为<strong>激活</strong>的元素设置样式，就是用户单击该标签时的样式，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a:active {color: red} </code></pre></div></div> <p>则用户点击这个链接文本时颜色变为红色。</p> <h3 id="hover-">:hover <span id="2.8.2"></span></h3> <p>悬停状态伪元素，为用户鼠标所<strong>停靠</strong>的标签设置样式，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p:hover {color: red} </code></pre></div></div> <p>则鼠标停留在该段落时，段落内容变为红色。</p> <h3 id="focus-">:focus <span id="2.8.3"></span></h3> <p>用于具有<strong>焦点</strong>的元素，常用就是输入框，用户点击输入框准备输入时则该输入框就具有了焦点，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input:focus {background-color: green} 则点击输入框时背景颜色变为绿色。 </code></pre></div></div> <h3 id="selection-">::selection <span id="2.8.4"></span></h3> <p>为选中的元素设置样式，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>::selection {color: red} </code></pre></div></div> <p>为文档中鼠标选定的内容设置为红色字体。注意可以追加应用范围：<code class="highlighter-rouge">p::selection</code> 表示段落中选中的字体才应用该样式，不追加直接使用 <code class="highlighter-rouge">::selection</code> 表示应用于所有内容。 <strong>火狐浏览器</strong>支持需要使用 <code class="highlighter-rouge">-moz-selection</code>。</p> <h3 id="first-child-">:first-child <span id="2.8.5"></span></h3> <p>为元素的第一子代应用样式，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p:first-child {color: red} </code></pre></div></div> <p>这个比较好理解。</p> <h3 id="nth-child-">:nth-child() <span id="2.8.6"></span></h3> <p>为元素的<strong>父元素</strong>的第 n 个子代设置样式，只是括号内需要输入数字表示第几代，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p:nth-child(2) {color: red} </code></pre></div></div> <p>假如p标签父元素是body，就表示为body的第二个子元素设置样式。</p> <h2 id="组选择器-">组选择器 <span id="2.9"></span></h2> <p>为多个元素设置相同样式时，可以使用<strong>逗号</strong>分隔元素，达到同时设置的效果。例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p1,p1 {color: red} </code></pre></div></div> <p>表示为p1和p2 <strong>同时</strong>设置<strong>相同</strong>的样式。</p> <h2 id="相邻同级选择器-">相邻同级选择器 <span id="2.10"></span></h2> <p>选择与指定元素同级的相邻的第一个某元素，设置样式，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>div+p {color: red} </code></pre></div></div> <p>表示为 p 设置样式，并且这个 p 与 div 同级，并且是与 div <strong>相邻的第一个</strong> p，div <strong>内部</strong>的 p 并不包含在内。</p> <hr /> <h1 id="返回顶部">返回<a href="#home">顶部</a></h1> Wed, 02 May 2018 00:00:00 +0000 https://knightyun.github.io/2018/05/02/css-selector C语言之变量存储类型与链接属性 https://knightyun.github.io/2018/04/28/c-storage-type <p>C语言中一个重要的东西就是弄清申明变量的类型、作用域、存储类型、链接属性等，例如是整型还是浮点型，存储于普通内存还是堆栈或者寄存器，作用于全局还是局部，能否被其他文件 引用等。</p> <h1 id="链接属性">链接属性</h1> <p>申明变量或函数时需要<strong>标识符</strong>，标识符的链接属性一共有三种：<code class="highlighter-rouge">external(外部)</code>, <code class="highlighter-rouge">internal(内部)</code>, <code class="highlighter-rouge">none(无)</code>，external和internal常用，<strong>none</strong>表示无链接属性，该标识符的多个申明被当成独立不同的实体。</p> <p>顾名思义，<strong>external</strong>表示能被其它源文件访问的变量或函数，<strong>internal</strong>则不能被其它源文件访问，并且<strong>缺省</strong>情况下<strong>代码块(block)外部</strong>的变量为<strong>external</strong>属性，也就是外部变量，<strong>代码块内部</strong>的变量为<strong>internal</strong>属性，即局部变量.</p> <p>如果需要改变链接属性需要使用 <code class="highlighter-rouge">extern</code> 和 <code class="highlighter-rouge">static</code> 关键字，<code class="highlighter-rouge">extern</code> 是转化为<strong>external</strong>属性，<code class="highlighter-rouge">static</code> 是转化为<strong>internal</strong>属性。 举例说明：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 这里是代码块外部，external 属性，缺省为"extern" */</span> <span class="k">extern</span> <span class="kt">int</span> <span class="n">aa</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span> <span class="cm">/* 与上面效果一样 */</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">aaa</span> <span class="o">=</span> <span class="mi">111</span><span class="p">;</span> <span class="cm">/* 这里申明的是 internal 属性，不能被其它源文件访问 */</span> <span class="kt">void</span> <span class="nf">example</span><span class="p">()</span> <span class="cm">/* 这里申明的 example() 函数也是external属性，能被其它源文件访问 */</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* 这里是代码块内部，internal 属性 */</span> <span class="k">extern</span> <span class="kt">int</span> <span class="n">bb</span> <span class="o">=</span> <span class="mi">22</span><span class="p">;</span> <span class="cm">/* 这里的意思是访问其它源文件的全局变量 */</span> <span class="p">}</span> </code></pre></div></div> <blockquote> <p><strong>注意上面指出的代码块内部和外部，定义的函数的花括号之外叫做代码块外部，之内叫做代码块内部。</strong> <strong>代码块外部缺省为<code class="highlighter-rouge">extern</code>，并且代码块外部使用<code class="highlighter-rouge">extern</code>表示被其它源文件访问，代码块内部使用<code class="highlighter-rouge">extern</code>表示访问其它文件的外部变量。</strong></p> </blockquote> <h1 id="存储类型">存储类型</h1> <p>存储类型指申明的变量将被存储到什么地方去，并且与其存储周期有关，就是这个变量何时被创建，何时被销毁，保持多久。</p> <p>存储类型有三种： 静态变量(<code class="highlighter-rouge">static</code>) —&gt; 存储于普通内存。 自动变量(<code class="highlighter-rouge">auto</code>) —&gt; 存储于堆栈。 寄存器变量(<code class="highlighter-rouge">register</code>) —&gt; 存储于寄存器。</p> <h6 id="静态变量">静态变量</h6> <p>任何代码块之外定义的变量，总是处于静态内存中，无需使用 <code class="highlighter-rouge">static</code> 关键字，在程序运行<strong>之前</strong>创建，程序整个执行期间<strong>始终存在</strong>。</p> <h6 id="自动变量">自动变量</h6> <p>代码块内部申明的变量，并且<strong>缺省</strong>情况下都是(<code class="highlighter-rouge">auto</code>)类型，所以很少使用，存储于堆栈中，程序执行到申明变量处被创建，离开后被销毁，每次在堆栈中占据的内存位置都<strong>可能不同</strong>。</p> <h6 id="寄存器变量">寄存器变量</h6> <p>用于申明<strong>自动变量</strong>，即在<strong>代码块内部</strong>使用，使这类变量存储于寄存器中，<strong>寄存器中的变量比内存中的变量访问效率更高</strong>。 但是，如果有<strong>太多</strong>变量申明为 <code class="highlighter-rouge">register</code> ，只会选取前几个存储于寄存器中，其它处理为普通自动变量。</p> <p>通常把<strong>使用频率最高</strong>的变量申明为寄存器变量，或者指针申明为寄存器变量，以提高效率。例如可以把函数的形参申明为寄存器变量（有可能它节省的时间空间开销抵不上复制这几个值的开销）。</p> <h6 id="综合举例">综合举例</h6> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 静态变量(static)，这里不能使用 register */</span> <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* 自动变量，省略 auto */</span> <span class="k">register</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="cm">/* 寄存器变量(register) */</span> <span class="kt">int</span> <span class="n">aaa</span><span class="p">(</span><span class="k">register</span> <span class="kt">int</span> <span class="n">d</span><span class="p">)</span> <span class="cm">/* 申明函数形参为 register */</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="cm">/* 申明静态变量，和变量 b 一个属性 */</span> <span class="p">}</span> </code></pre></div></div> <h6 id="初始化">初始化</h6> <p>静态变量在不指定初始值的时候，初始化为 <code class="highlighter-rouge">0</code>； 自动变量是否初始化赋值，并无效率的改变（每次执行都要重新初始化），这也是它的优点：可以用任何“表达式”作为初始值。例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int add(int a) { int b = a + 1; /* 将表达式 a + 1 的值初始化给 b */ return b; } </code></pre></div></div> <h1 id="注意">注意</h1> <ul> <li><code class="highlighter-rouge">static</code> 申明函数或代码块之外的变量时，只修改<strong>链接属性</strong> ``external<code class="highlighter-rouge"> 为 </code>internal`，<strong>存储类型</strong>和<strong>作用域</strong>不变。</li> <li><code class="highlighter-rouge">static</code> 申明代码块内部变量时，将自动变量修改为<strong>静态变量</strong>，但是<strong>链接属性</strong>和<strong>作用域</strong>不变。</li> </ul> <h6 id="综合举例-1">综合举例</h6> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 链接属性为 external，缺省 extern */</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* 修改连接属性为静态变量，不能被其它源文件访问，依然为全局变量，存储于静态内存中 */</span> <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="cm">/* 自动变量，存储到堆栈 */</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="cm">/* 静态变量，存储到普通内存，依然不能被其它源文件访问 */</span> <span class="p">}</span> </code></pre></div></div> Sat, 28 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/28/c-storage-type C语言之随机数函数(rand())的使用方法 https://knightyun.github.io/2018/04/25/c-rand-number <p>在程序设计中，难免会使用到随机值函数，其原理与语法大多类似，接下来以C语言为例介绍其随机值函数 <code class="highlighter-rouge">rand()</code> 用法。</p> <h1 id="原理">原理</h1> <p>引用<a href="https://baike.baidu.com/item/rand%28%29">百度百科</a>，首先，需要包含头文件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt; rand()函数是按指定的顺序来产生整数，因此每次执行上面的语句都打印相同的两个值，所以说C语言的随机并不是真正意义上的随机，有时候也叫[伪随机数][wei]，使用 `rand()` 生成随机数之前需要用随机发生器的初始化函数 `srand(unsigned seed)`（也位于 `stdlib.h` 中） 进行伪随机数序列初始化，`seed` 又叫[随机种子][seed]，通俗讲就是，如果每次提供的 `seed` 是一样的话，最后每一轮生成的几个随机值也都是一样的，因此叫伪随机数，所以需要每次提供不同的 `seed` 达到完全的随机，我们通常用时间函数 `time(NULL)` 作为 `seed` ，因为时间值每秒都不同，这个函数需要包含以下头文件： #include &lt;time.h&gt; </code></pre></div></div> <p>理论太泛，下面用例子分析理解。</p> <h1 id="举例分析">举例分析</h1> <p>先来理解以下伪随机数，编译以下代码：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="n">srand</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d, "</span><span class="p">,</span> <span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">11</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>运行结果</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8, 9, 9, 1, 7, 5, 5, 10, 1, 0, </code></pre></div></div> <p>然后无论运行多少次，结果都依然是以上随机数，不会改变，因为每次设置的种子 <code class="highlighter-rouge">seed</code> 都是 <code class="highlighter-rouge">1</code> 。</p> <p>但是假如把 <code class="highlighter-rouge">seed</code> 换成 <code class="highlighter-rouge">time(NULL)</code>，每次就不一样了，如下：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d, "</span><span class="p">,</span> <span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">11</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>结果是就变了，并且每次都不一样：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6, 3, 4, 5, 5, 9, 8, 10, 10, 4, 6, 4, 2, 4, 3, 2, 5, 1, 2, 9, </code></pre></div></div> <blockquote> <p><strong>这里的 <code class="highlighter-rouge">time(NULL)</code> 的结果是一个类似于 <code class="highlighter-rouge">1524655706</code> 的数字，并且每秒都在递增 1，也就达成了 srand() 的 seed 不断变化的目的，不断生成新的随机数。</strong></p> </blockquote> <h1 id="拓展">拓展</h1> <p>这里注意一下例子中函数 <code class="highlighter-rouge">rand()</code> 的用法，函数括号内不需要加参数，如果直接调用 <code class="highlighter-rouge">rand()</code> 的话会生成下面这样的数：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17163, 2663, 24810, 4875, 26975, 14119, 22193, 11233, 26009, 20105, 所以我们想要生成指定范围的随机数的话就需要使用到**求余**运算符 `%`，这里有个规律：例如我们需要 0--10的随机数时，就写成 `rand()%11`，0--100就写成 `rand()%101`，就是运算符后的数字需要比需求范围极值大 1，当然这也是取余运算的原理。 </code></pre></div></div> <hr /> Wed, 25 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/25/c-rand-number 贪吃蛇C语言源码与算法分析 https://knightyun.github.io/2018/04/24/c-gluttonous-snake <p>经典的贪吃蛇游戏算法，无疑是一个较大的挑战，综合性较高，像我这种刚入门C语言的也差不多花了整整一周时间才差不多理解透彻，内部包含了较多的函数，数组，二维数组，循环等思想。 Github项目地址：<a href="https://github.com/knightyun/gluttonousSnake/">https://github.com/knightyun/gluttonousSnake/</a></p> <p>接下来以C语言为例，针对此算法截取代码片段进行详细分析，源码位于文章<a href="#end">底部</a>。</p> <h1 id="算法分析">算法分析</h1> <h2 id="概述">概述</h2> <p>首先分析一下，贪吃蛇最基本和重要的动作，一段在屏幕上移动和转向的躯干，但是C语言没有移动字符的函数，只能不断向屏幕打印输出和清屏实现移动，躯干位置在屏幕上的变化可以用二维坐标系实现，用一个二维数组保存屏幕所有可见内容的x，y坐标，并赋予几种初始值，然后用函数打印出各种值对应的字符，再用循环和坐标值自增自减实现移动。使用输入函数判断方向，随机函数生成食物，根据头部坐标判断撞墙或吃到自己而结束游戏。</p> <h2 id="头文件">头文件</h2> <p>Windows环境中需要包含的头文件：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; #include&lt;Windows.h&gt; </span><span class="cm">/*需要使用system("cls")清屏函数*/</span><span class="cp"> #include&lt;conio.h&gt; </span><span class="cm">/*非标准库函数，VS中自带，需要使用_getch()函数获取输入*/</span><span class="cp"> #include&lt;time.h&gt; </span><span class="cm">/*使用随机数函数需要使用time()函数*/</span><span class="cp"> </span></code></pre></div></div> <h2 id="预定义">预定义</h2> <p>游戏内可自定义设置界面宽度与高度，需要给二维数组定义一个最大值：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define MAXX 10000 </span><span class="cm">/* 定义游戏最大界面宽度坐标值 */</span><span class="cp"> #define MAXY 10000 </span><span class="cm">/* 定义最大高度 */</span><span class="cp"> </span></code></pre></div></div> <h2 id="申明变量">申明变量</h2> <p>需要用到的变量和功能如下：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">speed</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="cm">/* 设置蛇移动速度 */</span> <span class="kt">int</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">MAXX</span><span class="p">][</span><span class="n">MAXY</span><span class="p">];</span> <span class="cm">/* 保存界面坐标值的二维数组 */</span> <span class="kt">int</span> <span class="n">inputX</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">inputY</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="cm">/* 默认游戏界面宽度和高度 */</span> <span class="kt">int</span> <span class="n">randX</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">randY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* 生成的随机食物的坐标值 */</span> <span class="kt">int</span> <span class="n">foodFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* 判断是否更新食物 */</span> <span class="kt">int</span> <span class="n">sx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 设置蛇身坐标值 */</span> <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* 蛇身长度 */</span> <span class="kt">int</span> <span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="n">MAXX</span> <span class="o">*</span> <span class="n">MAXY</span><span class="p">];</span> <span class="cm">/* 储存蛇身的指针数组 */</span> <span class="kt">char</span> <span class="n">input</span> <span class="o">=</span> <span class="sc">'6'</span><span class="p">;</span> <span class="cm">/* 默认移动方向 */</span> <span class="kt">int</span> <span class="n">overFlag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 判断游戏结束，撞墙或吃到自己 */</span> <span class="kt">int</span> <span class="n">moveX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">moveY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 游戏开始的动画效果坐标值 */</span> <span class="kt">int</span> <span class="n">moveFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* 开始动画的循环判断 */</span> </code></pre></div></div> <blockquote> <p>这里使用了指针数组控制蛇身，方便赋值 数组中的参数虽然不能是变量，但是可以是宏定义</p> </blockquote> <h2 id="函数">函数</h2> <p>接下来就是重要环节了，分析实现游戏效果的各个函数。</p> <ul> <li>第一步，定义初始化函数 <code class="highlighter-rouge">InitMap()</code> 将屏幕上每个点通过二维数组赋予坐标值 x、y，确定游戏界面的大小，我们将四周的墙赋值为 <code class="highlighter-rouge">1</code>，中间空白赋值为 <code class="highlighter-rouge">0</code>，蛇身赋值为 <code class="highlighter-rouge">2</code>，随机出现的食物赋值为 <code class="highlighter-rouge">3</code>。</li> <li>第二步，定义 <code class="highlighter-rouge">PrintMap()</code> 函数给每个 坐标值打印对应的字符，我们将墙用字符 <code class="highlighter-rouge">+</code> 表示，空白用空字符 <code class="highlighter-rouge">" "</code> 表示，蛇身用星号 <code class="highlighter-rouge">*</code> 表示，食物用字符 <code class="highlighter-rouge">@</code> 表示。</li> <li>第三步，定义函数 <code class="highlighter-rouge">StartMsg()</code> 显示屏幕信息，提示控制的按键。</li> <li>第四步，定义函数 <code class="highlighter-rouge">GetSet()</code> 使玩家可以自定义游戏界面宽和高和移动速度，使用 <code class="highlighter-rouge">scanf()</code> 函数获取并改变默认界面尺寸。</li> <li>第五步，定义函数 <code class="highlighter-rouge">SetRandNum()</code> 在界面中随机出现食物，并且不与蛇身和墙重叠，使用 <code class="highlighter-rouge">srand(time(0))</code> 初始随机函数，然后用一个循环不断用随机函数 <code class="highlighter-rouge">rand()</code> 生成随机坐标值，直到所生成位置是空白为止。</li> <li>第六步，最核心的算法，较为复杂，定义函数 <code class="highlighter-rouge">SetSnakeNum()</code> 设置蛇身的坐标值，并通过通过输入判断前进方向，以设置的速度时间间隔不断自增或自减坐标值实现移动，里面用到了 <code class="highlighter-rouge">_kbhit()</code> 函数，作用是：有用户输入时，返回值为<strong>真</strong>，无输入时值为<strong>假</strong>。还有 <code class="highlighter-rouge">_getch()</code> 函数与 <code class="highlighter-rouge">getchar()</code> 的区别：<code class="highlighter-rouge">_getch()</code> 输入值后不用输入回车就能获取输入值。感觉最不好理解的就是蛇身的转弯算法，我的方法是：<strong>蛇身每一节在每一次循环不断继承前一节的值</strong>，然后蛇头位置不断获得新坐标值，这样就能实现身体的转向，这里就可以用到之前定义的指针数组 <code class="highlighter-rouge">*body[]</code> 来实现。算法中还需要<strong>注意</strong>的一点是，蛇身朝某个方向移动时，只能控制另外两个方向，例如向右移动时不能控制向左移动。然后随后的函数就好说了。</li> <li>第七步，定义函数 <code class="highlighter-rouge">EatFood()</code> 实现遇到食物坐标值时，增加一节蛇身长度值 <code class="highlighter-rouge">l</code> 。</li> <li>第八步，定义函数 <code class="highlighter-rouge">StartGame()</code> 来综合之前的函数并开始游戏，需要通过 <code class="highlighter-rouge">overFlag</code> 判断游戏结束。</li> <li>第九步，定义函数 <code class="highlighter-rouge">SetMoveNum()</code> 实现游戏开始时的动画效果，对于游戏存在意义不大，仅供研究训练思维和算法。</li> <li>第十步，定义函数 <code class="highlighter-rouge">JudgeEnd()</code> 判断之前的函数 <code class="highlighter-rouge">SetMuveNum()</code> 的结束时刻，然后不断循环动画效果。</li> <li>第十一步，定义函数 <code class="highlighter-rouge">StartView()</code> 开始游戏，按任意键游戏正式开始。</li> </ul> <p>下面是函数申明：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">InitMap</span><span class="p">();</span> <span class="cm">/* initialize the background coordinate system */</span> <span class="kt">void</span> <span class="nf">PrintMap</span><span class="p">();</span> <span class="cm">/* print every point in the arr mapArr to the screen */</span> <span class="kt">void</span> <span class="nf">StartMsg</span><span class="p">();</span> <span class="cm">/* start message */</span> <span class="kt">void</span> <span class="nf">GetSet</span><span class="p">();</span> <span class="cm">/* judge whether to edit the game setting */</span> <span class="kt">void</span> <span class="nf">SetRandNum</span><span class="p">();</span> <span class="cm">/* set a random 'food' point in the screen */</span> <span class="kt">void</span> <span class="nf">SetSnakeNum</span><span class="p">();</span> <span class="cm">/* the most complex and important algorithm of this game */</span> <span class="kt">void</span> <span class="nf">EatFood</span><span class="p">();</span> <span class="cm">/* judge when to eat food and elongate the body */</span> <span class="kt">void</span> <span class="nf">StartGame</span><span class="p">();</span> <span class="cm">/* start the game */</span> <span class="kt">void</span> <span class="nf">SetMoveNum</span><span class="p">();</span> <span class="cm">/* algorithm of the start animation, some complex */</span> <span class="kt">void</span> <span class="nf">JudgeEnd</span><span class="p">();</span> <span class="cm">/* judge the end of the animation and loop again*/</span> <span class="kt">void</span> <span class="nf">StartView</span><span class="p">();</span> <span class="cm">/* start the start animation view */</span> </code></pre></div></div> <h1 id="源码-">源码 <span id="end"></span></h1> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; #include&lt;Windows.h&gt; </span><span class="cm">/* use the function 'system("cls")' to clear screen */</span><span class="cp"> #include&lt;conio.h&gt; </span><span class="cm">/* use the function '_getch()' to get input */</span><span class="cp"> #include&lt;time.h&gt; </span><span class="cm">/* the random function need the 'time()' function */</span><span class="cp"> #include "public-fun.h" </span> <span class="cp">#define MAXX 10000 </span><span class="cm">/* define the max width of game space */</span><span class="cp"> #define MAXY 10000 </span><span class="cm">/* define the max height */</span><span class="cp"> </span> <span class="kt">void</span> <span class="nf">InitMap</span><span class="p">();</span> <span class="cm">/* initialize the background coordinate system */</span> <span class="kt">void</span> <span class="nf">PrintMap</span><span class="p">();</span> <span class="cm">/* print every point in the arr mapArr to the screen */</span> <span class="kt">void</span> <span class="nf">StartMsg</span><span class="p">();</span> <span class="cm">/* start message */</span> <span class="kt">void</span> <span class="nf">GetSet</span><span class="p">();</span> <span class="cm">/* judge whether to edit the game setting */</span> <span class="kt">void</span> <span class="nf">SetRandNum</span><span class="p">();</span> <span class="cm">/* set a random 'food' point in the screen */</span> <span class="kt">void</span> <span class="nf">SetSnakeNum</span><span class="p">();</span> <span class="cm">/* the most complex and important algorithm of this game */</span> <span class="kt">void</span> <span class="nf">EatFood</span><span class="p">();</span> <span class="cm">/* judge when to eat food and elongate the body */</span> <span class="kt">void</span> <span class="nf">StartGame</span><span class="p">();</span> <span class="cm">/* start the game */</span> <span class="kt">void</span> <span class="nf">SetMoveNum</span><span class="p">();</span> <span class="cm">/* algorithm of the start animation, some complex */</span> <span class="kt">void</span> <span class="nf">JudgeEnd</span><span class="p">();</span> <span class="cm">/* judge the end of the animation and loop again*/</span> <span class="kt">void</span> <span class="nf">StartView</span><span class="p">();</span> <span class="cm">/* start the start animation view */</span> <span class="kt">int</span> <span class="n">speed</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="cm">/* default snake move speed */</span> <span class="kt">int</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">MAXX</span><span class="p">][</span><span class="n">MAXY</span><span class="p">];</span> <span class="cm">/* arr to store the point in the screen */</span> <span class="kt">int</span> <span class="n">inputX</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">inputY</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="cm">/* default width and height */</span> <span class="kt">int</span> <span class="n">randX</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">randY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* set a random food point in the background */</span> <span class="kt">int</span> <span class="n">foodFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* judge when to change random food point*/</span> <span class="kt">int</span> <span class="n">sx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* body x, y point */</span> <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* body lenth */</span> <span class="kt">int</span> <span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="n">MAXX</span> <span class="o">*</span> <span class="n">MAXY</span><span class="p">];</span> <span class="cm">/* body array pointer */</span> <span class="kt">char</span> <span class="n">input</span> <span class="o">=</span> <span class="sc">'6'</span><span class="p">;</span> <span class="cm">/* default direction */</span> <span class="kt">int</span> <span class="n">overFlag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* judge when the game over, hit wall or eat self*/</span> <span class="kt">int</span> <span class="n">moveX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">moveY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* start move effect */</span> <span class="kt">int</span> <span class="n">moveFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* restart the loop effection */</span> <span class="kt">void</span> <span class="nf">GetSet</span><span class="p">()</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">"请输入游戏空间的宽度：</span><span class="se">\n</span><span class="s">(Please enter the width of game space:)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">scanf_s</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inputX</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">"请输入游戏空间的高度：</span><span class="se">\n</span><span class="s">(Please enter the height of game space:)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">scanf_s</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inputY</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">printf</span><span class="p">(</span><span class="s">"请输入游戏速度（1 到 n，1 最慢）：</span><span class="se">\n</span><span class="s">Please enter the speed of snake moving:(1 is slowest)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">scanf_s</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">speed</span><span class="p">);</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">InitMap</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">inputY</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">inputX</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">inputX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">inputY</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">PrintMap</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">inputY</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">inputX</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">switch</span> <span class="p">(</span><span class="n">mapArr</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span> <span class="p">{</span> <span class="k">case</span> <span class="mi">0</span><span class="p">:</span> <span class="n">printf</span><span class="p">(</span><span class="s">" "</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="mi">1</span><span class="p">:</span> <span class="n">printf</span><span class="p">(</span><span class="s">"+"</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="mi">2</span><span class="p">:</span> <span class="n">printf</span><span class="p">(</span><span class="s">"*"</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="mi">3</span><span class="p">:</span> <span class="n">printf</span><span class="p">(</span><span class="s">"@"</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">StartMsg</span><span class="p">()</span> <span class="p">{</span> <span class="n">printf</span> <span class="p">(</span><span class="s">"'2(top)', '8(down)', '4(left)', 6(right)' 或 </span><span class="se">\n</span><span class="s">'w(top)', 'a(left)', 's(down)', 'd(right)'</span><span class="se">\n</span><span class="s">控制方向(control the direction)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">SetRandNum</span><span class="p">()</span> <span class="p">{</span> <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="k">while</span> <span class="p">((</span><span class="n">mapArr</span><span class="p">[</span><span class="n">randX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">randY</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">foodFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> <span class="n">randX</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="n">inputX</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">randY</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="n">inputY</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="p">}</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">randX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">randY</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="cm">/* set foot number 3 */</span> <span class="n">foodFlag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">SetSnakeNum</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">_kbhit</span><span class="p">())</span> <span class="cm">/* if there is an input, get it; if not, go on */</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">_getch</span><span class="p">();</span> <span class="k">switch</span> <span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span> <span class="k">case</span> <span class="sc">'2'</span><span class="p">:</span> <span class="k">case</span> <span class="sc">'w'</span><span class="p">:</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="sc">'4'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'6'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'a'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'d'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'2'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'w'</span><span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'8'</span><span class="p">:</span> <span class="k">case</span> <span class="sc">'s'</span><span class="p">:</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="sc">'4'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'6'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'a'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'d'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'8'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'s'</span><span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'4'</span><span class="p">:</span> <span class="k">case</span> <span class="sc">'a'</span><span class="p">:</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="sc">'2'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'8'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'w'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'s'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'4'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'a'</span><span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'6'</span><span class="p">:</span> <span class="k">case</span> <span class="sc">'d'</span><span class="p">:</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="sc">'2'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'8'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'w'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'s'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'6'</span> <span class="o">||</span> <span class="n">a</span> <span class="o">==</span> <span class="sc">'d'</span><span class="p">)</span> <span class="n">input</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="k">switch</span> <span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="cm">/* judge the direction by value of input */</span> <span class="p">{</span> <span class="k">case</span> <span class="sc">'2'</span><span class="p">:</span> <span class="cm">/* up */</span> <span class="k">case</span> <span class="sc">'w'</span><span class="p">:</span> <span class="n">sy</span><span class="o">--</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'8'</span><span class="p">:</span> <span class="cm">/* down */</span> <span class="k">case</span> <span class="sc">'s'</span><span class="p">:</span> <span class="n">sy</span><span class="o">++</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'4'</span><span class="p">:</span> <span class="cm">/* left */</span> <span class="k">case</span> <span class="sc">'a'</span><span class="p">:</span> <span class="n">sx</span><span class="o">--</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="k">case</span> <span class="sc">'6'</span><span class="p">:</span> <span class="cm">/* right */</span> <span class="k">case</span> <span class="sc">'d'</span><span class="p">:</span> <span class="n">sx</span><span class="o">++</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="cm">/* every point's address of body move back one point */</span> <span class="p">{</span> <span class="n">body</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* change value by pointer */</span> <span class="p">}</span> <span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">mapArr</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="n">sy</span><span class="p">];</span> <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span> <span class="cm">/* judge when the snake hit the wall or eat itself */</span> <span class="p">{</span> <span class="n">overFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* assign the head of snake by pointer */</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">EatFood</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span><span class="o">++</span><span class="p">;</span> <span class="n">foodFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">StartGame</span><span class="p">()</span> <span class="p">{</span> <span class="n">sx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">sy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">input</span> <span class="o">=</span> <span class="sc">'6'</span><span class="p">;</span> <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="cm">/* assign the snake body initial address value*/</span> <span class="p">{</span> <span class="n">body</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">mapArr</span><span class="p">[</span><span class="n">sx</span> <span class="o">-</span> <span class="n">j</span><span class="p">][</span><span class="n">sy</span><span class="p">];</span> <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">overFlag</span><span class="p">)</span> <span class="cm">/* loop until the game over */</span> <span class="p">{</span> <span class="n">InitMap</span><span class="p">();</span> <span class="n">SetSnakeNum</span><span class="p">();</span> <span class="n">SetRandNum</span><span class="p">();</span> <span class="n">EatFood</span><span class="p">();</span> <span class="n">PrintMap</span><span class="p">();</span> <span class="n">StartMsg</span><span class="p">();</span> <span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="n">speed</span><span class="p">);</span> <span class="n">system</span><span class="p">(</span><span class="s">"cls"</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">SetMoveNum</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* x move 1 -- (X - 2 ); y move 1 -- (Y - 2) */</span> <span class="cm">/* move x from left to right */</span> <span class="k">if</span> <span class="p">((</span><span class="n">moveY</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">moveFlag</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">moveX</span> <span class="o">&lt;</span> <span class="n">inputX</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">moveFlag</span><span class="p">))</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">moveX</span><span class="p">][</span><span class="n">moveY</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">moveX</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="cm">/* move y from top to buttom */</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">moveX</span> <span class="o">==</span> <span class="n">inputX</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">moveFlag</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">moveY</span> <span class="o">&lt;</span> <span class="n">inputY</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">moveFlag</span><span class="p">))</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">moveX</span><span class="p">][</span><span class="n">moveY</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">moveY</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="cm">/* move x from right to left */</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">moveY</span> <span class="o">==</span> <span class="n">inputY</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">moveFlag</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">moveX</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">moveFlag</span><span class="p">))</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">moveX</span><span class="p">][</span><span class="n">moveY</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">moveX</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span> <span class="cm">/* move y from buttom to top */</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">moveX</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">moveFlag</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">moveY</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">moveFlag</span><span class="p">))</span> <span class="p">{</span> <span class="n">mapArr</span><span class="p">[</span><span class="n">moveX</span><span class="p">][</span><span class="n">moveY</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">moveY</span><span class="o">--</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">moveY</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">moveFlag</span><span class="p">)</span> <span class="cm">/* judge when to jump to a deeper layer */</span> <span class="p">{</span> <span class="n">moveFlag</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">JudgeEnd</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span> <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">inputY</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">inputX</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">mapArr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">goto</span> <span class="n">out</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="n">moveX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">moveY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">InitMap</span><span class="p">();</span> <span class="n">moveFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nl">out:</span><span class="p">;</span> <span class="p">}</span> <span class="kt">void</span> <span class="nf">StartView</span><span class="p">()</span> <span class="p">{</span> <span class="n">moveX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">moveY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">moveFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="kt">int</span> <span class="n">startFlag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">InitMap</span><span class="p">();</span> <span class="k">while</span> <span class="p">(</span><span class="n">startFlag</span><span class="p">)</span> <span class="p">{</span> <span class="n">SetMoveNum</span><span class="p">();</span> <span class="n">PrintMap</span><span class="p">();</span> <span class="n">printf</span><span class="p">(</span><span class="s">"按任意键开始游戏：</span><span class="se">\n</span><span class="s">(Press any key to start game: )</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">Sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">system</span><span class="p">(</span><span class="s">"cls"</span><span class="p">);</span> <span class="n">JudgeEnd</span><span class="p">();</span> <span class="k">if</span> <span class="p">(</span><span class="n">_kbhit</span><span class="p">())</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">_getch</span><span class="p">();</span> <span class="k">if</span> <span class="p">((</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'2'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'w'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'8'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'s'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'4'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'a'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'6'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">'d'</span><span class="p">))</span> <span class="n">startFlag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span> <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="cm">/* main function */</span> <span class="p">{</span> <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"是否修改设置（修改输入“y”,否则按任意键）：</span><span class="se">\n</span><span class="s">Edit the game setting or not ? (Press 'y' to edit, or press another key to go on:)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="n">_getch</span><span class="p">()</span> <span class="o">==</span> <span class="sc">'y'</span><span class="p">)</span> <span class="p">{</span> <span class="n">GetSet</span><span class="p">();</span> <span class="p">}</span> <span class="n">StartView</span><span class="p">();</span> <span class="cm">/* an animation before game start */</span> <span class="n">StartGame</span><span class="p">();</span> <span class="n">printf</span><span class="p">(</span><span class="s">"Game Over !!!</span><span class="se">\n</span><span class="s">游戏结束，按任意键继续：</span><span class="se">\n</span><span class="s">(Press any key to restart: )</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="n">_getch</span><span class="p">();</span> <span class="n">overFlag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* restart the game by the flag */</span> <span class="n">system</span><span class="p">(</span><span class="s">"cls"</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> </code></pre></div></div> <p>有更简单的算法欢迎评论指正！</p> <h1 id="返回顶部">返回<a href="#home">顶部</a></h1> Tue, 24 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/24/c-gluttonous-snake Kali Linux之软件安装、卸载、更新和修改更新源 https://knightyun.github.io/2018/04/21/linux-sources-list <p>使用Linux系统，与Windows系统一样，也需要及时进行软件与系统的更新。</p> <h2 id="软件">软件</h2> <p>这里以 <a href="https://blog.csdn.net/knigh_yun/article/details/79949512">Kali Linux</a> 系统为例，介绍常用的软件安装、卸载与更新命令：</p> <h2 id="软件安装">软件安装</h2> <p>安装前先搜索一下更新源中是否有该软件，这里使用 <code class="highlighter-rouge">apt</code> 命令，貌似比另外一个类似的命令 <code class="highlighter-rouge">apt-get</code> 友好一些。</p> <p>例如安装 <code class="highlighter-rouge">leafpad</code> 这个软件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt search leafpad </code></pre></div></div> <p>然后安装这个软件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt install leafpad </code></pre></div></div> <p>然后确定安装就行了。</p> <blockquote> <p>有时会出现一些 <code class="highlighter-rouge">failed</code> 可以按照提示使用命令 <code class="highlighter-rouge">apt install --fix-missing</code> 修复。</p> </blockquote> <h2 id="软件卸载">软件卸载</h2> <p>简单卸载软件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt remove leafpad </code></pre></div></div> <p>卸载软件并移除配置文件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get purge leafpad </code></pre></div></div> <p>卸载自动安装并且未使用的软件</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt autoremove </code></pre></div></div> <h2 id="软件更新">软件更新</h2> <p>先更新一下源：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt update </code></pre></div></div> <blockquote> <p>这个操作并没有开始更新软件，类似于将远程源中的最新版本信息更新到本地</p> </blockquote> <p>接下来才开始更新软件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt upgrade </code></pre></div></div> <p>更新系统：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt full-upgrade </code></pre></div></div> <p>或者：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get dist-upgrade </code></pre></div></div> <p>清理安装包：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get clean apt-get autoclean </code></pre></div></div> <h2 id="更新源">更新源</h2> <p>Linux 更新源文件位于 <code class="highlighter-rouge">/etc/apt/sources.list</code> ，系统就是从这个文件中读取一些网址参数下载安装软件，默认的是 kali 官方源，我们可以修改为国内一些较快的源，例如阿里、中科大、网易等，加快下载速度。</p> <p>找到并编辑上述 <code class="highlighter-rouge">sources.list</code> 源文件，替换为以下内容：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#aliyun 阿里云</span> deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib <span class="c"># ustc 中科大</span> deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib <span class="c">#deb http://mirrors.ustc.edu.cn/kali-security kali-current/updates main contrib non-free</span> <span class="c">#deb-src http://mirrors.ustc.edu.cn/kali-security kali-current/updates main contrib non-free</span> <span class="c"># kali 官方源</span> deb http://http.kali.org/kali kali-rolling main non-free contrib deb-src http://http.kali.org/kali kali-rolling main non-free contrib <span class="c"># 默认的，可以注释掉不用管</span> <span class="c">#deb http://security.kali.org/kali-security kali-rolling/updates main contrib non-free</span> <span class="c">#deb-src http://security.kali.org/kali-security kali-rolling/updates main contrib non-free</span> </code></pre></div></div> <p>以上是目前加快的，也可以百度一下增加其它源</p> <hr /> Sat, 21 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/21/linux-sources-list Linux初识之Kali Linux系统安装详细教程（虚拟机） https://knightyun.github.io/2018/04/15/kali-linux-install <h1 id="目录-">目录 <span id="home"></span></h1> <ul> <li><a href="#1">一、Kali Linux 介绍</a> <ul> <li><a href="#1.1">1、Linux</a></li> <li><a href="#1.2">2、Kali</a></li> </ul> </li> <li><a href="#2">二、虚拟机安装与配置</a> <ul> <li><a href="#2.1">1、下载</a></li> <li><a href="#2.2">2、安装配置</a></li> </ul> </li> <li><a href="#3">三、Kali系统安装与配置</a></li> </ul> <hr /> <h1 id="一kali-linux-介绍-">一、Kali Linux 介绍 <span id="1"></span></h1> <h2 id="1linux-">1、Linux <span id="1.1"></span></h2> <p><img src="https://i.loli.net/2018/04/15/5ad333eb8df19.jpg" alt="timg2.jpg" /> 引用一下<a href="https://baike.baidu.com/item/linux/27050?fr=aladdin">百度百科</a>： Linux是一套免费使用和自由传播的类Unix操作系统，是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统。它能运行主要的UNIX工具软件、应用程序和网络协议。它支持32位和64位硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统。</p> <p>Linux有多个发行版本，以下是<a href="https://www.linux.org/">官网</a>提供下载的一些版本：</p> <hr /> <p><img src="https://i.loli.net/2018/04/15/5ad33ed9a2cb8.jpg" alt="20180415140406753.jpg" /></p> <hr /> <h2 id="2kali-">2、Kali <span id="1.2"></span></h2> <p><img src="https://i.loli.net/2018/04/15/5ad3332fef322.jpg" alt="timg.jpg" /></p> <p>kali是linux其中一个发行版，基于Debian，前身是BackTrack（简称BT系统）。kali系统内置大量渗透测试软件，黑客工具箱已不足以形容它，可以说是巨大的渗透系统，涵盖了多个领域，如无线网络、数字取证、服务器、密码、系统漏洞等等，知名软件有：wireshark、aircrack-ng、nmap、hashcat、metasploit-framework(msf)。</p> <h1 id="二虚拟机软安装与配置-">二、虚拟机软安装与配置 <span id="2"></span></h1> <h2 id="1下载-">1、下载 <span id="2.1"></span></h2> <p>这里将详细介绍在Windows虚拟机中安装kali linux，使用的虚拟机软件是 <strong>VMware</strong>，可以去<a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">官网下载</a>最新版本，<strong>注意：</strong> VMware 10.0版本之后只支持<strong>64位</strong>系统，如果是32位系统用户需要下载10.0及之前的版本。 然后下载发型版的kali linux，<a href="https://www.kali.org/downloads/">官网下载</a>，根据自己情况选择下载32位或64位，完整版或者轻便版，这里我下载的64位完整版。</p> <h2 id="1安装配置-">1、安装配置 <span id="2.2"></span></h2> <p>接下来一步步安装： <img src="https://i.loli.net/2018/04/15/5ad33ed9b4f7a.jpg" alt="20180415144118372.jpg" /> 选择安装位置，注意保证空间充足： <img src="https://i.loli.net/2018/04/15/5ad33ed9b13c4.jpg" alt="20180415144303213.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad33ed9afe91.jpg" alt="20180415144404353.jpg" /></p> <p>等待安装完成： <img src="https://i.loli.net/2018/04/15/5ad33ed9b279d.jpg" alt="20180415144453641.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad33ed9b7ebf.jpg" alt="20180415144527264.jpg" /></p> <p>这是试用版本，需要购买密钥，鼓励购买正版，蛮穷的可以使用以下任一密钥：</p> <blockquote> <p>FF31K-AHZD1-H8ETZ-8WWEZ-WUUVA</p> <blockquote> <p>CV7T2-6WY5Q-48EWP-ZXY7X-QGUWD</p> </blockquote> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad33ed9ae9ca.jpg" alt="20180415144552593.jpg" /></p> <p>安装完成，然后新建虚拟机： <img src="https://i.loli.net/2018/04/15/5ad33ed9b66b3.jpg" alt="20180415144927247.jpg" /></p> <p>选择推荐的即可： <img src="https://i.loli.net/2018/04/15/5ad33ed9b3abd.jpg" alt="20180415145002833.jpg" /></p> <p>这里选择安装程序映像文件，浏览选择刚才下载的kali linux文件，后缀是 <code class="highlighter-rouge">.iso</code>： <img src="https://i.loli.net/2018/04/15/5ad33ed9b9401.jpg" alt="20180415145126392.jpg" /></p> <p>选择操作系统“linux”，版本是“Debian”： <img src="https://i.loli.net/2018/04/15/5ad33f949f756.jpg" alt="20180415145812273.jpg" /></p> <p>名称随便取，然后选择虚拟机文件存放位置：</p> <blockquote> <p><strong>注意选择合适位置，这里需要存放几十G的虚拟磁盘文件</strong></p> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad33f94a5c83.jpg" alt="20180415145936586.jpg" /></p> <p>设置虚拟磁盘的大小，一般不能低于默认值，下面一般选择单个文件，方便： <img src="https://i.loli.net/2018/04/15/5ad33f94b523f.jpg" alt="20180415150112131.jpg" /></p> <p>新建完成，硬件可以之后自定义： <img src="https://i.loli.net/2018/04/15/5ad33f94b3b28.jpg" alt="20180415150311408.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad33f94e3f6e.jpg" alt="20180415150339668.jpg" /></p> <p>觉得默认配置不合适可以自定义调整，例如修改内存大小，增加磁盘： <img src="https://i.loli.net/2018/04/15/5ad33f9503b03.jpg" alt="20180415150430194.jpg" /></p> <p>设置网络适配器模式，可以桥接物理网络（例如电脑连接wifi，虚拟机就和电脑连接同一个wifi），或者NAT模式（类似于电脑成为一个路由器，虚拟机连接电脑的热点），如果不想联网，只用于物理机和虚拟机之间的交流，可以选择主机模式： <img src="https://i.loli.net/2018/04/15/5ad33f94f1e46.jpg" alt="20180415150747931.jpg" /></p> <p>虚拟机配置完成，接下来开始安装 kali 系统。</p> <h1 id="三kali系统安装与配置-">三、Kali系统安装与配置 <span id="3"></span></h1> <p>点击启动虚拟机： <img src="https://i.loli.net/2018/04/15/5ad33f94edca2.jpg" alt="20180415152337260.jpg" /></p> <p>鼠标点击安装界面，之后用键盘方向键和Enter键操作：</p> <blockquote> <p><code class="highlighter-rouge">Live</code> 开头的不是系统安装，类似于Windows PE，用于恢复系统，其他选项可以不用管，也暂时用不着。 <strong>这里我们选择简单的图形化安装</strong> <code class="highlighter-rouge">Graphical install</code> 此时鼠标无法操作，退出虚拟机操作界面使用 <code class="highlighter-rouge">ctrl + alt</code> 键。</p> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad33f94d2cb9.jpg" alt="2018041515321839.jpg" /></p> <p>选择简体中文： <img src="https://i.loli.net/2018/04/15/5ad33f94eae89.jpg" alt="20180415153852638.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad3403ff0501.jpg" alt="20180415153941517.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad340400b3b8.jpg" alt="20180415154023144.jpg" /></p> <p>等待配置一会： <img src="https://i.loli.net/2018/04/15/5ad3404025f68.jpg" alt="20180415154326948.jpg" /></p> <p>设置主机名称，和Windows的主机名一样： <img src="https://i.loli.net/2018/04/15/5ad3404034393.jpg" alt="20180415154445426.jpg" /></p> <p>可以暂时不用输入： <img src="https://i.loli.net/2018/04/15/5ad34040359fa.jpg" alt="2018041515470772.jpg" /></p> <p>设置用户密码登录： <img src="https://i.loli.net/2018/04/15/5ad340404446a.jpg" alt="20180415154826476.jpg" /></p> <p>等待配置： <img src="https://i.loli.net/2018/04/15/5ad34040310fe.jpg" alt="20180415154926766.jpg" /></p> <p>可以选择使用整个磁盘： <img src="https://i.loli.net/2018/04/15/5ad3404040f96.jpg" alt="20180415155254743.jpg" /></p> <hr /> <p><strong>注：</strong> 这里简单介绍一下里面的 <code class="highlighter-rouge">LVM</code> 选项： 详见<a href="https://baike.baidu.com/item/LVM/6571177?fr=aladdin">百度百科</a>，LVM是 Logical Volume Manager（逻辑卷管理）的简写，它是Linux环境下对磁盘分区进行管理的一种机制。安装Linux时常出现的一个问题就是合理分区，根据使用情况设置 <code class="highlighter-rouge">/boot</code>, <code class="highlighter-rouge">/var</code>, <code class="highlighter-rouge">/home</code> 等区块的大小，设置好之后再想要改变就很麻烦，要用分区工具压缩一部分的空闲区出去，然后合并到空间不足的区域。</p> <p>个人对LVM的理解是，它类似于使用一种<strong>文件夹</strong>的机制，直接使用整块磁盘，把每个分区设置成一种类似文件夹的存在，因为文件夹不会限制大小，因此就能动态调整各区的大小，方便管理。</p> <hr /> <p>继续： <img src="https://i.loli.net/2018/04/15/5ad340403f668.jpg" alt="20180415160939891.jpg" /></p> <p>可以使用推荐的： <img src="https://i.loli.net/2018/04/15/5ad34040429bb.jpg" alt="201804151610212.jpg" /></p> <p>确定分配，或者更改区块大小和新增区块： <img src="https://i.loli.net/2018/04/15/5ad3432baa37c.jpg" alt="20180415161246873.jpg" /></p> <p>确认写入： <img src="https://i.loli.net/2018/04/15/5ad3432b9fe9b.jpg" alt="20180415161357309.jpg" /></p> <p>接下来安装时间有点长，喝杯茶休息一下 -_- <img src="https://i.loli.net/2018/04/15/5ad3432b8d7ed.jpg" alt="20180415161452740.jpg" /></p> <p>终于安装完成，半小时安静的过去了…… 这里选择不使用网络镜像： <img src="https://i.loli.net/2018/04/15/5ad3432b91756.jpg" alt="20180415164804954.jpg" /></p> <p>配置GRUB： <img src="https://i.loli.net/2018/04/15/5ad3432ba8703.jpg" alt="20180415165316774.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad3432ba4ff0.jpg" alt="20180415165336903.jpg" /></p> <p>安装完成： <img src="https://i.loli.net/2018/04/15/5ad343e7d33a7.jpg" alt="20180415165446531.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad343e7cbddf.jpg" alt="20180415165502624.jpg" /></p> <p>选择启动，第二个选项是恢复模式： <img src="https://i.loli.net/2018/04/15/5ad343e7d9d87.jpg" alt="20180415175203402.jpg" /></p> <p>初始用户名是 <strong>root</strong>： <img src="https://i.loli.net/2018/04/15/5ad343e7d0471.jpg" alt="2018041517561331.jpg" /></p> <p>之前设置的密码： <img src="https://i.loli.net/2018/04/15/5ad343e7d1c6b.jpg" alt="20180415185003860.jpg" /></p> <p>到此kali系统就安装完毕了： <img src="https://i.loli.net/2018/04/15/5ad343e7e0f5c.jpg" alt="20180415185053453.jpg" /></p> <p>内置大量软件，更多功能可以自行发掘： <img src="https://i.loli.net/2018/04/15/5ad343e7f2511.jpg" alt="20180415185744699.jpg" /></p> <p><img src="https://i.loli.net/2018/04/15/5ad343e7ef4bf.jpg" alt="20180415185813698.jpg" /></p> <h1 id="返回顶部">返回<a href="#home">顶部</a></h1> <hr /> Sun, 15 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/15/kali-linux-install C语言自增自减运算辨析 https://knightyun.github.io/2018/04/10/c-self-plus <p>c语言中，自增(++)和自减(–)运算是很有c语言“感觉”的一种运算符，但是在实际编写中，尤其对初学者或者很久没接触它的，会对它的原理和运算结果产生混淆，接下来做详细辨析。</p> <h1 id="自增运算">自增运算（++）</h1> <p>语法为：<code class="highlighter-rouge">a++</code>，其结果与：<code class="highlighter-rouge">a = a + 1</code> 一样，也和：<code class="highlighter-rouge">a += 1</code> 一样，作用很明显，方便阅读，减小代码量。例如下面的例子，就能看出明显的效果了：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="p">))</span><span class="o">=</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/*简化后*/</span> <span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="p">))</span><span class="o">++</span><span class="p">;</span> </code></pre></div></div> <h2 id="辨析">辨析</h2> <p>自增也可以表示为 <code class="highlighter-rouge">++a</code>， <strong>它们都能把a 的值加 1</strong>，但是两个<strong>表达式的值</strong>却不同，用一个例子说明：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">;</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">++</span><span class="p">;</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">++</span><span class="n">b</span><span class="p">;</span> <span class="n">printf</span><span class="p">(</span><span class="s">"a = %d, b = %d, a2 = %d, b2 = %d"</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>输出结果为：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a = 2, b = 2, a2 = 1, b2 = 2 </code></pre></div></div> <p>其实，<code class="highlighter-rouge">a++</code> 的值为 <code class="highlighter-rouge">a</code> 本身，<code class="highlighter-rouge">++a</code> 的值为 <code class="highlighter-rouge">a+1</code> 后的值。</p> <blockquote> <p><strong>也可以按教科书那种记：</strong></p> <blockquote> <p><strong><code class="highlighter-rouge">b = a++</code> 是先赋值后运算，即先 <code class="highlighter-rouge">b=a</code>，然后 <code class="highlighter-rouge">a++</code>。</strong> <strong><code class="highlighter-rouge">b = ++a</code> 是先运算后赋值，即先 <code class="highlighter-rouge">++a</code>，然后 <code class="highlighter-rouge">++a</code>。</strong></p> </blockquote> </blockquote> <h1 id="自减运算">自减运算</h1> <p>自减运算原理和辨析与上面自增运算相似，<code class="highlighter-rouge">a--</code> 等于 <code class="highlighter-rouge">a = a -1</code> ，表达式 <code class="highlighter-rouge">a--</code> 的值为 <code class="highlighter-rouge">a</code> ，表达式 <code class="highlighter-rouge">--a</code> 的值为 <code class="highlighter-rouge">a-1</code>。</p> Tue, 10 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/10/c-self-plus 递归函数之阶乘的实现 https://knightyun.github.io/2018/04/06/recursion-factorial <h1 id="定义">定义</h1> <p>在编程中函数有一个神奇又难理解的功能，就是递归。递归就是在一个过程中要调用上一步或上几步的结果，使用递归过程的函数就叫递归函数。简单说就是函数自身调用自身（听着有点反自然，像自己举起自己）。</p> <h1 id="递归实例">递归实例</h1> <p>除了数学的复杂运算中，生活中也有不少递归的实例：</p> <h2 id="德罗斯特效应">德罗斯特效应</h2> <p>德罗斯特效应（Droste effect）是递归的一种视觉形式，即一张图片中的某部分与整张图片相同，如下： <img src="https://i.loli.net/2018/04/15/5ad3565ad7935.jpg" alt="20180406205325252.jpg" /></p> <hr /> <p><img src="https://i.loli.net/2018/04/15/5ad3565b03bca.jpg" alt="20180406205355939.jpg" /></p> <hr /> <p><img src="https://i.loli.net/2018/04/15/5ad3565b0245f.jpg" alt="20180406205418499.jpg" /></p> <hr /> <blockquote> <p>别晕、别晕 -_-</p> </blockquote> <p>或者在自己身前和身后都放一面镜子，深刻体会一会儿 ▄︻┻┳══━一</p> <h1 id="递归实现">递归实现</h1> <p>接下来就用C语言递归函数来实现阶乘功能，源码如下：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">factorial</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="cm">/*外部定义阶乘函数*/</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">m</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="cm">/*注意要给函数设置一个递归结束条件*/</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"输入错误！"</span><span class="p">);</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="cm">/*调用函数factorial()自身*/</span> <span class="p">}</span> <span class="k">return</span> <span class="n">m</span><span class="p">;</span> <span class="p">}</span> <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="p">}</span> </code></pre></div></div> <p>这是程序大概的运算过程： <img src="https://i.loli.net/2018/04/15/5ad3565b00bba.jpg" alt="20180406220517224.jpg" /></p> <hr /> <blockquote> <p><strong>这里要注意给函数设置一个递归结束条件，可以是 if 判断句，不然函数就无限调用自身下去了，你之前看着镜子中的镜子中的……自己都晕，程序自然是崩溃了</strong></p> </blockquote> Fri, 06 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/06/recursion-factorial 位运算符与位运算 https://knightyun.github.io/2018/04/06/bit-operation <h1 id="目录-">目录 <span id="home"></span></h1> <ul> <li><a href="#1">概述</a></li> <li><a href="#2">按位与</a></li> <li><a href="#3">按位或</a></li> <li><a href="#4">按位异或</a> <ul> <li><a href="#4.1">简单应用</a> * <a href="#4.1.1">交换变量值</a> * <a href="#4.1.2">简单加密</a></li> </ul> </li> <li><a href="#5">按位取反</a></li> <li><a href="#6">移位运算</a> <ul> <li><a href="#6.1">左移位</a></li> <li><a href="#6.2">右移位</a></li> </ul> </li> <li><a href="#7">复合赋值符</a></li> </ul> <h1 id="一概述-">一、概述 <span id="1"></span></h1> <p>程序中的所有数在计算机内存中都是以二进制的形式储存的。除了常见的<strong>算术运算符</strong>：<code class="highlighter-rouge">+ - * / %</code>，还有<strong>位运算</strong>：<code class="highlighter-rouge">&amp; | ^ ~ &gt;&gt; &lt;&lt;</code>，就是直接对整数在内存中的二进制位进行操作。接下来以C语言为例介绍，其它语言大同小异。</p> <h1 id="二按位与">二、按位与（&amp;）<span id="2"></span></h1> <p>又叫 <code class="highlighter-rouge">and</code> 运算，用符号 <code class="highlighter-rouge">&amp;</code> 表示，计算方式如下：</p> <p><code class="highlighter-rouge">1 &amp; 1 = 1</code> , <code class="highlighter-rouge">0 &amp; 1 = 0</code> , ` 0 &amp; 0 = 0`</p> <p>布尔类型中，<code class="highlighter-rouge">1</code> 表示真，<code class="highlighter-rouge">0</code> 表示假，所以可以用高中数学那句话来记：<strong><code class="highlighter-rouge">同真为真，一假为假</code></strong>。</p> <p>举个例子：<code class="highlighter-rouge">3 &amp; 5 = 1</code> ，运算过程如下：</p> <pre> 0 1 1 ---&gt; 3 &amp; 1 0 1 ---&gt; 5 -------- 0 0 1 ---&gt; 1 </pre> <h1 id="三按位或-">三、按位或 （|）<span id="3"></span></h1> <p>又叫 <code class="highlighter-rouge">or</code> 运算，用符号 <code class="highlighter-rouge">|</code> 表示，运算方式：</p> <p><code class="highlighter-rouge">1 | 1 = 1</code> , <code class="highlighter-rouge">1 | 0 = 1</code> , <code class="highlighter-rouge">0 | 0 = 0</code></p> <p>记为：<strong><code class="highlighter-rouge">一真为真，同假为假</code></strong></p> <p>举例：<code class="highlighter-rouge">3 | 5 = 7</code> , 运算过程：</p> <pre> 0 1 1 ---&gt; 3 | 1 0 1 ---&gt; 5 -------- 1 1 1 ---&gt; 7 </pre> <h1 id="四按位异或">四、按位异或（^）<span id="4"></span></h1> <p>又叫 <code class="highlighter-rouge">xor</code> 运算，用符号 <code class="highlighter-rouge">^</code> 表示，注意这里不是数学表达里面的<strong>次方</strong>的意思，运算方式：</p> <p><code class="highlighter-rouge">1 ^ 1 = 0</code> , ` 1 ^ 0 = 1<code class="highlighter-rouge"> , </code>0 ^ 0 = 0`</p> <p>这种运算也较为特殊，记为：<strong><code class="highlighter-rouge">同为假，异为真</code></strong> 举例：<code class="highlighter-rouge">3 ^ 5 = 6</code> , 运算过程：</p> <pre> 0 1 1 ---&gt; 3 ^ 1 0 1 ---&gt; 5 --------- 1 1 0 ---&gt; 6 </pre> <h2 id="简单应用-">简单应用 <span id="4.1"></span></h2> <h3 id="1交换变量值-">1、交换变量值 <span id="4.1.1"></span></h3> <p>异或运算有如下特性：</p> <p><code class="highlighter-rouge">a ^ b ^a = b</code> , <code class="highlighter-rouge">a ^ b ^ b =a</code></p> <p>因此可以用于程序中的变量值交换，C语言中，我们可能经常这样交换变量值：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="kt">int</span> <span class="n">temp</span><span class="p">;</span> <span class="cm">/*定义一个临时变量用于交换方便*/</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span> <span class="n">printf</span><span class="p">(</span><span class="s">"a = %d, b = %d"</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="cm">/*输出结果为：a = 5, b = 3 实现了变量值的交换*/</span> <span class="p">}</span> </code></pre></div></div> <p>但是以后我们可以这样实现：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">a</span> <span class="o">^=</span> <span class="n">b</span><span class="p">;</span> <span class="cm">/*等同于：a = a ^ b 之后会讲*/</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">;</span> <span class="cm">/*这时 a ^ b 等于 原来 a 的值*/</span> <span class="n">a</span> <span class="o">^=</span> <span class="n">b</span><span class="p">;</span> <span class="cm">/*a = a ^ b*/</span> <span class="n">printf</span><span class="p">(</span><span class="s">"a = %d, b = %d"</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <blockquote> <p><strong>a, b 为负数时同样适用，但位运算只适用于整型，浮点数不可用</strong></p> </blockquote> <h3 id="2简单加密-">2、简单加密 <span id="4.1.2"></span></h3> <p>例如，你想传输一条信息给Ta，信息为：<code class="highlighter-rouge">5201314</code> ，密码为：<code class="highlighter-rouge">1998</code> ，使用如下代码加密：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5201314 ^ 1998 </code></pre></div></div> <p>结果为 <code class="highlighter-rouge">5200492</code>，想要查看原信息，使用密码查看：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5200492 ^ 1998 这样就生成了原数字：`5201314`. </code></pre></div></div> <h1 id="五按位取反">五、按位取反（~）<span id="5"></span></h1> <p>又叫 <code class="highlighter-rouge">not</code> 运算，即将二进制位中 <code class="highlighter-rouge">0</code> 和 <code class="highlighter-rouge">1</code> 全部取反，运算方式为：</p> <p><code class="highlighter-rouge">~ 1 = 0</code> , <code class="highlighter-rouge">~ 0 = 1</code></p> <p>记为：<strong><code class="highlighter-rouge">0 变 1，1 变 0</code></strong></p> <p>举例：<code class="highlighter-rouge">~5 = -6</code>, 运算过程：</p> <pre> ~ 00000000 00000000 00000000 00000101 ---&gt; 5 --------------------------------------- 11111111 11111111 11111111 11111010 ---&gt; -6 </pre> <blockquote> <p><strong>注意变量如果定义是无符号短整型 <code class="highlighter-rouge">unsigned short</code> ， <code class="highlighter-rouge">~5</code> 将不再是 <code class="highlighter-rouge">-6</code> ，而是 <code class="highlighter-rouge">65530</code></strong>。 <strong>还有一个规律是正整数取反后结果是原数加一后取相反数，负数一样</strong>。 <strong>还要注意不要和逻辑运算符 <code class="highlighter-rouge">!</code> 搞混，<code class="highlighter-rouge">! 1 = 0</code> , <code class="highlighter-rouge">! 1234 = 0</code> , <code class="highlighter-rouge">! 0 = 1</code></strong>，即只有 <code class="highlighter-rouge">真(1)</code> 与<code class="highlighter-rouge">假(0)</code> 两种。</p> </blockquote> <h1 id="六移位运算-">六、移位运算 <span id="6"></span></h1> <p>顾名思义，移位即将数据的二进制数进行向左或向右平移一定的位数，然后得到新的数据，移位分为左移位和右移位。</p> <h2 id="1左移位">1、左移位（«）<span id="6.1"></span></h2> <p>将数据的转换为二进制，所有位向左平移，高位（左端）舍弃，低位（右端）空位补 <code class="highlighter-rouge">0</code>，格式为：</p> <p><code class="highlighter-rouge">需要移位的数据 &lt;&lt; 需要移动的位数</code></p> <p>举例：<code class="highlighter-rouge">5 &lt;&lt; 2 =20</code> ，运算过程：</p> <pre> 00000000 00000000 00000000 00000101 ---&gt; 5 ------------------------------------- 00000000 00000000 00000000 00010100 ---&gt; 20 </pre> <blockquote> <p><strong>右移位的数学意义是，原数左移 n 位，相当于原数乘以 2 的 n 次方</strong></p> </blockquote> <h2 id="2右移位-">2、右移位 <span id="6.2"></span></h2> <p>将数据的二进制所有位向右移位，低位舍弃，高位补 <code class="highlighter-rouge">0</code>（负数补 <code class="highlighter-rouge">1</code>），格式：</p> <p><code class="highlighter-rouge">需要移位的数据 &gt;&gt; 需要移动的位数</code></p> <p>举例：<code class="highlighter-rouge">5 &gt;&gt; 2 = 1</code>，运算过程：</p> <pre> 00000000 00000000 00000000 00000101 ---&gt; 5 ------------------------------------- 00000000 00000000 00000000 00000001 ---&gt; 1 </pre> <p>负数情况：<code class="highlighter-rouge">-6 &gt;&gt; 2 = -2</code>，运算过程：</p> <pre> 11111111 11111111 11111111 11111010 ---&gt; -6 ------------------------------------- 11111111 11111111 11111111 11111110 ---&gt; -2 </pre> <blockquote> <p><strong>右移位的数学意义是，相当于原数除以 2 的 n 次方</strong></p> </blockquote> <h1 id="七复合赋值符-">七、复合赋值符 <span id="7"></span></h1> <p>算术运算中有复合赋值符：<code class="highlighter-rouge">+= -+ *= /= %=</code>，位运算也有对应的复合赋值：<code class="highlighter-rouge">&amp;= |= ^= &gt;&gt;= &lt;&lt;= </code>（注意没有 <code class="highlighter-rouge">~=</code> ），运算一样：</p> <p><code class="highlighter-rouge">a &amp;= b</code> 等价于 <code class="highlighter-rouge">a = a &amp; b</code></p> <p>以此类推</p> <hr /> <h1 id="返回顶部">返回<a href="#home">顶部</a></h1> Fri, 06 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/06/bit-operation 十进制负数的二进制表示法 https://knightyun.github.io/2018/04/04/negative-binary <p>十进制转正整数转二进制应该都会，用C语言代码简单表示算法：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">dec</span><span class="o">=</span><span class="mi">65535</span><span class="p">;</span> <span class="cm">/*positive decimalism number to binary number*/</span> <span class="kt">int</span> <span class="n">bin</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span> <span class="k">while</span> <span class="p">(</span><span class="n">dec</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">dec</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span> <span class="n">dec</span><span class="o">/=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="n">bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">dec</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span> <span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span> <span class="cm">/*print binary number*/</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="n">bin</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>当然也有另外一种简单转换方法：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">dec</span><span class="o">=</span><span class="mi">65535</span><span class="p">;</span> <span class="kt">char</span> <span class="n">bin</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="n">itoa</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span><span class="n">bin</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="cm">/*整型转换为字符串的函数，第一个参数是整型变量， 第二个是字符数组，用于存放字符串，第三个是进制，“2” 表示输出的字符串的进制格式， 可以这样记函数：“int to arr” */</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">bin</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <p>但是，十进制负整数转换为二进制稍微复杂一些，分为三步：</p> <h1 id="一原码">一、原码</h1> <p>例如一个十进制数 5，二进制原码表示为：</p> <p><code class="highlighter-rouge">00000000 00000000 00000000 00000101</code></p> <p>大小为 4 字节，每一个 <code class="highlighter-rouge">0</code> 或 <code class="highlighter-rouge">1</code> 表示一个比特位(bit)，所以八位为一字节，好像32位和64位系统都这样。一字节用十进制整数表示大小则是：2的8次方（256）。 表示为十六进制是这样：<code class="highlighter-rouge">ff ff ff ff</code>（f=2^4-1）</p> <h1 id="二反码">二、反码</h1> <p>将二进制原码每一位取反，就是 <code class="highlighter-rouge">0</code> 变 <code class="highlighter-rouge">1</code> ，<code class="highlighter-rouge">1</code> 变 <code class="highlighter-rouge">0</code>。 上面 5 的反码表示为这样：</p> <p><code class="highlighter-rouge">11111111 11111111 11111111 11111010</code></p> <h1 id="三补码">三、补码</h1> <p>将反码最低位加 <code class="highlighter-rouge">1</code> 叫做补码，那么 5 的补码表示为：</p> <p><code class="highlighter-rouge">11111111 11111111 11111111 11111011</code></p> <p><strong>注意反码末位是 <code class="highlighter-rouge">1</code> 时记得进位。</strong></p> <p>所以十进制数 <code class="highlighter-rouge">-5</code> 的二进制表示为：</p> <p><code class="highlighter-rouge">11111111 11111111 11111111 11111011</code></p> <p>所以 -1 在计算机中表示为全 <code class="highlighter-rouge">1</code>，就是：</p> <p><code class="highlighter-rouge">11111111 11111111 11111111 11111111</code></p> <p>我64位计算机中是这样的：</p> <p><img src="https://i.loli.net/2018/04/15/5ad3575f46acf.jpg" alt="20180404111248861.jpg" /></p> Wed, 04 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/04/negative-binary 搭建Github Pages个人博客网站 https://knightyun.github.io/2018/04/01/github-pages-blog <h1 id="目录-">目录 <span id="home"></span></h1> <ul> <li><a href="#1">引言</a> <ul> <li><a href="#1.1">关于博客</a></li> <li><a href="#1.2">关于Github</a></li> </ul> </li> <li><a href="#2">创建Github账号</a></li> <li><a href="#3">创建仓库</a> <ul> <li><a href="#3.1">填充仓库</a></li> <li><a href="#3.2">配置Github Pages功能</a></li> </ul> </li> <li><a href="#4">博客的书写与上传</a> <ul> <li><a href="#4.1">Git基础</a></li> <li><a href="#4.2">git配置</a></li> <li><a href="#4.3">git Desktop版</a></li> </ul> </li> <li><a href="#5">创建本地仓库</a></li> <li><a href="#6">安装Jekyll</a> <ul> <li><a href="#6.1">关于Jekyll</a></li> <li><a href="#6.2">安装步骤</a></li> <li><a href="#6.3">开启jekyll</a></li> </ul> </li> <li><a href="#7">写博客与上传</a> <ul> <li><a href="#7.1">Markdown基础</a></li> <li><a href="#7.2">工具介绍</a></li> <li><a href="#7.3">图床介绍</a></li> <li><a href="#7.4">关于图片尺寸</a></li> </ul> </li> <li><a href="#8">域名配置</a></li> </ul> <hr /> <h1 id="引言-">引言 <span id="1"></span></h1> <h2 id="关于博客-">关于博客 <span id="1.1"></span></h2> <p>写博客对于程序猿来说，应该是个优秀的习惯，个人也觉得蛮高大上的 ^_^。网上的博客论坛网站也多种多样，个人觉得在长久以来的不断竞争淘汰中，各大网站的功能等可能都相差无几了，选择自己稍微偏好的就可以了。</p> <p>我的个人情况就是结合CSDN博客和Github Pages的独立个人博客网页，因为听说拥有自己的Github主页也是一件蛮高大上的事 -_- 。</p> <h2 id="关于github-">关于Github <span id="1.2"></span></h2> <p>然后简单介绍一下Github以及其Github Pages功能。</p> <p>GitHub是一个面向开源及私有软件项目的托管平台，也是一个分布式版本控制系统，详情见<a href="(https://baike.baidu.com/item/github/10145341)">百度百科</a>。说到分布式，自然也有另外一种集中式版本控制系统：SVN，有兴趣小伙伴可以了解<a href="https://baike.baidu.com/item/SVN/3311103?fr=aladdin">百度百科</a>。GIt是SVN的发展版，而且现在主流也是GIt，但某些大公司依然在使用SVN，二者各有优劣，自行体会，此处不做详解，用一张图简单说明：</p> <hr /> <p><img src="https://i.loli.net/2018/04/15/5ad359a34859f.png" alt="20180331184953574.png" /></p> <hr /> <p>GIthub Pages则是github上的一项功能，可以放置网页文件到指定文件夹，然后给你一个专属域名用于展示一些项目，但现在大多用来开发制作个人博客网站。接下来就一步步按照我曾经的步骤来搭建个人博客，顺便讲讲沿途遇到过的坑，如没有的提及请自行百度。</p> <h1 id="创建github账号-">创建Github账号 <span id="2"></span></h1> <p>github pages 功能依赖于github账号，没有的话先去<a href="https://github.com/">官网</a>注册一个：</p> <p><img src="https://i.loli.net/2018/04/15/5ad359e00a5bb.jpg" alt="20180331192629516.jpg" /> 然后好像要邮箱验证，就是填写的那个，点击那个验证链接就注册成功了。</p> <h1 id="创建仓库-">创建仓库 <span id="3"></span></h1> <p>有了自己的账号后，可以跟着官网的引导，创建自己的第一个仓库，就是 <strong>repository</strong>：</p> <p><img src="https://i.loli.net/2018/04/15/5ad359e5dd951.jpg" alt="20180331193717261.jpg" /></p> <hr /> <p>填好信息</p> <p><img src="https://i.loli.net/2018/04/15/5ad359fb3ba18.jpg" alt="20180331195826465.jpg" /></p> <hr /> <p>创建完成</p> <p><img src="https://i.loli.net/2018/04/15/5ad35a03b9186.jpg" alt="20180331200133497.jpg" /></p> <hr /> <p>到这里就创建好了自己的仓库，可以上传文件到这个目录下，接下我们用这个仓库来使用github pages功能。</p> <h2 id="填充仓库-">填充仓库 <span id="3.1"></span></h2> <p>仓库建好了，接下来就是往里面装东西了，就是支撑博客首页的一些网页文件和配置文件，对于新手来说要自己编写这些文件就有点开玩笑了，所以可以选择使用已有的主题，你可以选择复制我的<a href="https://github.com/knightyun/knightyun.github.io">https://github.com/knightyun/knightyun.github.io</a>，然后选择自己仓库，网页基础好的同学以后修改网页内容就行了。</p> <blockquote> <p><strong>嫌修改麻烦可以跳过这一步，到后面的步骤选择喜欢的主题</strong></p> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad35a0cd1ddf.jpg" alt="20180331204755801.jpg" /></p> <hr /> <h2 id="配置github-pages功能-">配置Github Pages功能 <span id="3.2"></span></h2> <p>然后我们来配置github pages</p> <p><img src="https://i.loli.net/2018/04/15/5ad35a1317bee.jpg" alt="20180331200909318.jpg" /></p> <hr /> <p>重命名，注意格式</p> <p><img src="https://i.loli.net/2018/04/15/5ad35a1ac689a.jpg" alt="20180331202913817.jpg" /></p> <hr /> <p>把上面的页面向下滑，现在就可以访问了</p> <p><img src="https://i.loli.net/2018/04/15/5ad35ad3a3f49.jpg" alt="20180331203510375.jpg" /></p> <hr /> <p>当然github也提供了一些主题供选择，点击上面的“choose a theme”按钮进行选择</p> <p><img src="https://i.loli.net/2018/04/15/5ad35ad9ad0e8.jpg" alt="20180331205610766.jpg" /></p> <hr /> <p>这个网站有更多主题工选择：<a href="http://jekyllthemes.org/">http://jekyllthemes.org/</a>，如有选择困难症请绕路 -_-</p> <h1 id="博客的书写与上传-">博客的书写与上传 <span id="4"></span></h1> <h2 id="git基础-">Git基础 <span id="4.1"></span></h2> <p>前面说到向自己的github仓库上传文件，我们使用“git”这个工具，进行拉取、克隆、提交等一系列操作，Linux系统应该是自带，官网下载地址：<a href="https://git-scm.com/">https://git-scm.com/</a>。 并且需要掌握一些git基本操作，如 <code class="highlighter-rouge">git commit</code> , <code class="highlighter-rouge">git push</code>, <code class="highlighter-rouge">git clone</code> 等，这里有很完整的教程：<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000">Git语法说明</a>.</p> <h2 id="git配置-">git配置 <span id="4.2"></span></h2> <ul> <li>安装好后cmd输入 <code class="highlighter-rouge">git</code> 有反应则安装成功：</li> </ul> <p><img src="https://i.loli.net/2018/04/15/5ad35adf42ae1.jpg" alt="20180331215746907.jpg" /></p> <ul> <li>进行如下配置：</li> </ul> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config <span class="nt">--global</span> user.name <span class="s2">"YOUR NAME"</span> git config <span class="nt">--global</span> user.email <span class="s2">"YOUR EMAIL ADDRESS"</span> </code></pre></div></div> <blockquote> <p><strong>NAME 指你的昵称，EMAIL ADDRESS 是你的注册邮箱</strong></p> </blockquote> <ul> <li>然后生成相应的令牌，本地一份，Github 一份，这样 Github 可以在你使用仓库的时候，进行校验确定你的身份。</li> </ul> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/.ssh <span class="nb">mkdir </span>key_backup ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-C</span> <span class="s2">"*your_email@youremail.com*"</span> </code></pre></div></div> <blockquote> <p><strong>注意这里不是在cmd里输入，是使用刚安装的 git bash 软件，可以在电脑菜单里面搜索</strong></p> </blockquote> <p>然后会生成如下两个文件：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35ae510df3.jpg" alt="20180331221012285.jpg" /></p> <p><code class="highlighter-rouge">id_rsa.pub</code> 就是我们待会需要的公钥文件，使用命令 <code class="highlighter-rouge">cat id_rsa.pub</code> 再将内容复制到剪切板，然后进入github账号设置里面粘贴</p> <p><img src="https://i.loli.net/2018/04/15/5ad35aea5e8c2.jpg" alt="20180331221601652.jpg" /></p> <hr /> <p>选择添加SSH key：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35afc4616a.jpg" alt="20180331221949179.jpg" /></p> <hr /> <p>把刚才复制的内容粘贴进去</p> <p><img src="https://i.loli.net/2018/04/15/5ad35afc52683.jpg" alt="20180331222325449.jpg" /></p> <hr /> <p>然后输入 <code class="highlighter-rouge">ssh -T git@github.com</code> 测试连通状态</p> <blockquote> <p><strong>我的Windows版没有成功，不知道Linux是否成功，报错如下 ，应该是windows ssh配置问题</strong></p> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad35b07f16b6.jpg" alt="20180331222821644.jpg" /></p> <h2 id="git-desktop版-">git Desktop版 <span id="4.3"></span></h2> <p>如果你也出现以上状况，不必担心，git还能使用https协议连接，只不过要每次输入账号和密码，但是可以选择github官方提供的git desktop软件：</p> <blockquote> <p><strong>这里我是下载过的</strong></p> </blockquote> <p><img src="https://i.loli.net/2018/04/15/5ad35b2fb62f6.jpg" alt="20180331223500277.jpg" /></p> <hr /> <p>界面如下，需要登录，以后提交文件就方便了，cmd也能使用git提交，不用每次输入密码</p> <p><img src="https://i.loli.net/2018/04/15/5ad35b347f466.jpg" alt="20180331223916609.jpg" /></p> <hr /> <p>可以查看变化文件，甚至文件内变化的内容，commit 后点击 fetch 按钮提交</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c4838fe1.jpg" alt="20180401085504366.jpg" /></p> <blockquote> <p><strong>软件功能不算复杂，自己摸索一会就会了，图形界面的软件使得一些命令行的操作变得容易、友好。</strong></p> </blockquote> <h1 id="创建本地仓库-">创建本地仓库 <span id="5"></span></h1> <p>选择一个本地文件夹，用作保存本地仓库文件，尽量是空文件夹，然后使用命令 <code class="highlighter-rouge">git init</code> 初始化文件夹，其实是在当前文件夹下生成一个叫 <code class="highlighter-rouge">.git</code> 的隐藏文件夹，里面是一些配置文件，不要随意更改。</p> <p>使用 <code class="highlighter-rouge">git clone https://github.com/name/repository.git</code> 将远程仓库克隆到本地此文件夹下， <code class="highlighter-rouge">name</code> 是自己的昵称，<code class="highlighter-rouge">repository</code> 是自己的仓库名，不要忘记末尾的 <strong><code class="highlighter-rouge">.git</code></strong> 后缀。</p> <p>然后此文件夹下会多一个和你仓储名一样的文件夹，内部文件与远程仓库一样。</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c4e8b088.jpg" alt="20180331230145814.jpg" /></p> <p>绑定远程仓库，方便提交：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git remote add origin git@github.com:username/username.github.io.git </code></pre></div></div> <p>介绍几个常用命令：</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add <span class="nb">.</span> <span class="c"># 添加文件</span> git commit <span class="nt">-m</span> <span class="s2">"commit-messages"</span> <span class="c"># 提交本地仓库</span> git push origin master <span class="c"># 提交远程仓库</span> git pull <span class="c"># 拉取远程文件，与以下命令类似</span> git branch temp <span class="c"># 创建本地分支</span> git fetch origin master:temp git merge master </code></pre></div></div> <h1 id="安装jekyll-">安装Jekyll <span id="6"></span></h1> <h2 id="关于jekyll-">关于Jekyll <span id="6.1"></span></h2> <p>Jekyll 是一个简单免费的生成博客网页的框架，Github Pages 功能就是使用的 Jekyll 框架把仓库内的文件生成静态网页给人们浏览，其本来目的是提供给 GitHub 项目“自我介绍”用的，只不过后来陆续有人发现了其博客网站的用途，也就是上面介绍的博客网站，详情参考官网：<a href="https://jekyllrb.com/">https://jekyllrb.com/</a>, 也有一个中文版的：<a href="https://www.jekyll.com.cn/">https://www.jekyll.com.cn/</a> 方便阅读。上面那个主题网站也是jekyll的，还有一个类似的工具叫“hexo”，自行了解。</p> <p>由于上传修改后的文件到 github 仓库后需要一段时间才能看到网页的变化或修改效果，使得对于页面效果和功能的调试不太方便，所以如果选择在本地安装 jekyll 框架开发环境的话，可以快速预览生成效果，方便调试，最后再把成品上传到 GitHub 仓库中就可以得到预期效果了。</p> <h2 id="安装步骤-">安装步骤 <span id="6.2"></span></h2> <ul> <li><strong>安装Ruby</strong>：jekyll依赖于 Ruby 环境，需要提前安装，官网下载链接：<a href="http://www.ruby-lang.org/en/downloads/">http://www.ruby-lang.org/en/downloads/</a>，windows/Linux/Mac 的版本都有。</li> <li><strong>安装gem</strong>：官网链接<a href="https://rubygems.org/pages/download">https://rubygems.org/pages/download</a>，貌似安装 ruby 后自带 gem。 可以 cmd 命令行输入 <code class="highlighter-rouge">gem</code> 检查是否安装成功：</li> </ul> <p><img src="https://i.loli.net/2018/04/15/5ad35c5295bb6.jpg" alt="20180331213445607.jpg" /></p> <ul> <li><strong>安装jekyll</strong>：cmd命令行输入 <code class="highlighter-rouge">gem install jekyll</code></li> </ul> <p><img src="https://i.loli.net/2018/04/15/5ad35c57c50b5.jpg" alt="20180331213739704.jpg" /></p> <h2 id="开启jekyll-">开启jekyll <span id="6.3"></span></h2> <p>直接输入 <code class="highlighter-rouge">jekyll s</code> 开启jekyll服务，windows可能会遇到以下问题：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c5c2c9f1.jpg" alt="20180401085818819.jpg" /></p> <p>使用 <code class="highlighter-rouge">bundle exec jekyll s</code> 命令就可以运行了，如果提示没有安装 <code class="highlighter-rouge">bundler</code> ，就 <code class="highlighter-rouge">gem install bundler</code> 再 <code class="highlighter-rouge">bundle install</code>，可能还会提示没有安装其他组件，记下名称， <code class="highlighter-rouge">gem install xxx</code> 就可以了；</p> <p>然后就可以成功运行了，退出按 <code class="highlighter-rouge">ctrl + c </code> 键：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c5fa50e4.jpg" alt="20180401085938699.jpg" /></p> <p>运行时保持这个窗口不要关闭，浏览器输入 <code class="highlighter-rouge">127.0.0.1:4000</code> 或 <code class="highlighter-rouge">localhost:4000</code> 进行预览，不过我的windows预览效果不太好，加载不出图片，其他系统没试过；</p> <h1 id="写博客与上传-">写博客与上传 <span id="7"></span></h1> <h2 id="markdown基础-">Markdown基础 <span id="7.1"></span></h2> <p>Jekyll使用<a href="https://baike.baidu.com/item/markdown/3245829?fr=aladdin">Markdown</a>语言书写博客，markdown是一种简单易读的标记性语言，不同于 <code class="highlighter-rouge">html</code>，大量的标签不易于阅读，写着也麻烦，用markdown写博客很合适。</p> <p>首先你需要了解一些markdown语法，这里有完整版语法说明：<a href="https://blog.csdn.net/KNIGH_YUN/article/details/79733814">Markdown语法说明</a>，了解一些基础后就可以开始写博客了。</p> <h2 id="工具介绍-">工具介绍 <span id="7.2"></span></h2> <p>这篇文章：<a href="https://blog.csdn.net/KNIGH_YUN/article/details/79718481">Markdown简明语法</a>最后有介绍一些好用的markdown编辑器，自行选择。 不过每次都用编辑器写好 <code class="highlighter-rouge">.md</code> 文件然后用 git 上传到 github 根目录下的 <strong><code class="highlighter-rouge">_post</code></strong> 文件夹好像很繁琐，Jekyll官方提供了一款方便的博客编辑器，方便书写、预览、上传，官网链接：<a href="http://jekyllwriter.com/">http://jekyllwriter.com/</a>，三种系统版本都有。接下来简单介绍一些使用：</p> <p>安装后主界面： <img src="https://i.loli.net/2018/04/15/5ad35c729800f.jpg" alt="20180401093410604.jpg" /></p> <hr /> <p>添加账号 <img src="https://i.loli.net/2018/04/15/5ad35c786326c.jpg" alt="20180401093825352.jpg" /></p> <p>配置 token</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c7dc4e18.jpg" alt="20180401094705731.jpg" /></p> <p>保存后会生成一个 token ，返回软件粘贴进输入框就行了</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c836423d.jpg" alt="20180401094911796.jpg" /></p> <hr /> <p>写完后保存并上传</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c88b1b6f.jpg" alt="20180401094200638.jpg" /></p> <hr /> <p>可以在这里查看和修改账户下的博客</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c8e19921.jpg" alt="2018040109525674.jpg" /></p> <hr /> <p><img src="https://i.loli.net/2018/04/15/5ad35c92b3b2b.jpg" alt="20180401095443179.jpg" /></p> <blockquote> <p><strong>软件其他功能还在完善，自行摸索</strong></p> </blockquote> <h2 id="图床介绍-">图床介绍 <span id="7.3"></span></h2> <p>写博客就无法避免上传图片，图床就是这么一个地方，就是一个网站，你发自己的图片上传到它的网站，然后它给你一个这个图片的链接，插入博客中就能显示图片了。</p> <p>推荐一个知名的，七牛云<a href="https://portal.qiniu.com/">https://portal.qiniu.com/</a>，注册完实名认证后有一些优惠。 还有一个神奇的网站：<a href="https://sm.ms/">https://sm.ms/</a>，也能用</p> <p>然后在 jekyll writer中配置一下：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35c9795b52.jpg" alt="20180401100517435.jpg" /></p> <hr /> <blockquote> <p><strong>当然我用的是CSDN在线编辑器写博客，图片能直接上传到CSDN上，直接生成链接，其工具也能用</strong></p> </blockquote> <h2 id="关于图片尺寸-">关于图片尺寸 <span id="7.4"></span></h2> <p>markdown 的图片插入方式 <code class="highlighter-rouge">![title](http://xxx.com/xxx.png/)</code> 是没办法修改图片尺寸的，可以使用html中的 <code class="highlighter-rouge">&lt;img&gt;</code> 标签： <code class="highlighter-rouge">&lt;img src="http://xxx.com/xxx.png/" alt="title" width=XXpx height=XXpx&gt;</code> <code class="highlighter-rouge">width</code> 和 <code class="highlighter-rouge">height</code> 添加想要的尺寸。</p> <h1 id="域名配置-">域名配置 <span id="8"></span></h1> <p>自己的博客网站就建好了，想要分享出去的小伙伴就要想办法让自己的网页能被百度等搜索引擎搜到，或者这样，百度搜索： <code class="highlighter-rouge">site:name.github.io</code> ，出现错误页面就表示搜不到。</p> <p>很遗憾，百度是禁止抓取 github pages 的内容的，可以购买一个自己的专属域名，有很多选择，阿里云、腾讯、花生壳域名等，百度站长平台有个链接提交功能，但是它只是加速爬取，并未解决收录：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35ca96986d.jpg" alt="20180401103839442.jpg" /></p> <hr /> <p>貌似它们的熊掌号服务可以解决这问题：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35cb06c1c5.jpg" alt="20180401104100873.jpg" /></p> <hr /> <p>然后，就没有然后了 -_-</p> <p><img src="https://i.loli.net/2018/04/15/5ad35cb55c7cd.jpg" alt="20180401104147731.jpg" /></p> <hr /> <p>以花生壳域名为例，其它大同小异，配置一下：</p> <p><img src="https://i.loli.net/2018/04/15/5ad35cb937be5.jpg" alt="20180401102926509.jpg" /></p> <hr /> <p>再添加两条 github 的ip的 A记录值 ：<code class="highlighter-rouge">192.30.252.153</code> <code class="highlighter-rouge">192.30.252.154</code></p> <blockquote> <p>最后搜索: <code class="highlighter-rouge">"site:你的域名"</code> 有结果就成功了</p> </blockquote> <p>开始自己的博客生涯吧。</p> <hr /> <h1 id="返回顶部">返回<a href="#home">顶部</a></h1> Sun, 01 Apr 2018 00:00:00 +0000 https://knightyun.github.io/2018/04/01/github-pages-blog C语言统计素数 https://knightyun.github.io/2018/03/30/c-prime-number <h2 id="源码如下">源码如下：</h2> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 1-1000的素数</span> <span class="n">printf</span><span class="p">(</span><span class="s">"1-1000的素数: </span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">co</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//设置co用于统计个数</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="c1">//遍历1-1000</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="c1">//素数条件：只能被1和自身整除</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//发现不是素数，则跳出本层循环</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="c1">//遍历后，没有除1和自身以外的因数，i==j 表示遍历了 2--自身的所有数并且未发现因数</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span> <span class="n">co</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Total: %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span> <span class="n">co</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <h2 id="运行结果">运行结果：</h2> <pre><code class="language-txt">1-1000的素数: 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463 467 479 487 491 499 503 509 521 523 541 547 557 563 569 571 577 587 593 599 601 607 613 617 619 631 641 643 647 653 659 661 673 677 683 691 701 709 719 727 733 739 743 751 757 761 769 773 787 797 809 811 821 823 827 829 839 853 857 859 863 877 881 883 887 907 911 919 929 937 941 947 953 967 971 977 983 991 997 total: 168 </code></pre> <h2 id="注意">注意</h2> <p>素数，又称质数，即整数在一个大于1的自然数中，除了1和此整数自身外，没法被其他自然数整除的数。将1-1000中每个数都对“2–自身”进行整除，<code class="highlighter-rouge">i==j</code> 说明是对“2–自身”都遍历了一遍并且未发现符合条件的数，而不是前面发现有多余因数的<code class="highlighter-rouge">break;</code></p> <blockquote> <h4 id="另一个优化的版本供参考">另一个优化的版本，供参考：</h4> </blockquote> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; #include&lt;math.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 1-1000的素数</span> <span class="n">printf</span><span class="p">(</span><span class="s">"1-1000的素数: </span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">co</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">printf</span><span class="p">(</span><span class="s">"2 "</span><span class="p">);</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">j</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">//不遍历偶数，除了2偶数都不是质数</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="c1">//实际遍历到此数的平方根就够了，需要引入 &lt;math.h&gt; 头文件</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="c1">//这里也要变一下</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span> <span class="n">co</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">total: %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span> <span class="n">co</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//注意这里要加上“2”这个数，2是质数也是偶数，之前没有遍历</span> <span class="p">}</span> </code></pre></div></div> <p>这样就大大缩短了时间。</p> Fri, 30 Mar 2018 00:00:00 +0000 https://knightyun.github.io/2018/03/30/c-prime-number C语言打印九九乘法表 https://knightyun.github.io/2018/03/30/c-multiply-table <h2 id="源码如下">源码如下：</h2> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//打印九九乘法表</span> <span class="n">printf</span><span class="p">(</span><span class="s">"九九乘法表：</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span> <span class="c1">//初始化打印的两个方向</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="c1">//两层循环嵌套打印输出</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d*%d=%2d "</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">);</span> <span class="c1">//%2d表示固定输出两位</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="c1">//打印到行尾，换行</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"This is the end.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="p">}</span> </code></pre></div></div> <h2 id="输出结果">输出结果：</h2> <pre><code class="language-txt">九九乘法表： 1*1= 1 2*1= 2 2*2= 4 3*1= 3 3*2= 6 3*3= 9 4*1= 4 4*2= 8 4*3=12 4*4=16 5*1= 5 5*2=10 5*3=15 5*4=20 5*5=25 6*1= 6 6*2=12 6*3=18 6*4=24 6*5=30 6*6=36 7*1= 7 7*2=14 7*3=21 7*4=28 7*5=35 7*6=42 7*7=49 8*1= 8 8*2=16 8*3=24 8*4=32 8*5=40 8*6=48 8*7=56 8*8=64 9*1= 9 9*2=18 9*3=27 9*4=36 9*5=45 9*6=54 9*7=63 9*8=72 9*9=81 This is the end. </code></pre> <h2 id="注意">注意：</h2> <p>代码注释处说明的<code class="highlighter-rouge">%2d</code>是为了美观，强行使相乘的结果占两个字符位，否则打印结果如下：</p> <pre><code class="language-txt">九九乘法表： 1*1=1 2*1=2 2*2=4 3*1=3 3*2=6 3*3=9 4*1=4 4*2=8 4*3=12 4*4=16 5*1=5 5*2=10 5*3=15 5*4=20 5*5=25 6*1=6 6*2=12 6*3=18 6*4=24 6*5=30 6*6=36 7*1=7 7*2=14 7*3=21 7*4=28 7*5=35 7*6=42 7*7=49 8*1=8 8*2=16 8*3=24 8*4=32 8*5=40 8*6=48 8*7=56 8*8=64 9*1=9 9*2=18 9*3=27 9*4=36 9*5=45 9*6=54 9*7=63 9*8=72 9*9=81 This is the end. </code></pre> <p>没有上面美观吧-_-</p> Fri, 30 Mar 2018 00:00:00 +0000 https://knightyun.github.io/2018/03/30/c-multiply-table C语言统计闰年 https://knightyun.github.io/2018/03/30/c-leap-year <h2 id="源码如下">源码如下：</h2> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt; </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 统计1-2020的闰年</span> <span class="n">printf</span><span class="p">(</span><span class="s">"1-2020的闰年: </span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span> <span class="kt">int</span> <span class="n">ye</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">for</span> <span class="p">(</span><span class="n">ye</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ye</span> <span class="o">&lt;=</span> <span class="mi">2020</span><span class="p">;</span> <span class="n">ye</span><span class="o">++</span><span class="p">)</span> <span class="c1">//此处也可更改为指定年份区间</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(((</span><span class="n">ye</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">ye</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">||</span> <span class="p">(</span><span class="n">ye</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">//闰年的定义：能被4整除但不能被100整除，或能被400整除的年份</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">ye</span><span class="p">);</span> <span class="n">c</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">Total: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span> <span class="c1">//用定义的变量c统计</span> <span class="p">}</span> </code></pre></div></div> <h2 id="运行结果">运行结果：</h2> <pre><code class="language-txt">1-2020的闰年: 4 8 12 16 20 24 28 32 36 40 44 48 52 56 60 64 68 72 76 80 84 88 92 96 104 108 112 116 120 124 128 132 136 140 144 148 152 156 160 164 168 172 176 180 184 188 192 196 204 208 212 216 220 224 228 232 236 240 244 248 252 256 260 264 268 272 276 280 284 288 292 296 304 308 312 316 320 324 328 332 336 340 344 348 352 356 360 364 368 372 376 380 384 388 392 396 400 404 408 412 416 420 424 428 432 436 440 444 448 452 456 460 464 468 472 476 480 484 488 492 496 504 508 512 516 520 524 528 532 536 540 544 548 552 556 560 564 568 572 576 580 584 588 592 596 604 608 612 616 620 624 628 632 636 640 644 648 652 656 660 664 668 672 676 680 684 688 692 696 704 708 712 716 720 724 728 732 736 740 744 748 752 756 760 764 768 772 776 780 784 788 792 796 800 804 808 812 816 820 824 828 832 836 840 844 848 852 856 860 864 868 872 876 880 884 888 892 896 904 908 912 916 920 924 928 932 936 940 944 948 952 956 960 964 968 972 976 980 984 988 992 996 1004 1008 1012 1016 1020 1024 1028 1032 1036 1040 1044 1048 1052 1056 1060 1064 1068 1072 1076 1080 1084 1088 1092 1096 1104 1108 1112 1116 1120 1124 1128 1132 1136 1140 1144 1148 1152 1156 1160 1164 1168 1172 1176 1180 1184 1188 1192 1196 1200 1204 1208 1212 1216 1220 1224 1228 1232 1236 1240 1244 1248 1252 1256 1260 1264 1268 1272 1276 1280 1284 1288 1292 1296 1304 1308 1312 1316 1320 1324 1328 1332 1336 1340 1344 1348 1352 1356 1360 1364 1368 1372 1376 1380 1384 1388 1392 1396 1404 1408 1412 1416 1420 1424 1428 1432 1436 1440 1444 1448 1452 1456 1460 1464 1468 1472 1476 1480 1484 1488 1492 1496 1504 1508 1512 1516 1520 1524 1528 1532 1536 1540 1544 1548 1552 1556 1560 1564 1568 1572 1576 1580 1584 1588 1592 1596 1600 1604 1608 1612 1616 1620 1624 1628 1632 1636 1640 1644 1648 1652 1656 1660 1664 1668 1672 1676 1680 1684 1688 1692 1696 1704 1708 1712 1716 1720 1724 1728 1732 1736 1740 1744 1748 1752 1756 1760 1764 1768 1772 1776 1780 1784 1788 1792 1796 1804 1808 1812 1816 1820 1824 1828 1832 1836 1840 1844 1848 1852 1856 1860 1864 1868 1872 1876 1880 1884 1888 1892 1896 1904 1908 1912 1916 1920 1924 1928 1932 1936 1940 1944 1948 1952 1956 1960 1964 1968 1972 1976 1980 1984 1988 1992 1996 2000 2004 2008 2012 2016 2020 Total: 490 </code></pre> Fri, 30 Mar 2018 00:00:00 +0000 https://knightyun.github.io/2018/03/30/c-leap-year Markdown完整语法说明 https://knightyun.github.io/2018/03/28/markdown-total <h1 id="markdown-完整语法说明-">Markdown 完整语法说明 <span id="home"></span></h1> <hr /> <p>辛勤的搬运工，原文链接<a href="http://wowubuntu.com/markdown/index.html">http://wowubuntu.com/markdown/index.html</a></p> <hr /> <h1 id="目录">目录</h1> <ul> <li><strong><a href="#1">概述 </a></strong> <ul> <li><strong><a href="#1.1">宗旨 </a></strong></li> <li><strong><a href="#1.2">兼容 HTML </a></strong></li> <li><strong><a href="#1.3">特殊字符自动转换 </a></strong></li> </ul> </li> <li><strong><a href="#2">区块元素 </a></strong> <ul> <li><strong><a href="#2.1">段落和换行 </a></strong></li> <li><strong><a href="#2.2">标题 </a></strong></li> <li><strong><a href="#2.3">区块引用 Blockquotes </a></strong></li> <li><strong><a href="#2.4">列表 </a></strong></li> <li><strong><a href="#2.5">分隔线 </a></strong></li> </ul> </li> <li><strong><a href="#3">区段元素 </a></strong> <ul> <li><strong><a href="#3.1">链接 </a></strong></li> <li><strong><a href="#3.2">强调 </a></strong></li> <li><strong><a href="#3.3">代码 </a></strong></li> </ul> </li> <li><strong><a href="#4">其它 </a></strong> <ul> <li><strong><a href="#4.1">自动链接 </a></strong></li> <li><strong><a href="#4.2">反斜杠 </a></strong></li> </ul> </li> </ul> <hr /> <h1 id="概述-">概述 <span id="1"></span></h1> <h2 id="宗旨-">宗旨 <span id="1.1"></span></h2> <p>Markdown 的目标是实现「易读易写」。</p> <p>可读性，无论如何，都是最重要的。一份使用 Markdown 格式撰写的文件应该可以直接以纯文本发布，并且看起来不会像是由许多标签或是格式指令所构成。Markdown 语法受到一些既有 text-to-HTML 格式的影响，包括 Setext、atx、Textile、reStructuredText、Grutatext 和 EtText，而最大灵感来源其实是纯文本电子邮件的格式。</p> <p>总之， Markdown 的语法全由一些符号所组成，这些符号经过精挑细选，其作用一目了然。比如：在文字两旁加上星号，看起来就像<em>强调</em>。Markdown 的列表看起来，嗯，就是列表。Markdown 的区块引用看起来就真的像是引用一段文字，就像你曾在电子邮件中见过的那样。</p> <h2 id="兼容-html-">兼容 HTML <span id="1.2"></span></h2> <p>Markdown 语法的目标是：成为一种适用于网络的书写语言。</p> <p>Markdown 不是想要取代 HTML，甚至也没有要和它相近，它的语法种类很少，只对应 HTML 标记的一小部分。Markdown 的构想不是要使得 HTML 文档更容易书写。在我看来， HTML 已经很容易写了。Markdown 的理念是，能让文档更容易读、写和随意改。HTML 是一种发布的格式，Markdown 是一种书写的格式。就这样，Markdown 的格式语法只涵盖纯文本可以涵盖的范围。</p> <p>不在 Markdown 涵盖范围之内的标签，都可以直接在文档里面用 HTML 撰写。不需要额外标注这是 HTML 或是 Markdown；只要直接加标签就可以了。</p> <p>要制约的只有一些 HTML 区块元素――比如 <code class="highlighter-rouge">&lt;div&gt;</code>、<code class="highlighter-rouge">&lt;table&gt;</code>、<code class="highlighter-rouge">&lt;pre&gt;</code>、<code class="highlighter-rouge">&lt;p&gt;</code> 等标签，必须在前后加上空行与其它内容区隔开，还要求它们的开始标签与结尾标签不能用制表符或空格来缩进。Markdown 的生成器有足够智能，不会在 HTML 区块标签外加上不必要的 <code class="highlighter-rouge">&lt;p&gt;</code> 标签。</p> <p>例子如下，在 Markdown 文件里加上一段 HTML 表格：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>这是一个普通段落。 &lt;table&gt; &lt;tr&gt; &lt;td&gt;Foo&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; 这是另一个普通段落。 请注意，在 HTML 区块标签间的 Markdown 格式语法将不会被处理。比如，你在 HTML 区块内使用 Markdown 样式的`*强调*`会没有效果。 </code></pre></div></div> <p>HTML 的区段（行内）标签如 <code class="highlighter-rouge">&lt;span&gt;</code>、<code class="highlighter-rouge">&lt;cite&gt;</code>、<code class="highlighter-rouge">&lt;del&gt;</code> 可以在 Markdown 的段落、列表或是标题里随意使用。依照个人习惯，甚至可以不用 Markdown 格式，而直接采用 HTML 标签来格式化。举例说明：如果比较喜欢 HTML 的 <code class="highlighter-rouge">&lt;a&gt;</code> 或 <code class="highlighter-rouge">&lt;img&gt;</code> 标签，可以直接使用这些标签，而不用 Markdown 提供的链接或是图像标签语法。</p> <p>和处在 HTML 区块标签间不同，Markdown 语法在 HTML 区段标签间是有效的。</p> <h2 id="特殊字符自动转换-">特殊字符自动转换 <span id="1.3"></span></h2> <p>在 HTML 文件中，有两个字符需要特殊处理： <code class="highlighter-rouge">&lt;</code> 和 <code class="highlighter-rouge">&amp;</code> 。 <code class="highlighter-rouge">&lt;</code> 符号用于起始标签，<code class="highlighter-rouge">&amp;</code> 符号则用于标记 HTML 实体，如果你只是想要显示这些字符的原型，你必须要使用实体的形式，像是 <code class="highlighter-rouge">&amp;lt;</code> 和 <code class="highlighter-rouge">&amp;amp;</code>。</p> <p><code class="highlighter-rouge">&amp;</code> 字符尤其让网络文档编写者受折磨，如果你要打「<code class="highlighter-rouge">AT&amp;T</code>」 ，你必须要写成「<code class="highlighter-rouge">AT&amp;amp;T</code>」。而网址中的<code class="highlighter-rouge"> &amp;</code> 字符也要转换。比如你要链接到：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://images.google.com/images?num=30&amp;q=larry+bird 你必须要把网址转换写为： http://images.google.com/images?num=30&amp;amp;q=larry+bird 才能放到链接标签的 `href` 属性里。不用说也知道这很容易忽略，这也可能是 HTML 标准检验所检查到的错误中，数量最多的。 </code></pre></div></div> <p>Markdown 让你可以自然地书写字符，需要转换的由它来处理好了。如果你使用的<code class="highlighter-rouge"> &amp; </code>字符是 HTML 字符实体的一部分，它会保留原状，否则它会被转换成 <code class="highlighter-rouge">&amp;amp;</code>。</p> <p>所以你如果要在文档中插入一个版权符号<code class="highlighter-rouge"> ©</code>，你可以这样写：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;copy; Markdown 会保留它不动。而若你写： AT&amp;T Markdown 就会将它转为： AT&amp;amp;T 类似的状况也会发生在 &lt; 符号上，因为 Markdown 允许 兼容 HTML ，如果你是把 &lt; 符号作为 HTML 标签的定界符使用，那 Markdown 也不会对它做任何转换，但是如果你写： 4 &lt; 5 Markdown 将会把它转换为： 4 &amp;lt; 5 不过需要注意的是，code 范围内，不论是行内还是区块， &lt; 和 &amp; 两个符号都一定会被转换成 HTML 实体，这项特性让你可以很容易地用 Markdown 写 HTML code （和 HTML 相对而言， HTML 语法中，你要把所有的 &lt; 和 &amp; 都转换为 HTML 实体，才能在 HTML 文件里面写出 HTML code。） </code></pre></div></div> <hr /> <h1 id="区块元素-">区块元素 <span id="2"></span></h1> <h2 id="段落和换行-">段落和换行 <span id="2.1"></span></h2> <p>一个 Markdown 段落是由一个或多个连续的文本行组成，它的前后要有一个以上的空行（空行的定义是显示上看起来像是空的，便会被视为空行。比方说，若某一行只包含空格和制表符，则该行也会被视为空行）。普通段落不该用空格或制表符来缩进。</p> <p>「由一个或多个连续的文本行组成」这句话其实暗示了 Markdown 允许段落内的强迫换行（插入换行符），这个特性和其他大部分的 text-to-HTML 格式不一样（包括 Movable Type 的「Convert Line Breaks」选项），其它的格式会把每个换行符都转成<code class="highlighter-rouge"> &lt;br /&gt;</code> 标签。</p> <p>如果你确实想要依赖 Markdown 来插入 <code class="highlighter-rouge">&lt;br /&gt;</code> 标签的话，在插入处先按入两个以上的空格然后回车。</p> <p>的确，需要多费点事（多加空格）来产生<code class="highlighter-rouge"> &lt;br /&gt; </code>，但是简单地「每个换行都转换为<code class="highlighter-rouge"> &lt;br /&gt;</code>」的方法在 Markdown 中并不适合， Markdown 中 email 式的 区块引用 和多段落的 列表 在使用换行来排版的时候，不但更好用，还更方便阅读。</p> <h2 id="标题-">标题 <span id="2.2"></span></h2> <p>Markdown 支持两种标题的语法，类 <strong>Setext</strong> 和类 <strong>atx</strong> 形式。</p> <p>类 Setext 形式是用底线的形式，利用 <code class="highlighter-rouge">=</code> （最高阶标题）和 <code class="highlighter-rouge">-</code> （第二阶标题），例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This is an H1 ============= This is an H2 ------------- 任何数量的 `=` 和 `-` 都可以有效果。 </code></pre></div></div> <p>类 Atx 形式则是在行首插入 1 到 6 个 <code class="highlighter-rouge">#</code> ，对应到标题 1 到 6 阶，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 这是 H1 ## 这是 H2 ###### 这是 H6 </code></pre></div></div> <p>你可以选择性地「闭合」类 atx 样式的标题，这纯粹只是美观用的，若是觉得这样看起来比较舒适，你就可以在行尾加上 #，而行尾的 # 数量也不用和开头一样（行首的井字符数量决定标题的阶数）：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 这是 H1 # ## 这是 H2 ## ### 这是 H3 ###### </code></pre></div></div> <h2 id="区块引用-blockquotes-">区块引用 Blockquotes <span id="2.3"></span></h2> <p>Markdown 标记区块引用是使用类似 email 中用 &gt; 的引用方式。如果你还熟悉在 email 信件中的引言部分，你就知道怎么在 Markdown 文件中建立一个区块引用，那会看起来像是你自己先断好行，然后在每行的最前面加上 &gt; ：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet, &gt; consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. &gt; Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus. &gt; &gt; Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse &gt; id sem consectetuer libero luctus adipiscing. </code></pre></div></div> <p>Markdown 也允许你偷懒只在整个段落的第一行最前面加上 &gt; ：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus. &gt; Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse id sem consectetuer libero luctus adipiscing. </code></pre></div></div> <p>区块引用可以嵌套（例如：引用内的引用），只要根据层次加上不同数量的 &gt; ：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; This is the first level of quoting. &gt; &gt; &gt; This is nested blockquote. &gt; &gt; Back to the first level. </code></pre></div></div> <p>引用的区块内也可以使用其他的 Markdown 语法，包括标题、列表、代码区块等：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; ## 这是一个标题。 &gt; &gt; 1. 这是第一行列表项。 &gt; 2. 这是第二行列表项。 &gt; &gt; 给出一些例子代码： &gt; &gt; return shell_exec("echo $input | $markdown_script"); </code></pre></div></div> <p>任何像样的文本编辑器都能轻松地建立 email 型的引用。例如在 BBEdit 中，你可以选取文字后然后从选单中选择增加引用阶层。</p> <h2 id="列表-">列表 <span id="2.4"></span></h2> <p>Markdown 支持有序列表和无序列表。</p> <p>无序列表使用星号、加号或是减号作为列表标记：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* Red * Green * Blue 等同于： + Red + Green + Blue 也等同于： - Red - Green - Blue 有序列表则使用数字接着一个英文句点： 1. Bird 2. McHale 3. Parish 很重要的一点是，你在列表标记上使用的数字并不会影响输出的 HTML 结果，上面的列表所产生的 HTML 标记为： &lt;ol&gt; &lt;li&gt;Bird&lt;/li&gt; &lt;li&gt;McHale&lt;/li&gt; &lt;li&gt;Parish&lt;/li&gt; &lt;/ol&gt; 如果你的列表标记写成： 1. Bird 1. McHale 1. Parish 或甚至是： 3. Bird 1. McHale 8. Parish 你都会得到完全相同的 HTML 输出。重点在于，你可以让 Markdown 文件的列表数字和输出的结果相同，或是你懒一点，你可以完全不用在意数字的正确性。 </code></pre></div></div> <p>如果你使用懒惰的写法，建议第一个项目最好还是从 1. 开始，因为 Markdown 未来可能会支持有序列表的 start 属性。</p> <p>列表项目标记通常是放在最左边，但是其实也可以缩进，最多 3 个空格，项目标记后面则一定要接着至少一个空格或制表符。</p> <p>要让列表看起来更漂亮，你可以把内容用固定的缩进整理好：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus. * Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse id sem consectetuer libero luctus adipiscing. 但是如果你懒，那也行： * Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus. * Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse id sem consectetuer libero luctus adipiscing. 如果列表项目间用空行分开，在输出 HTML 时 Markdown 就会将项目内容用 &lt;p&gt; 标签包起来，举例来说： * Bird * Magic 会被转换为： &lt;ul&gt; &lt;li&gt;Bird&lt;/li&gt; &lt;li&gt;Magic&lt;/li&gt; &lt;/ul&gt; 但是这个： * Bird * Magic 会被转换为： &lt;ul&gt; &lt;li&gt;&lt;p&gt;Bird&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;p&gt;Magic&lt;/p&gt;&lt;/li&gt; &lt;/ul&gt; 列表项目可以包含多个段落，每个项目下的段落都必须缩进 4 个空格或是 1 个制表符： 1. This is a list item with two paragraphs. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus. Donec sit amet nisl. Aliquam semper ipsum sit amet velit. 2. Suspendisse id sem consectetuer libero luctus adipiscing. 如果你每行都有缩进，看起来会看好很多，当然，再次地，如果你很懒惰，Markdown 也允许： * This is a list item with two paragraphs. This is the second paragraph in the list item. You're only required to indent the first line. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. * Another item in the same list. 如果要在列表项目内放进引用，那 &gt; 就需要缩进： * A list item with a blockquote: &gt; This is a blockquote &gt; inside a list item. 如果要放代码区块的话，该区块就需要缩进两次，也就是 8 个空格或是 2 个制表符： * 一列表项包含一个列表区块： &lt;代码写在这&gt; 当然，项目列表很可能会不小心产生，像是下面这样的写法： 1986. What a great season. 换句话说，也就是在行首出现数字-句点-空白，要避免这样的状况，你可以在句点前面加上反斜杠。 1986\. What a great season. 代码区块 </code></pre></div></div> <p>和程序相关的写作或是标签语言原始码通常会有已经排版好的代码区块，通常这些区块我们并不希望它以一般段落文件的方式去排版，而是照原来的样子显示，Markdown 会用 <code class="highlighter-rouge">&lt;pre&gt;</code> 和 <code class="highlighter-rouge">&lt;code&gt;</code> 标签来把代码区块包起来。</p> <p>要在 Markdown 中建立代码区块很简单，只要简单地缩进 4 个空格或是 1 个制表符就可以，例如，下面的输入：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>这是一个普通段落： 这是一个代码区块。 Markdown 会转换成： &lt;p&gt;这是一个普通段落：&lt;/p&gt; &lt;pre&gt;&lt;code&gt;这是一个代码区块。 &lt;/code&gt;&lt;/pre&gt; 这个每行一阶的缩进（4 个空格或是 1 个制表符），都会被移除，例如： Here is an example of AppleScript: tell application "Foo" beep end tell 会被转换为： &lt;p&gt;Here is an example of AppleScript:&lt;/p&gt; &lt;pre&gt;&lt;code&gt;tell application "Foo" beep end tell &lt;/code&gt;&lt;/pre&gt; 一个代码区块会一直持续到没有缩进的那一行（或是文件结尾）。 </code></pre></div></div> <p>在代码区块里面， <code class="highlighter-rouge">&amp;</code> 、 <code class="highlighter-rouge">&lt;</code> 和 <code class="highlighter-rouge">&gt;</code> 会自动转成 HTML 实体，这样的方式让你非常容易使用 Markdown 插入范例用的 HTML 原始码，只需要复制贴上，再加上缩进就可以了，剩下的 Markdown 都会帮你处理，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div class="footer"&gt; &amp;copy; 2004 Foo Corporation &lt;/div&gt; 会被转换为： &lt;pre&gt;&lt;code&gt;&amp;lt;div class="footer"&amp;gt; &amp;amp;copy; 2004 Foo Corporation &amp;lt;/div&amp;gt; &lt;/code&gt;&lt;/pre&gt; 代码区块中，一般的 Markdown 语法不会被转换，像是星号便只是星号，这表示你可以很容易地以 Markdown 语法撰写 Markdown 语法相关的文件。 </code></pre></div></div> <h2 id="分隔线-">分隔线 <span id="2.5"></span></h2> <p>你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。下面每种写法都可以建立分隔线：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* * * *** ***** - - - --------------------------------------- </code></pre></div></div> <hr /> <p>##区段元素 <span id="3"></span></p> <h2 id="链接-">链接 <span id="3.1"></span></h2> <p>Markdown 支持两种形式的链接语法： _行内式_和_参考式_两种形式。</p> <p>不管是哪一种，链接文字都是用 [方括号] 来标记。</p> <p>要建立一个行内式的链接，只要在方块括号后面紧接着圆括号并插入网址链接即可，如果你还想要加上链接的 title 文字，只要在网址后面，用双引号把 title 文字包起来即可，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This is [an example](http://example.com/ "Title") inline link. [This link](http://example.net/) has no title attribute. 会产生： &lt;p&gt;This is &lt;a href="http://example.com/" title="Title"&gt; an example&lt;/a&gt; inline link.&lt;/p&gt; &lt;p&gt;&lt;a href="http://example.net/"&gt;This link&lt;/a&gt; has no title attribute.&lt;/p&gt; 如果你是要链接到同样主机的资源，你可以使用相对路径： See my [About](/about/) page for details. 参考式的链接是在链接文字的括号后面再接上另一个方括号，而在第二个方括号里面要填入用以辨识链接的标记： This is [an example][id] reference-style link. 你也可以选择性地在两个方括号中间加上一个空格： This is [an example] [id] reference-style link. 接着，在文件的任意处，你可以把这个标记的链接内容定义出来： [id]: http://example.com/ "Optional Title Here" 链接内容定义的形式为： </code></pre></div></div> <p>方括号（前面可以选择性地加上至多三个空格来缩进），里面输入链接文字 接着一个冒号 接着一个以上的空格或制表符 接着链接的网址 选择性地接着 title 内容，可以用单引号、双引号或是括弧包着 下面这三种链接的定义都是相同：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[foo]: http://example.com/ "Optional Title Here" [foo]: http://example.com/ 'Optional Title Here' [foo]: http://example.com/ (Optional Title Here) 请注意：有一个已知的问题是 Markdown.pl 1.0.1 会忽略单引号包起来的链接 title。 </code></pre></div></div> <p>链接网址也可以用尖括号包起来：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[id]: &lt;http://example.com/&gt; "Optional Title Here" 你也可以把 title 属性放到下一行，也可以加一些缩进，若网址太长的话，这样会比较好看： [id]: http://example.com/longish/path/to/resource/here "Optional Title Here" 网址定义只有在产生链接的时候用到，并不会直接出现在文件之中。 </code></pre></div></div> <p>链接辨别标签可以有字母、数字、空白和标点符号，但是并不区分大小写，因此下面两个链接是一样的：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[link text][a] [link text][A] 隐式链接标记功能让你可以省略指定链接标记，这种情形下，链接标记会视为等同于链接文字，要用隐式链接标记只要在链接文字后面加上一个空的方括号，如果你要让 "Google" 链接到 google.com，你可以简化成： [Google][] 然后定义链接内容： [Google]: http://google.com/ 由于链接文字可能包含空白，所以这种简化型的标记内也许包含多个单词： Visit [Daring Fireball][] for more information. 然后接着定义链接： [Daring Fireball]: http://daringfireball.net/ 链接的定义可以放在文件中的任何一个地方，我比较偏好直接放在链接出现段落的后面，你也可以把它放在文件最后面，就像是注解一样。 </code></pre></div></div> <p>下面是一个参考式链接的范例：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I get 10 times more traffic from [Google] [1] than from [Yahoo] [2] or [MSN] [3]. [1]: http://google.com/ "Google" [2]: http://search.yahoo.com/ "Yahoo Search" [3]: http://search.msn.com/ "MSN Search" 如果改成用链接名称的方式写： I get 10 times more traffic from [Google][] than from [Yahoo][] or [MSN][]. [google]: http://google.com/ "Google" [yahoo]: http://search.yahoo.com/ "Yahoo Search" [msn]: http://search.msn.com/ "MSN Search" 上面两种写法都会产生下面的 HTML。 &lt;p&gt;I get 10 times more traffic from &lt;a href="http://google.com/" title="Google"&gt;Google&lt;/a&gt; than from &lt;a href="http://search.yahoo.com/" title="Yahoo Search"&gt;Yahoo&lt;/a&gt; or &lt;a href="http://search.msn.com/" title="MSN Search"&gt;MSN&lt;/a&gt;.&lt;/p&gt; 下面是用行内式写的同样一段内容的 Markdown 文件，提供作为比较之用： I get 10 times more traffic from [Google](http://google.com/ "Google") than from [Yahoo](http://search.yahoo.com/ "Yahoo Search") or [MSN](http://search.msn.com/ "MSN Search"). 参考式的链接其实重点不在于它比较好写，而是它比较好读，比较一下上面的范例，使用参考式的文章本身只有 81 个字符，但是用行内形式的却会增加到 176 个字元，如果是用纯 HTML 格式来写，会有 234 个字元，在 HTML 格式中，标签比文本还要多。 </code></pre></div></div> <p>使用 Markdown 的参考式链接，可以让文件更像是浏览器最后产生的结果，让你可以把一些标记相关的元数据移到段落文字之外，你就可以增加链接而不让文章的阅读感觉被打断。</p> <h2 id="强调-">强调 <span id="3.2"></span></h2> <p>Markdown 使用星号（<code class="highlighter-rouge">*</code>）和底线（<code class="highlighter-rouge">_</code>）作为标记强调字词的符号，被 <code class="highlighter-rouge">*</code> 或 <code class="highlighter-rouge">_</code> 包围的字词会被转成用 <code class="highlighter-rouge">&lt;em&gt;</code> 标签包围，用两个 <code class="highlighter-rouge">*</code> 或 <code class="highlighter-rouge">_</code> 包起来的话，则会被转成 <code class="highlighter-rouge">&lt;strong&gt;</code>，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*single asterisks* _single underscores_ **double asterisks** __double underscores__ 会转成： &lt;em&gt;single asterisks&lt;/em&gt; &lt;em&gt;single underscores&lt;/em&gt; &lt;strong&gt;double asterisks&lt;/strong&gt; &lt;strong&gt;double underscores&lt;/strong&gt; 你可以随便用你喜欢的样式，唯一的限制是，你用什么符号开启标签，就要用什么符号结束。 </code></pre></div></div> <p>强调也可以直接插在文字中间：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>un*frigging*believable 但是如果你的 * 和 _ 两边都有空白的话，它们就只会被当成普通的符号。 </code></pre></div></div> <p>如果要在文字前后直接插入普通的星号或底线，你可以用反斜线：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\*this text is surrounded by literal asterisks\* </code></pre></div></div> <h2 id="代码-">代码 <span id="3.3"></span></h2> <p>如果要标记一小段行内代码，你可以用反引号把它包起来（`），例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use the `printf()` function. 会产生： &lt;p&gt;Use the &lt;code&gt;printf()&lt;/code&gt; function.&lt;/p&gt; 如果要在代码区段内插入反引号，你可以用多个反引号来开启和结束代码区段： ``There is a literal backtick (`) here.`` 这段语法会产生： &lt;p&gt;&lt;code&gt;There is a literal backtick (`) here.&lt;/code&gt;&lt;/p&gt; 代码区段的起始和结束端都可以放入一个空白，起始端后面一个，结束端前面一个，这样你就可以在区段的一开始就插入反引号： A single backtick in a code span: `` ` `` A backtick-delimited string in a code span: `` `foo` `` 会产生： &lt;p&gt;A single backtick in a code span: &lt;code&gt;`&lt;/code&gt;&lt;/p&gt; &lt;p&gt;A backtick-delimited string in a code span: &lt;code&gt;`foo`&lt;/code&gt;&lt;/p&gt; 在代码区段内，&amp; 和尖括号都会被自动地转成 HTML 实体，这使得插入 HTML 原始码变得很容易，Markdown 会把下面这段： Please don't use any `&lt;blink&gt;` tags. 转为： &lt;p&gt;Please don't use any &lt;code&gt;&amp;lt;blink&amp;gt;&lt;/code&gt; tags.&lt;/p&gt; 你也可以这样写： `&amp;#8212;` is the decimal-encoded equivalent of `&amp;mdash;`. 以产生： &lt;p&gt;&lt;code&gt;&amp;amp;#8212;&lt;/code&gt; is the decimal-encoded equivalent of &lt;code&gt;&amp;amp;mdash;&lt;/code&gt;.&lt;/p&gt; 图片 </code></pre></div></div> <p>很明显地，要在纯文字应用中设计一个「自然」的语法来插入图片是有一定难度的。</p> <p>Markdown 使用一种和链接很相似的语法来标记图片，同样也允许两种样式： <em>行内式</em>和<em>参考式</em>。</p> <p>行内式的图片语法看起来像是：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![Alt text](/path/to/img.jpg) ![Alt text](/path/to/img.jpg "Optional title") 详细叙述如下： </code></pre></div></div> <ul> <li>一个惊叹号 <code class="highlighter-rouge">!</code></li> <li>接着一个方括号，里面放上图片的替代文字</li> <li> <p>接着一个普通括号，里面放上图片的网址，最后还可以用引号包住并加上 选择性的 ‘title’ 文字。 参考式的图片语法则长得像这样：</p> <p><img src="url/to/image" alt="Alt text" title="Optional title attribute" /> 「id」是图片参考的名称，图片参考的定义方式则和连结参考一样：</p> <p>到目前为止， Markdown 还没有办法指定图片的宽高，如果你需要的话，你可以使用普通的 <code class="highlighter-rouge">&lt;img&gt;</code> 标签。</p> </li> </ul> <hr /> <hr /> <h1 id="其它-">其它 <span id="4"></span></h1> <h2 id="自动链接-">自动链接 <span id="4.1"></span></h2> <p>Markdown 支持以比较简短的自动链接形式来处理网址和电子邮件信箱，只要是用尖括号包起来， Markdown 就会自动把它转成链接。一般网址的链接文字就和链接地址一样，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;http://example.com/&gt; Markdown 会转为： &lt;a href="http://example.com/"&gt;http://example.com/&lt;/a&gt; 邮址的自动链接也很类似，只是 Markdown 会先做一个编码转换的过程，把文字字符转成 16 进位码的 HTML 实体，这样的格式可以糊弄一些不好的邮址收集机器人，例如： &lt;address@example.com&gt; Markdown 会转成： &lt;a href="&amp;#x6D;&amp;#x61;i&amp;#x6C;&amp;#x74;&amp;#x6F;:&amp;#x61;&amp;#x64;&amp;#x64;&amp;#x72;&amp;#x65; &amp;#115;&amp;#115;&amp;#64;&amp;#101;&amp;#120;&amp;#x61;&amp;#109;&amp;#x70;&amp;#x6C;e&amp;#x2E;&amp;#99;&amp;#111; &amp;#109;"&gt;&amp;#x61;&amp;#x64;&amp;#x64;&amp;#x72;&amp;#x65;&amp;#115;&amp;#115;&amp;#64;&amp;#101;&amp;#120;&amp;#x61; &amp;#109;&amp;#x70;&amp;#x6C;e&amp;#x2E;&amp;#99;&amp;#111;&amp;#109;&lt;/a&gt; 在浏览器里面，这段字串（其实是 `&lt;a href="mailto:address@example.com"&gt;address@example.com&lt;/a&gt;`）会变成一个可以点击的「address@example.com」链接。 </code></pre></div></div> <p>（这种作法虽然可以糊弄不少的机器人，但并不能全部挡下来，不过总比什么都不做好些。不管怎样，公开你的信箱终究会引来广告信件的。）</p> <h2 id="反斜杠-">反斜杠 <span id="4.2"></span></h2> <p>Markdown 可以利用反斜杠来插入一些在语法中有其它意义的符号，例如：如果你想要用星号加在文字旁边的方式来做出强调效果（但不用 <code class="highlighter-rouge">&lt;em&gt;</code> 标签），你可以在星号的前面加上反斜杠：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\*literal asterisks\* Markdown 支持以下这些符号前面加上反斜杠来帮助插入普通的符号： \ 反斜线 ` 反引号 * 星号 _ 底线 {} 花括号 [] 方括号 () 括弧 # 井字号 + 加号 - 减号 . 英文句点 ! 惊叹号 </code></pre></div></div> <hr /> <h1 id="返回顶部"><strong>返回<a href="#home">顶部</a></strong></h1> <hr /> Wed, 28 Mar 2018 00:00:00 +0000 https://knightyun.github.io/2018/03/28/markdown-total Markdown简明教程 https://knightyun.github.io/2018/03/27/Markdown-tutorial